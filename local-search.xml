<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>MIT6.824Lab1æ€è·¯æ€»ç»“</title>
    <link href="/2023/11/07/MIT6-824Lab1%E6%80%9D%E8%B7%AF%E6%80%BB%E7%BB%93/"/>
    <url>/2023/11/07/MIT6-824Lab1%E6%80%9D%E8%B7%AF%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<p>å› ä¸º824çš„è€å¸ˆä¸å¸Œæœ›æˆ‘ä»¬å¼€æºä»£ç ï¼Œæ‰€ä»¥æˆ‘å°±æ”¾åœ¨giteeä¸Šï¼ˆdogeï¼‰ï¼Œå¤–å›½äººæ€»ä¸ä¼šç”¨giteeå§</p><p>Giteeä»“åº“åœ°å€ï¼š<a href="https://gitee.com/MadFray/mit6.824">MadFray&#x2F;MIT6.824 (gitee.com)</a></p><p>ç„¶åç”¨å†™ç¯‡blogè®°å½•ä¸€ä¸‹åœ¨åšlab1æ—¶å€™çš„æ€è·¯å’Œé‡åˆ°å‘ç‚¹</p><p>åœ¨æœ€å¼€å§‹åšçš„æ—¶å€™ï¼Œå› ä¸ºè®ºæ–‡è®²è¿°çš„æ˜¯åœ¨clusterä¸‹çš„æƒ…å†µï¼Œç°åœ¨æ”¾åˆ°äº†å•æœºå®ç°ï¼Œæœ‰ä¸€å®šçš„ä¸Šæ‰‹éš¾åº¦ï¼Œä½†æ˜¯æœ€æ— è¯­çš„ä¸€ä»¶äº‹æ˜¯æ²¡æœ‰çœ‹å®Œhintå°±å»åšï¼Œå¯¼è‡´å½“æ—¶æƒ³è¦é€šè¿‡åç¨‹æ¥å®ç°ï¼Œè¿™ä¸åˆè€å¸ˆä»¬çš„æƒ³æ³•ï¼ˆhintæ²¡æœ‰è¿™æ–¹é¢çš„æç¤ºï¼‰ï¼ŒåŒæ—¶è¿™æ–¹é¢æ˜¯æ€è·¯æ˜¯ç©ºç™½çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ç°èµ·æ¥ä¼šç›¸å¯¹æ¯”è¾ƒå›°éš¾ï¼ˆä½†å…¶å®åé¢å•ç‹¬æµ‹è¯•çš„æ—¶å€™ï¼Œå»æ”¹è„šæœ¬å‘ç°å…¶å®ä»–çš„è„šæœ¬å°±æ˜¯æŒ‚åå°å¯åŠ¨äº†å¥½å‡ ä¸ªworkerï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œè¿™ä¸ªworkeråº”è¯¥æ˜¯æ—¢å¯ä»¥åšmapä¹Ÿå¯ä»¥åšreduceçš„ï¼‰ã€‚</p><p>åœ¨åé¢çœ‹äº†ä¸€ç¯‡csdnçš„åšå®¢åï¼Œè‡ªå·±ç§ä¸‹é‡ŒåˆæŠŠhintå®Œå®Œæ•´æ•´çš„çœ‹å®Œäº†ä¸€éï¼Œæ‰çœŸæ­£ç®—æ˜¯ç†æ¸…æ¥šäº†æ€è·¯ï¼Œå¤§è‡´çŸ¥é“äº†è€å¸ˆä»¬å¸Œæœ›æˆ‘ä»¬æ€ä¹ˆåšã€‚ç†æ¸…æ¥šäº†æ€è·¯åšèµ·æ¥å°±å¿«äº†çœŸæ­£å¼€å§‹åŠ¨æ‰‹åšåˆ°å®Œæˆlabå¤§èŠ±äº†1å¤©åŠå¤šçš„æ—¶é—´ï¼ŒåŠ ä¸Šçœ‹è®ºæ–‡ç­‰èµ„æ–™ï¼Œå®é™…éœ€è¦çš„æ—¶é—´æˆ‘ä¼°è®¡åº”è¯¥åœ¨æœ€å¤š3å¤©å·¦å³ï¼Œå½“ç„¶æˆ‘æŒ‡çš„æ˜¯ä¸€å¤©çš„å¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨è¿™ä¸Šé¢ï¼Œéœ€è¦3å¤©</p><p>æ¥ä¸‹æ¥å°±æ¥è¯´ä¸€ä¸‹æˆ‘çš„æ€è·¯å’Œä¸€ä¸‹ç»éªŒæ€»ç»“</p><p>æˆ‘æ˜¯é¦–å…ˆå®ç°çš„worker</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Worker</span><span class="hljs-params">(mapffunc(<span class="hljs-type">string</span>,<span class="hljs-type">string</span>)</span></span> []KeyValue,<br><br>reduceffunc(<span class="hljs-type">string</span>, []<span class="hljs-type">string</span>)<span class="hljs-type">string</span>) &#123;<br><br><span class="hljs-comment">// Your worker implementation here.</span><br><br><span class="hljs-keyword">for</span> &#123;<br><br>task := GetTask()<br><br><span class="hljs-keyword">switch</span> task.TaskType &#123;<br><br><span class="hljs-keyword">case</span> MapTask:<br><br>&#123;<br><br>DoMap(mapf, task)<br><br>DoneTask(task)<br><br>&#125;<br><br><span class="hljs-keyword">case</span> CompleteTask:<br><br>&#123;<br><br><span class="hljs-comment">//exit</span><br><br><span class="hljs-keyword">return</span><br>&#125;<br><br><span class="hljs-keyword">case</span> ReduceTask:<br><br>&#123;<br><br>DoReduceTask(reducef,task)<br><br>DoneTask(task)<br><br>&#125;<br><br>&#125;<br><br>&#125;<br><br><span class="hljs-comment">// uncomment to send the Example RPC to the coordinator.</span><br><br>&#125;<br></code></pre></td></tr></table></figure><p>å› ä¸ºä¸Šé¢æåˆ°è¿‡ï¼Œworkerè¦mapå’Œreduceéƒ½èƒ½å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ ¹æ®ç©¿è¿‡æ¥çš„taskå‚æ•°ä¸­çš„tasktypeæ¥è¿›è¡Œåˆ¤æ–­åº”è¯¥åšä»€ä¹ˆå¤„ç†</p><p>è¿™è¾¹æä¸€ä¸‹æˆ‘å¹¶æ²¡æœ‰å»ç»´æŠ¤workerçš„çŠ¶æ€ï¼Œè€Œåªä½¿ç”¨äº†taskçš„çŠ¶æ€ï¼Œåªç»´æŠ¤taskçš„çŠ¶æ€ç›¸å¯¹æ¥è®²ä¼šæ›´åŠ ç®€å•</p><p>ç„¶ååœ¨å®ç°DoMapçš„æ—¶å€™ï¼Œè¿™é‡Œä¸€å¼€å§‹å®ç°çš„æ—¶å€™æ²¡æœ‰æ³¨æ„åˆ°å¹¶å‘é—®é¢˜ï¼ˆå½“ç„¶ï¼Œåœ¨å¹¶å‘é—®é¢˜ä¹‹å‰å…¶å®è¿˜æœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œæˆ‘æŠŠcreateæ–‡ä»¶æ”¾åˆ°äº†forå¾ªç¯é‡Œï¼Œè¿™å¯¼è‡´æ‰€æœ‰çš„key valueéƒ½æ²¡æœ‰è¿½åŠ åˆ°å¯¹åº”çš„tmpæ–‡ä»¶ä¸­ï¼Œè€Œæ˜¯åé¢è¦†ç›–å‰é¢ï¼ˆcreateä¼šå¦‚æœå·²ç»å­˜åœ¨äº†åŒåæ–‡ä»¶ï¼Œé‚£ä¹ˆå°±ä¼šè¿›è¡Œè¦†ç›–ï¼‰ï¼Œå¯¼è‡´åˆ°äº†æœ€åå¤„ç†å®Œäº†æ‰€æœ‰çš„outéƒ½åªæœ‰ä¸€æ¡è®°å½•ï¼ŒçŠ¯å‚»äº†ï¼Œæˆ‘å¥½èœ&gt;_&lt;ğŸ¥ºï¼‰</p><p>å¦‚æœä¸ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å¦ä¸€ç§æ–¹æ³•ï¼šå°†æ‰€æœ‰çš„key valueéƒ½å¤„ç†å¥½ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„è¿›è¡Œå­˜å‚¨ï¼Œæœ€åç»Ÿä¸€ä¸€æ¬¡æ€§åˆ›å»ºæ–‡ä»¶ç„¶åå°†å…¨éƒ¨å†™å…¥æ–‡ä»¶</p><p>ä¹Ÿå°±æ˜¯è¯´å¦‚æœä¸ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶è¿™ä¸€ç§æ–¹æ³•çš„è¯ï¼Œé‚£ä¹ˆå°±å°†æ‰€æœ‰çš„kvéƒ½å­˜åœ¨å†…å­˜ä¸­ï¼Œæœ€åä¸€èµ·å†™å…¥åˆ°æ–‡ä»¶ä¸­æ¥é¿å…å¹¶å‘é—®é¢˜</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">DoMap</span><span class="hljs-params">(mapffunc(<span class="hljs-type">string</span>,<span class="hljs-type">string</span>)</span></span> []KeyValue, raw Task) &#123;<span class="hljs-comment">//è¿™é‡Œåº”è¯¥æœ‰å¹¶å‘é—®é¢˜,å·²ç»è§£å†³</span><br><br><span class="hljs-comment">//psï¼š å› ä¸ºéƒ½åœ¨GFSé‡Œï¼Œæ‰€ä»¥çŸ¥é“äº†filenameå°±å¯ä»¥ç›´æ¥è¯»(è‡ªè®¤ä¸º)</span><br><br>file, err := os.Open(raw.Filename)<br><br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><br>log.Fatalf(<span class="hljs-string">&quot;cannot open %v&quot;</span>, raw.Filename)<br><br>&#125;<br><br>content, err := io.ReadAll(file)<br><br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><br>log.Fatalf(<span class="hljs-string">&quot;cannot read %v&quot;</span>, raw.Filename)<br><br>&#125;<br><br>file.Close()<br><br>kva := mapf(raw.Filename,<span class="hljs-type">string</span>(content))<br><br><span class="hljs-comment">//intermediate = append(intermediate, kva...)</span><br><br><span class="hljs-comment">//create intermediate file  what&#x27;s the mean of k and y</span><br><br><span class="hljs-comment">// use json</span><br><br><span class="hljs-comment">//æå‰åˆ›å»ºå¥½æ–‡ä»¶</span><br><br>dir, _ := os.Getwd()<br><br>Mapfiles := []*os.File&#123;&#125;<br><br><span class="hljs-keyword">for</span> i:=<span class="hljs-number">0</span>;i&lt;raw.ReduceSum;i++&#123;<br><br>oname,_:=os.CreateTemp(dir,<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment">//newfile, _ := os.Create(&quot;mr-&quot; + fmt.Sprint(raw.TaskNum)+ &quot;-&quot; + fmt.Sprint(i)) //use ihash to confirm reduceNum</span><br><br>Mapfiles = <span class="hljs-built_in">append</span>(Mapfiles,oname)<br><br>&#125;<br><br><span class="hljs-keyword">for</span> _, v :=<span class="hljs-keyword">range</span> kva &#123;  <span class="hljs-comment">//å¦‚æœæ–‡ä»¶å­˜åœ¨ä¼šå°†æ‰€æœ‰æ–‡ä»¶å†…å®¹æ¸…ç©ºï¼Œæ‰€ä»¥ä¸èƒ½æ¯æ¬¡éƒ½ç”¨createåˆ›å»ºä¸€ä¸ª</span><br><br><span class="hljs-comment">//newfile, _ := os.Create(&quot;mr-&quot; + fmt.Sprint(raw.TaskNum)+ &quot;-&quot; + fmt.Sprint(ihash(v.Key)%raw.ReduceSum)) //use ihash to confirm reduceNum</span><br><br>f := Mapfiles[ihash(v.Key)%raw.ReduceSum]<br><br>enc := json.NewEncoder(f)<br><br>err := enc.Encode(&amp;v)<br><br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><br>log.Println(err)<br><br>&#125;<br><br>&#125;<br><br><span class="hljs-keyword">for</span> i,v:=<span class="hljs-keyword">range</span> Mapfiles&#123;<br><br>err := os.Rename(v.Name(),fmt.Sprintf(<span class="hljs-string">&quot;mr-%d-%d&quot;</span>, raw.TaskNum, i)) <span class="hljs-comment">//use ihash to confirm reduceNum</span><br><br><span class="hljs-keyword">if</span> err!= <span class="hljs-literal">nil</span> &#123;<br><br>log.Println(err)<br><br>&#125;<br><br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>workerç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ï¼Œè¿™è¾¹å°±å…ˆç®€å•çš„æŠŠæˆ‘è¸©åˆ°çš„å‘å†™å‡ºæ¥ç»™å¤§å®¶å¸å–æ•™è®­ï¼ŒDoreduceç­‰æ¯”è¾ƒç®€å•ï¼Œè¿™è¾¹å°±ä¸å†å¤šæ</p><p>æ¥ä¸‹æ¥è®²ä¸€ä¸‹coodinatorï¼Œæˆ‘ä¸ªäººè§‰å¾—è¿™ä¸€å—ç›¸è¾ƒworkeræ¥è¯´è¿˜æ˜¯æœ‰ç‚¹éš¾åº¦çš„ï¼Œä½†ä¹Ÿè¿˜å¥½ï¼Œ100å¤šè¡Œä»£ç å°±èƒ½å®Œæˆï¼Œå› ä¸ºæˆ‘ä»¬åªç»´æŠ¤workerçš„çŠ¶æ€</p><p>ç„¶åcoodinatorå…³é”®ç‚¹åœ¨äºtaskçš„åˆ†é…ï¼Œè¿™é‡Œhintæœ‰æç¤ºï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç¡®ä¿mapå…¨éƒ¨éƒ½å®Œæˆååœ¨åˆ†é…reduceä»»åŠ¡</p><p>è¿™è¾¹æä¸€ä¸‹æˆ‘åœ¨ç¬¬ä¸‰æ¬¡æµ‹è¯•æ˜¯æ—¶å€™æœ‰ä¸€ä¸ªjob count æµ‹è¯•ç‚¹è¿‡ä¸å»ï¼Œä»–é€šè¿‡è¦æ±‚çš„mapæ¬¡æ•°æ˜¯8æ¬¡ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘çš„ä¼šæ‰§è¡Œå‡º9æ¬¡æ¥</p><p>åé¢è°ƒäº†ä¸€èŠ‚è¯¾ï¼Œåˆ†æäº†ä¸€æ³¢é—®é¢˜æœ‰å…³çš„ä¸Šä¸‹æ¸¸ï¼Œæœ€åå‘ç°FinishedTaskåŠ çš„é”ç»™ä»–å»æ‰å°±èƒ½å¤Ÿé€šè¿‡äº†</p><p>æˆ‘åœ¨ä¸€å¼€å§‹å†™çš„æ—¶å€™ä¹Ÿè§‰å¾—å¹¶ä¸æ˜¯å¾ˆæœ‰å¿…è¦åŠ é”ï¼Œä»–éƒ½æ˜¯æ”¹æˆtrueï¼Œå°±ç®—æœ‰å¯èƒ½åŒæ—¶ä¿®æ”¹ä¸€ä¸ªï¼Œé‚£ä»–ä»¬çš„ç»“æœä¹Ÿæ˜¯ç›¸åŒçš„ï¼Œéƒ½æ˜¯ä¿®æ”¹æˆtrueï¼Œå®é™…å½±å“ä¸å¤§</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *Coordinator)</span></span> FinishedTask(args *FinishArgs, reply *Task) <span class="hljs-type">error</span> &#123;<br><span class="hljs-comment">//æ ‡è®°ä»»åŠ¡æ˜¯å¦å®Œæˆ</span><br><span class="hljs-comment">//todo æœ‰å¿…è¦åŠ é”å—ï¼Œ ç¡®å®æ˜¯å…±äº«çš„å˜é‡</span><br><span class="hljs-comment">//äº‹å®è¯æ˜æ˜¯ä¸éœ€è¦åŠ é”çš„</span><br><span class="hljs-keyword">switch</span> args.Ts.TaskType &#123;<br><span class="hljs-keyword">case</span> MapTask:<br>c.finishedMapfiles[args.Ts.TaskNum] = <span class="hljs-literal">true</span><br>fmt.Println(args.Ts.TaskNum)<br><br><span class="hljs-keyword">case</span> ReduceTask:<br>c.finishedReducefiles[args.Ts.TaskNum] = <span class="hljs-literal">true</span><br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ä¸ºä»€ä¹ˆè¿™é‡ŒåŠ é”ä¼šå¯¼è‡´å‡ºé—®é¢˜å‘¢ï¼Ÿ</p><p>æˆ‘ä¸ªäººåˆ†æï¼Œå¯èƒ½æœ‰ä¸æ­£ç¡®çš„åœ°æ–¹ï¼Œæ¬¢è¿åˆ°giteeä¸ŠæŒ‡å‡º</p><p>ä»–çš„shellè„šæœ¬ä¼šå¯åŠ¨3ä¸ªworkerï¼Œè¿›è¡Œå¹¶å‘ï¼Œå½“å…¶ä¸­6ä¸ªéƒ½å®Œæˆäº†åªå‰©ä¸‹æœ€åä¸€ä¸ªæ²¡å®Œæˆæ˜¯ï¼Œå…¶ä¸­ä¸¤ä¸ªworkerä¼šåœ¨gettaskä¸­ä¸æ–­å¾ªç¯ï¼Œå¾ªç¯ä¼šæœ‰checkfinishï¼Œcheckfinishä¹Ÿä¼šå¯¹isfinishæ•°ç»„è¿›è¡Œè®¿é—®ï¼Œæ­¤æ—¶rpcè°ƒç”¨å®Œæˆå€Ÿå£å¹¶ä¸”åŠ é”ï¼Œå¯èƒ½æ˜¯å¯¼è‡´ä¸èƒ½åŠæ—¶è®²ä»»åŠ¡çš„isfinishæ•°ç»„è®¾ç½®trueçš„åŸå› </p><p>æœ€åé™„ä¸Šæˆ‘çš„ç»“æ„ä½“å®šä¹‰</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Coordinator <span class="hljs-keyword">struct</span> &#123;<br><span class="hljs-comment">// Your definitions here.</span><br>mu sync.Mutex<br>nReduce <span class="hljs-type">int</span> <span class="hljs-comment">//how much tasks need to done </span><br>files    []<span class="hljs-type">string</span><br>finishedMapfiles []<span class="hljs-type">bool</span><br>TimesfinishedMapfiles []time.Time<br>finishedReducefiles []<span class="hljs-type">bool</span><br>TimesfinishedReducefiles []time.Time<br>Isdone <span class="hljs-type">bool</span> <span class="hljs-comment">//æ˜¯å¦å…¨éƒ¨å®Œæˆ</span><br><br>&#125;<br><span class="hljs-keyword">type</span> Task <span class="hljs-keyword">struct</span> &#123;<br>TaskType   TaskType   <br>TaskNum <span class="hljs-type">int</span>     <span class="hljs-comment">//ä»»åŠ¡çš„åºå·</span><br>ReduceSum <span class="hljs-type">int</span> <span class="hljs-comment">//the sum of tasks needed to reduce</span><br>MapSum <span class="hljs-type">int</span> <span class="hljs-comment">// the sum of tasks needed to map</span><br>Filename   <span class="hljs-type">string</span>   <br>&#125;<br><br><span class="hljs-keyword">type</span> TaskArgs <span class="hljs-keyword">struct</span>&#123;<br>TaskType   TaskType   <br>TaskNum <span class="hljs-type">int</span><br>&#125;<br><br><span class="hljs-keyword">type</span> FinishArgs <span class="hljs-keyword">struct</span>&#123;<br>Ts Task<br>&#125;<br><br><span class="hljs-keyword">type</span> TaskType <span class="hljs-type">int</span><br><br><span class="hljs-keyword">const</span> (<br>MapTask TaskType = <span class="hljs-literal">iota</span><br>ReduceTask<br>CompleteTask    <br>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Distributed system</category>
      
      <category>lab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MIT6.824</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç®—æ³•é¢˜å‹æ€è·¯æ€»ç»“</title>
    <link href="/2023/09/19/%E7%AE%97%E6%B3%95%E9%A2%98%E5%9E%8B%E6%80%9D%E8%B7%AF%E6%80%BB%E7%BB%93/"/>
    <url>/2023/09/19/%E7%AE%97%E6%B3%95%E9%A2%98%E5%9E%8B%E6%80%9D%E8%B7%AF%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<p>ç”¨äºè®°å½•ä¸ªäººåˆ·åˆ°ç”¨æ—¶è¾ƒé•¿æˆ–è€…æ²¡æœ‰æ€è·¯çš„é¢˜ç›®è®°å½•ä¸€ä¸‹è§£é¢˜æ€è·¯</p><p>å‰æœŸç”¨c++åˆ·äº†ä¸€éƒ¨åˆ†å‰‘æŒ‡offerçš„é¢˜ç›®ï¼ŒåæœŸçœ‹è¦ä¸å…¨è½¬goå§</p><p>è®°å½• 9.25 å¼€å§‹åˆ·leetcodeçƒ­é¢˜100 ï¼Œ å‰‘æŒ‡offerå·®æ¨¡æ‹Ÿï¼Œä½è¿ç®—å’Œå…¶ä»–ç®—æ³•  ç°å·²åˆ‡æ¢åˆ°go</p><h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h2><h3 id="å…¨æ’åˆ—"><a href="#å…¨æ’åˆ—" class="headerlink" title="å…¨æ’åˆ—"></a>å…¨æ’åˆ—</h3><p>é¢˜ç›®ç´¢å¼• : <a href="https://www.nowcoder.com/practice/fe6b651b66ae47d7acce78ffdd9a96c7?tpId=13&tqId=23291&ru=/exam/oj/ta&qru=/ta/coding-interviews/question-ranking&sourceUrl=/exam/oj/ta?page=1&tpId=13&type=13"><strong>å­—ç¬¦ä¸²çš„æ’åˆ—</strong></a></p><p>åªèƒ½è¯´å›æº¯å¿˜çš„å·®ä¸å¤šäº†ï¼Œé€šè¿‡è¿™é¢˜æ¥å›é¡¾ä¸€ä¸‹</p><p>è¿™è¾¹ä¸»è¦æ˜¯ç”¨åˆ°äº†ä¸€ä¸ªsetï¼Œé€šè¿‡seté›†åˆæ¥å»é™¤é‡å¤çš„éƒ¨åˆ†ï¼Œè®©é¢˜ç›®å˜çš„æ›´åŠ ç®€å•</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>  <span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä»£ç ä¸­çš„ç±»åã€æ–¹æ³•åã€å‚æ•°åå·²ç»æŒ‡å®šï¼Œè¯·å‹¿ä¿®æ”¹ï¼Œç›´æ¥è¿”å›æ–¹æ³•è§„å®šçš„å€¼å³å¯</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * @param str stringå­—ç¬¦ä¸²</span><br><span class="hljs-comment">     * @return stringå­—ç¬¦ä¸²vector</span><br><span class="hljs-comment">     */</span><br><br>    <span class="hljs-type">int</span> book[<span class="hljs-number">10</span>];<br>    set&lt;string&gt; v;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(string tmp, string str, vector&lt;<span class="hljs-type">int</span>&gt; vis)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (tmp.<span class="hljs-built_in">size</span>() == str.<span class="hljs-built_in">size</span>()) &#123;<br>            v.<span class="hljs-built_in">insert</span>(tmp);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; str.<span class="hljs-built_in">size</span>(); i++) &#123;<br>            <span class="hljs-keyword">if</span> (vis[i])<br>                <span class="hljs-keyword">continue</span>;<br><br>            <span class="hljs-comment">//æ ‡è®°ä¸ºä½¿ç”¨è¿‡</span><br>            vis[i] = <span class="hljs-number">1</span>;  <br>            <span class="hljs-comment">//åŠ å…¥ä¸´æ—¶å­—ç¬¦ä¸²</span><br>            tmp.<span class="hljs-built_in">push_back</span>(str[i]);<br>            <span class="hljs-built_in">dfs</span>( tmp, str, vis);<br>            <span class="hljs-comment">//å›æº¯</span><br>            vis[i] = <span class="hljs-number">0</span>;<br>            tmp.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br><br><br>    &#125;<br><br><br>    <span class="hljs-function">vector&lt;string&gt; <span class="hljs-title">Permutation</span><span class="hljs-params">(string str)</span> </span>&#123;<br>        <span class="hljs-comment">// write code here</span><br>    <br>        <span class="hljs-keyword">if</span> (str.<span class="hljs-built_in">empty</span>()) &#123;<br>           <span class="hljs-keyword">return</span>  vector&lt;string&gt;&#123;&#125;;<br>        &#125;<br><br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">vis</span><span class="hljs-params">(str.size(), <span class="hljs-number">0</span>)</span></span>;<br>        string tmp;<br>    <br>        <span class="hljs-built_in">dfs</span>(tmp, str, vis);<br><br>        <span class="hljs-keyword">return</span> vector&lt;string&gt;&#123;v.<span class="hljs-built_in">begin</span>(),v.<span class="hljs-built_in">end</span>()&#125;;<br><br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²"><a href="#æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²" class="headerlink" title="æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²"></a>æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²</h3><p>é¢˜ç›®é“¾æ¥ï¼š <a href="https://www.nowcoder.com/practice/48d2ff79b8564c40a50fa79f9d5fa9c7?tpId=13&tqId=2276769&ru=/exam/oj/ta&qru=/ta/coding-interviews/question-ranking&sourceUrl=/exam/oj/ta?page=1&tpId=13&type=13">æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;map&gt;</span></span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä»£ç ä¸­çš„ç±»åã€æ–¹æ³•åã€å‚æ•°åå·²ç»æŒ‡å®šï¼Œè¯·å‹¿ä¿®æ”¹ï¼Œç›´æ¥è¿”å›æ–¹æ³•è§„å®šçš„å€¼å³å¯</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * @param s stringå­—ç¬¦ä¸² </span><br><span class="hljs-comment">     * @return intæ•´å‹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">lengthOfLongestSubstring</span><span class="hljs-params">(string s)</span> </span>&#123;<br>        <span class="hljs-comment">// write code here</span><br>        map&lt;<span class="hljs-type">char</span>, <span class="hljs-type">int</span> &gt;m;<br>        <span class="hljs-type">int</span> length = <span class="hljs-number">0</span> ;<br>        <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i&lt;s.<span class="hljs-built_in">size</span>(); i++) &#123;<br>            m[s[i]]++;<br>            right = i;<br>            <span class="hljs-keyword">while</span> (m[s[i]]&gt;<span class="hljs-number">1</span>) &#123;<br>                m[s[left++]]--;<br><br>            &#125;<br>             <span class="hljs-type">int</span> m_size = m.<span class="hljs-built_in">size</span>();<br>            length = <span class="hljs-built_in">max</span>(length,right - left +<span class="hljs-number">1</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> length;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯"><a href="#æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯" class="headerlink" title="æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯"></a>æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯</h3><p>é¢˜ç›®è¿æ¥ ï¼š<a href="https://leetcode.cn/problems/find-all-anagrams-in-a-string/">æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯</a></p><p>è‡ªå·±çš„åªé€šè¿‡äº†62&#x2F;65ä¸ªæµ‹è¯•ç”¨ä¾‹ ï¼Œåé¢èŠ‚çœæ—¶é—´ç›´æ¥çœ‹ç­”æ¡ˆäº†ï¼Œå‘ç°ç­”æ¡ˆå†™çš„æ¯”æˆ‘å†™çš„ç®€æ´å¤šäº† QAQ</p><p>å¤§ä½“æ€è·¯æ˜¯å·®ä¸å¤šçš„ï¼Œå¯èƒ½æˆ‘æœ‰äº›è¯¦è§£æ²¡å¤„ç†å¥½å§ï¼Œæ’ä¸ªçœ¼åé¢å†æ¥ä¸€é</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">findAnagrams</span><span class="hljs-params">(s <span class="hljs-type">string</span>, p <span class="hljs-type">string</span>)</span></span>(ans []<span class="hljs-type">int</span>) &#123;<br> sLen, pLen := <span class="hljs-built_in">len</span>(s), <span class="hljs-built_in">len</span>(p)<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(s) &lt; <span class="hljs-built_in">len</span>(p) &#123;<br><span class="hljs-keyword">return</span> []<span class="hljs-type">int</span>&#123;&#125;<br>&#125;<br><span class="hljs-keyword">var</span> sCount, pCount [<span class="hljs-number">26</span>]<span class="hljs-type">int</span><br><span class="hljs-keyword">for</span> i, ch := <span class="hljs-keyword">range</span> p &#123;<br>        sCount[s[i]-<span class="hljs-string">&#x27;a&#x27;</span>]++<br>        pCount[ch-<span class="hljs-string">&#x27;a&#x27;</span>]++<br>    &#125;<br><span class="hljs-keyword">if</span> sCount == pCount &#123;<br>        ans = <span class="hljs-built_in">append</span>(ans, <span class="hljs-number">0</span>)<br>    &#125;<br><br> <span class="hljs-keyword">for</span> i, ch := <span class="hljs-keyword">range</span> s[:sLen-pLen] &#123;<br>        sCount[ch-<span class="hljs-string">&#x27;a&#x27;</span>]--<br>        sCount[s[i+pLen]-<span class="hljs-string">&#x27;a&#x27;</span>]++<br>        <span class="hljs-keyword">if</span> sCount == pCount &#123;<br>            ans = <span class="hljs-built_in">append</span>(ans, i+<span class="hljs-number">1</span>)<br>        &#125;<br>    &#125;<br><br><br><span class="hljs-keyword">return</span> ans<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="å’Œä¸º-K-çš„å­æ•°ç»„"><a href="#å’Œä¸º-K-çš„å­æ•°ç»„" class="headerlink" title="å’Œä¸º K çš„å­æ•°ç»„"></a>å’Œä¸º K çš„å­æ•°ç»„</h3><p>é¢˜ç›®è¿æ¥ ï¼š <a href="https://leetcode.cn/problems/subarray-sum-equals-k/">å’Œä¸º K çš„å­æ•°ç»„</a></p><p>åˆ©ç”¨å‰ç¼€å’Œ ä¸ map é™ä½å¤æ‚åº¦</p><p>pre[i] - pre[j] &#x3D;&#x3D;k</p><p>é€šè¿‡mapæ¥è®°å½• m[pre[i]-k]æ˜¯å¦å­˜åœ¨ ï¼Œä»¥åŠæœ‰å¤šå°‘ä¸ªç­‰äºè¿™ä¸ªå€¼çš„å‰ç¼€å’Œ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">subarraySum</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>, k <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>    m:=<span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]<span class="hljs-type">int</span>)<br>    <span class="hljs-keyword">var</span> pre <span class="hljs-type">int</span><br>    pre = <span class="hljs-number">0</span><br>    count:= <span class="hljs-number">0</span><br>    m[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i:=<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">len</span>(nums);i++&#123;<br>        pre = pre+nums[i]<br>        v,ok:=m[pre-k]<br>        <span class="hljs-keyword">if</span> ok &#123;<br>            count+=v<br>        &#125;<br>     m[pre] += <span class="hljs-number">1</span><br>    &#125;<br><span class="hljs-keyword">return</span> count<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æœ€å°è¦†ç›–å­ä¸²"><a href="#æœ€å°è¦†ç›–å­ä¸²" class="headerlink" title="æœ€å°è¦†ç›–å­ä¸²"></a>æœ€å°è¦†ç›–å­ä¸²</h3><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://leetcode.cn/problems/minimum-window-substring/">æœ€å°è¦†ç›–å­ä¸²</a></p><p>è‡ªå·±èŠ±äº†æŒºé•¿æ—¶é—´æ‰åšå‡ºæ¥ï¼Œè®°å½•ä¸‹æ€è·¯</p><p>å…¶å®çœ‹åˆ°è¿™é¢˜çš„æƒ³æ³•æ˜¯æ­£ç¡®çš„ï¼Œæ»‘åŠ¨çª—å£ï¼Œmapè®°å½•</p><p>ä½†æ˜¯è¿™ä¸ªçª—å£æ€ä¹ˆå®šï¼Œæˆ‘ä¸€å¼€å§‹çš„æ€è·¯æ˜¯ä¸å¤ªå¥½çš„ï¼Œæˆ‘ä¸€å¼€å§‹è§„å®šäº†çª—å£çš„å¤§å°</p><p>ç„¶åçœ‹äº†é¢˜è§£çš„ï¼Œä¸€å¼€å§‹å°†çª—å£å®šä¸º0ï¼Œç„¶åå¦‚æœæ²¡æœ‰åŒ…å«å­—ä¸²å°±ç§»åŠ¨å³æŒ‡é’ˆï¼Œå¦‚æœåŒ…å«å°±ç§»åŠ¨å·¦æŒ‡é’ˆæ‰¾æœ€å°å­ä¸²</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">minWindow</span><span class="hljs-params">(s <span class="hljs-type">string</span>, t <span class="hljs-type">string</span>)</span></span> <span class="hljs-type">string</span> &#123;<br>m := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">byte</span>]<span class="hljs-type">int</span>)<br>m2 := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">byte</span>]<span class="hljs-type">int</span>)<br>left, right := <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>minn := <span class="hljs-number">99999999</span><br>idx_left, idx_right := <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> _, v := <span class="hljs-keyword">range</span> t &#123;<br>m[<span class="hljs-type">byte</span>(v)]++<br>&#125;<br><br>count := <span class="hljs-number">0</span><br>_, ok := m[s[<span class="hljs-number">0</span>]]<br><span class="hljs-keyword">if</span> ok &#123;<br>m2[s[<span class="hljs-number">0</span>]]++<br><span class="hljs-keyword">if</span> m2[s[<span class="hljs-number">0</span>]] == m[s[<span class="hljs-number">0</span>]] &#123;<br>count++<br>&#125;<br>&#125;<br>right++<br><span class="hljs-keyword">for</span> right &lt;= <span class="hljs-built_in">len</span>(s) &#123;<br><span class="hljs-keyword">if</span> count == <span class="hljs-built_in">len</span>(m) &#123;<br><span class="hljs-keyword">if</span> minn &gt; right-left+<span class="hljs-number">1</span> &#123;<br>minn = right - left + <span class="hljs-number">1</span><br>idx_left = left<br>idx_right = right<br>&#125;<br>_, ok := m[s[left]]<br><span class="hljs-keyword">if</span> ok &#123;<br>m2[s[left]]--<br><span class="hljs-keyword">if</span> m2[s[left]] &lt; m[s[left]] &#123;<br>count--<br>&#125;<br>&#125;<br>left++<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">if</span> right == <span class="hljs-built_in">len</span>(s) &#123;<br><span class="hljs-keyword">break</span><br>&#125;<br>_, ok := m[s[right]]<br><span class="hljs-keyword">if</span> ok &#123;<br>m2[s[right]]++<br><span class="hljs-keyword">if</span> m2[s[right]] == m[s[right]] &#123;<br>count++<br>&#125;<br>&#125;<br>right++<br>&#125;<br><br>&#125;<br><span class="hljs-keyword">return</span> s[idx_left:idx_right]<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="æœç´¢"><a href="#æœç´¢" class="headerlink" title="æœç´¢"></a>æœç´¢</h2><h3 id="æ•°å­—åºåˆ—ä¸­æŸä¸€ä½çš„æ•°å­—-æ¨¡æ‹Ÿé¢˜"><a href="#æ•°å­—åºåˆ—ä¸­æŸä¸€ä½çš„æ•°å­—-æ¨¡æ‹Ÿé¢˜" class="headerlink" title="æ•°å­—åºåˆ—ä¸­æŸä¸€ä½çš„æ•°å­— (æ¨¡æ‹Ÿé¢˜)"></a><strong>æ•°å­—åºåˆ—ä¸­æŸä¸€ä½çš„æ•°å­—</strong> (æ¨¡æ‹Ÿé¢˜)</h3><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://www.nowcoder.com/practice/29311ff7404d44e0b07077f4201418f5?tpId=13&tqId=2285751&ru=/exam/oj/ta&qru=/ta/coding-interviews/question-ranking&sourceUrl=/exam/oj/ta?page=1&tpId=13&type=13"><strong>æ•°å­—åºåˆ—ä¸­æŸä¸€ä½çš„æ•°å­—</strong></a></p><p>è¿™é¢˜éš¾ç‚¹ä¸»è¦æ˜¯æ—¶é—´å¤æ‚åº¦æ€ä¹ˆé™ä¸‹æ¥ï¼Œä¸ç„¶å½“nç­‰äº10äº¿çš„æ—¶å€™ä¼šè¶…æ—¶</p><p>æˆ‘ä¹Ÿæ˜¯çœ‹äº†å¤§ä½¬çš„é¢˜è§£</p><p>1åˆ°9æœ‰9ä¸ªæ•° 9ä¸ªå•ä¸ªæ•°å­—</p><p>10åˆ°99 æœ‰ 90ä¸ªä¸ªæ•° ï¼Œ 180ä¸ªå•ä¸ªæ•°å­—</p><p>100åˆ°999æœ‰900ä¸ªä¸ªæ•°ï¼Œ 2700ä¸ªå•ä¸ªæ•°å­—ï¼Œç”±æ­¤ç±»æ¨</p><p>æˆ‘ä»¬åªéœ€è¦å°†nä¸å½“å‰é˜¶æ®µæ‰€æœ‰çš„å•ä¸ªæ•°å­—åšä¸ªæ¯”è¾ƒ</p><p>å½“nå°äºå½“å‰é˜¶æ®µæ‰€æœ‰çš„å•ä¸ªæ•°å­—åï¼Œå°±è¯´æ˜nåœ¨è¿™ä¸ªèŒƒå›´å†…</p><p>ç„¶åæˆ‘ä»¬é€šè¿‡ n&#x2F;countï¼ˆcountè¡¨ç¤ºå½“å‰é˜¶æ®µæ˜¯å‡ ä½æ•°ï¼‰æ¥ç¡®å®šnæ‰€åœ¨æ˜¯æ•°æ˜¯å¤šå°‘</p><p>é€šè¿‡n%countæ¥ç¡®å®šnè¡¨ç¤ºçš„æ˜¯æ‰€åœ¨æ•°çš„ç¬¬å‡ ä¸ªæ•°å­—</p><p>è¿™è¾¹å°¤å…¶è¦æ³¨æ„nå¾—å‡å»ä¸€ï¼Œå› ä¸ºæ•°ç»„çš„ä¸‹æ ‡æ˜¯ä»0å¼€å§‹çš„ï¼Œå¦‚æœä¸å‡å»1çš„è¯ä¼šè¶Šç•Œ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä»£ç ä¸­çš„ç±»åã€æ–¹æ³•åã€å‚æ•°åå·²ç»æŒ‡å®šï¼Œè¯·å‹¿ä¿®æ”¹ï¼Œç›´æ¥è¿”å›æ–¹æ³•è§„å®šçš„å€¼å³å¯</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * @param n intæ•´å‹ </span><br><span class="hljs-comment">     * @return intæ•´å‹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">findNthDigit</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> </span>&#123;<br>        <span class="hljs-comment">// write code here</span><br>        <span class="hljs-type">long</span> <span class="hljs-type">long</span> deep = <span class="hljs-number">9</span>;<br>        <span class="hljs-type">int</span> num =<span class="hljs-number">0</span>;<br>        <span class="hljs-type">long</span> <span class="hljs-type">long</span>  sum = <span class="hljs-number">9</span>;<br>        <span class="hljs-type">int</span> count = <span class="hljs-number">1</span> ;<br>        <span class="hljs-keyword">if</span>(n==<span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>        <br>        <span class="hljs-keyword">while</span> (n&gt;sum) &#123;<br>           n-=sum;<br>           deep*=<span class="hljs-number">10</span>;<br>           count ++;<br>           sum = deep*count;<br>        &#125;<br>       <span class="hljs-type">int</span> index =  (n<span class="hljs-number">-1</span>)/count;<br>       string ans =    <span class="hljs-built_in">to_string</span>(deep/<span class="hljs-number">9</span> + index);<br>       n= (n<span class="hljs-number">-1</span>)%count;<br><br>        <span class="hljs-keyword">return</span> ans[n] -<span class="hljs-string">&#x27;0&#x27;</span>;<br><br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><blockquote><p>ä¸ªäººå¯¹äºè¿™ä¸€å—æ¯”è¾ƒè–„å¼±ï¼Œæ‰€ä»¥å¼€å§‹å¯èƒ½ä¼šæ¯”è¾ƒå¤šçš„é¢˜ç›®ä»¥åŠè¿™äº›é¢˜ç›®å¯èƒ½åœ¨åé¢åŸºç¡€æ‰å®äº†åä¼šè§‰å¾—éå¸¸ç®€å•çš„é¢˜ç›®ï¼Œè§è°…~</p></blockquote><h3 id="JZ42-è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ"><a href="#JZ42-è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ" class="headerlink" title="JZ42 è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ"></a>JZ42 è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ</h3><p>é¢˜ç›®é“¾æ¥ï¼š <a href="https://www.nowcoder.com/practice/459bd355da1549fa8a49e350bf3df484?tpId=13&tqId=23259&ru=/exam/oj/ta&qru=/ta/coding-interviews/question-ranking&sourceUrl=/exam/oj/ta?page=1&tpId=13&type=13">è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ</a></p><p> é‡æ–°æ¡èµ·åŠ¨æ€è§„åˆ’çš„ç¬¬ä¸€é¢˜ã€‚ä¹‹å‰æœ‰ä¸€å®šçš„åŠ¨æ€è§„åˆ’åŸºç¡€ï¼Œæ‰€ä»¥è§åˆ°è¿™é¢˜å°±æƒ³ç”¨çŠ¶æ€æœºï¼Œä¸Šæ¥å°±æ¥ä¸€ä¸ªbook[30000][2],æ¥è¡¨ç¤ºé€‰æˆ–è€…ä¸é€‰å¯¹åº”çš„æ•°ï¼Œä½†å‘ç°æ— ä»ä¸‹æ‰‹ï¼ˆé¢˜åˆ·å°‘äº†ï¼Œæ€ç»´è¿˜æ˜¯å¤ªåƒµç¡¬äº†ï¼‰</p><p>åç›´æ¥çœ‹å¤§ä½¬çš„è§£æï¼Œç„¶åé¢†ä¼šåˆ°äº†æ„æ€åï¼Œå¾ˆå¿«å°±å†™å‡ºæ¥äº†</p><p>å› ä¸ºæ˜¯é€‰æ•°éƒ½è¦æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†array[i]ä½œä¸ºå½“å‰å­æ•°ç»„dp[i]çš„ç»“å°¾ï¼Œè¿™æ ·çš„è¯å°±èƒ½æ„æˆé€’æ¨å…³ç³»äº†ï¼Œæˆ‘ä»¬åªéœ€è¦å°†array[i]å’Œdp[i-1]+array[i]è¿›è¡Œå¯¹æ¯”å–æœ€å¤§çš„å°±å¯ä»¥å¾—åˆ°dp[i]</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä»£ç ä¸­çš„ç±»åã€æ–¹æ³•åã€å‚æ•°åå·²ç»æŒ‡å®šï¼Œè¯·å‹¿ä¿®æ”¹ï¼Œç›´æ¥è¿”å›æ–¹æ³•è§„å®šçš„å€¼å³å¯</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * @param array intæ•´å‹vector </span><br><span class="hljs-comment">     * @return intæ•´å‹</span><br><span class="hljs-comment">     */</span><br>     <span class="hljs-type">int</span> dp[<span class="hljs-number">30000</span>];<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">FindGreatestSumOfSubArray</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; array)</span> </span>&#123;<br>        <span class="hljs-comment">// write code here</span><br>        dp[<span class="hljs-number">0</span>]= array[<span class="hljs-number">0</span>];<br>         <span class="hljs-type">int</span> max1 = dp[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i&lt;array.<span class="hljs-built_in">size</span>(); i++) &#123;<br>            dp[i]=<span class="hljs-built_in">max</span>(dp[i<span class="hljs-number">-1</span>]+array[i],array[i]);<br>            <span class="hljs-keyword">if</span> (max1&lt;dp[i]) &#123;<br>               max1 = dp[i];<br>            &#125;<br>        &#125;<br><br>    <span class="hljs-keyword">return</span> max1;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="ä¹°è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº"><a href="#ä¹°è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº" class="headerlink" title="ä¹°è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº"></a>ä¹°è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº</h3><h3 id="ç›®æ ‡å’Œ"><a href="#ç›®æ ‡å’Œ" class="headerlink" title="ç›®æ ‡å’Œ"></a>ç›®æ ‡å’Œ</h3><p>é¢˜ç›®é“¾æ¥ï¼š <a href="https://leetcode.cn/problems/target-sum/">ç›®æ ‡å’Œ</a></p><p>ç»è¿‡æ•°å­¦è½¬æ¢åå°±æ˜¯01èƒŒåŒ…é—®é¢˜</p><p>é€’å½’è§£æ³• ï¼š æ—¶é—´å¤æ‚åº¦å¾ˆå·®</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs go"><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">dfs</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>, target <span class="hljs-type">int</span>,index <span class="hljs-type">int</span> )</span></span> <span class="hljs-type">int</span> &#123;<br>    <span class="hljs-keyword">if</span> index &lt; <span class="hljs-number">0</span>  &#123;<br>         <span class="hljs-keyword">if</span> target == <span class="hljs-number">0</span> &#123;<br>         <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    &#125;<br>         <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <br>    &#125;<br>   <br>    <span class="hljs-keyword">if</span> nums[index]&gt; target &#123;<br>        <span class="hljs-keyword">return</span> dfs(nums,target,index<span class="hljs-number">-1</span>)<br>    &#125;<br>    <span class="hljs-keyword">return</span> dfs(nums,target,index<span class="hljs-number">-1</span>)+dfs(nums,target-nums[index],index<span class="hljs-number">-1</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">findTargetSumWays</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>, target <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>    <span class="hljs-comment">//è®¾é€‰æ‹©çš„æ­£æ•°çš„å’Œæ˜¯p</span><br>    <span class="hljs-comment">//é‚£ä¹ˆè´Ÿæ•°çš„å’Œå°±æ˜¯s , æ€»å’Œæ˜¯t    s = t -p </span><br>    <span class="hljs-comment">//æ‰€ä»¥  target =  p - t +p = 2p - t   p = (target+t) /2</span><br>    t :=  <span class="hljs-number">0</span> <br>    <span class="hljs-keyword">for</span> _,v :=  <span class="hljs-keyword">range</span> nums&#123;<br>        t+=v<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (target + t )%<span class="hljs-number">2</span>!= <span class="hljs-number">0</span>  &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    &#125; <br>    <span class="hljs-keyword">return</span>  dfs(nums,(target+t)/<span class="hljs-number">2</span>,<span class="hljs-built_in">len</span>(nums)<span class="hljs-number">-1</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>åŠ¨æ€è§„åˆ’è§£æ³•ï¼Œæ—¶é—´å¤æ‚åº¦å·²ç»æ˜¯æœ€ä¼˜çš„äº†ï¼Œå ç”¨å†…å­˜æ¯”ä¸Šé¢çš„å¤§äº›</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">findTargetSumWays</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>, target <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>    <span class="hljs-comment">//è®¾é€‰æ‹©çš„æ­£æ•°çš„å’Œæ˜¯p</span><br>    <span class="hljs-comment">//é‚£ä¹ˆè´Ÿæ•°çš„å’Œå°±æ˜¯s , æ€»å’Œæ˜¯t    s = t -p </span><br>    <span class="hljs-comment">//æ‰€ä»¥  target =  p - t +p = 2p - t   p = (target+t) /2</span><br>    t :=  <span class="hljs-number">0</span> <br>    <span class="hljs-keyword">for</span> _,v :=  <span class="hljs-keyword">range</span> nums&#123;<br>        t+=v<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (target + t )%<span class="hljs-number">2</span>!= <span class="hljs-number">0</span> || target+t &lt; <span class="hljs-number">0</span>  &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    &#125; <br>    target =  (target + t )/<span class="hljs-number">2</span><br>    <span class="hljs-keyword">var</span> dp [<span class="hljs-number">21</span>][<span class="hljs-number">1100</span>]<span class="hljs-type">int</span><br>    dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] =<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i,v :=  <span class="hljs-keyword">range</span> nums&#123;<br>        <span class="hljs-keyword">for</span> j:= <span class="hljs-number">0</span> ;j&lt;target+<span class="hljs-number">1</span> ; j++&#123;<br>            <span class="hljs-keyword">if</span> j &lt; v &#123;<br>                dp[i+<span class="hljs-number">1</span>][j] = dp[i][j]<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                dp[i+<span class="hljs-number">1</span>][j] = dp[i][j] + dp[i][j-v]<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> dp[<span class="hljs-built_in">len</span>(nums)][target]  <br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å•è¯æ‹†åˆ†"><a href="#å•è¯æ‹†åˆ†" class="headerlink" title="å•è¯æ‹†åˆ†"></a>å•è¯æ‹†åˆ†</h3><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://leetcode.cn/problems/word-break/">å•è¯æ‹†åˆ†</a></p><p>ä»£ç å¾ˆå°‘ï¼Œçœ‹èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œä½†æ˜¯æˆ‘å½“æ—¶åœ¨åšçš„æ—¶å€™æ²¡æ€è·¯QAQï¼Œè¿˜æ˜¯åŠ¨æ€è§„åˆ’é¢˜åˆ·å¤ªå°‘äº†</p><p>ç”¨dpï¼Œå…ˆå–å­—ç¬¦ä¸²çš„å­ä¸²ï¼Œç„¶ååˆ¤æ–­å­—ä¸²èƒ½å¦è¢«å­—å…¸é‡Œçš„å­—ç¬¦ä¸²æ‹¼æ¥è¡¨ç¤º</p><p>æˆ‘å½“æ—¶è§‰å¾—éš¾ä¸»è¦æ˜¯æƒ³ç€ä¸€ä¸ªå­—ç¬¦ä¸²å¯ä»¥æ‹†æˆâ€lâ€ â€œeâ€ eâ€ â€œtâ€ç­‰ç­‰ï¼Œæ‹†å‡ºéå¸¸å¤šæ¥</p><p>ä½†åé¢å‘ç°å…¶å®éƒ½æ˜¯å­é—®é¢˜ç½¢äº† :joy:</p><p>è¿˜æ˜¯å¤ªèœäº†ï¼Œè¦ç‹ ç‹ çš„åˆ·é¢˜ï¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">wordBreak</span><span class="hljs-params">(s <span class="hljs-type">string</span>, wordDict []<span class="hljs-type">string</span>)</span></span> <span class="hljs-type">bool</span> &#123;<br>    m := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">bool</span>)<br>    <span class="hljs-keyword">for</span> _,v:=<span class="hljs-keyword">range</span> wordDict &#123;<br>         m[v] = <span class="hljs-literal">true</span><br>    &#125;<br>    dp:=<span class="hljs-built_in">make</span>([]<span class="hljs-type">bool</span>,<span class="hljs-built_in">len</span>(s)+<span class="hljs-number">1</span>)<br>    dp[<span class="hljs-number">0</span>] = <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">for</span> i:=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-built_in">len</span>(s);i++ &#123;<br>        <span class="hljs-keyword">for</span> j :=<span class="hljs-number">0</span> ; j&lt;i;j++ &#123;<br>            <span class="hljs-keyword">if</span> dp[j]&amp;&amp;m[s[j:i]]&#123;<br>                dp[i] = <span class="hljs-literal">true</span><br>                <span class="hljs-keyword">break</span><br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> dp[<span class="hljs-built_in">len</span>(s)]<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æœ€é•¿é€’å¢å­åºåˆ—"><a href="#æœ€é•¿é€’å¢å­åºåˆ—" class="headerlink" title="æœ€é•¿é€’å¢å­åºåˆ—"></a>æœ€é•¿é€’å¢å­åºåˆ—</h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://leetcode.cn/problems/longest-increasing-subsequence/">æœ€é•¿é€’å¢å­åºåˆ—</a></p><p>æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦éƒ½æ¯”è¾ƒå·®çš„åšæ³•ï¼Œç”¨äº†ä¸¤ä¸ªå¾ªç¯ O(n^2)</p><p>dp[i]è¡¨ç¤ºå½“å‰ä»¥ç¬¬ <em>i</em>ä¸ªæ•°å­—ç»“å°¾çš„æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦</p><p>æ‰€ä»¥å¦‚æœnums[i]&gt; nums[j] é‚£ä¹ˆä¼šæœ‰dp[i] &#x3D; dp[j]+1 (å¦‚æœæ¯”dpã€iã€‘å¤§çš„è¯)</p><p>è‡ªå·±å½“æ—¶åšçš„æ—¶å€™æƒ³åˆ°äº†dpã€iã€‘çš„å«ä¹‰ï¼Œä½†æ˜¯å°±è¿‡ç¨‹æ€ä¹ˆè®¡ç®—å‡ºäº†ç‚¹é—®é¢˜</p><p>è¿˜å¯ä»¥è¿›è¡Œä¼˜åŒ–ï¼Œæ’ä¸ªçœ¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">lengthOfLIS</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>     <span class="hljs-keyword">if</span> (<span class="hljs-built_in">len</span>(nums) == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>        &#125;<br>dp := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-built_in">len</span>(nums)+<span class="hljs-number">1</span>)<br>dp[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span><br>m := <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt; <span class="hljs-built_in">len</span>(nums); i++ &#123;<br>dp[i] = <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> j := <span class="hljs-number">0</span>; j &lt; i; j++ &#123;<br><span class="hljs-keyword">if</span> nums[j] &lt; nums[i] &#123;<br>dp[i] = max(dp[i], dp[j]+<span class="hljs-number">1</span>)<br>&#125;<br>&#125;<br>m = max(m, dp[i])<br>&#125;<br><span class="hljs-keyword">return</span> m<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">max</span><span class="hljs-params">(a,b <span class="hljs-type">int</span> )</span></span><span class="hljs-type">int</span> &#123;<br>    <span class="hljs-keyword">if</span> a&lt;b&#123;<br>        <span class="hljs-keyword">return</span> b<br>    &#125;<br>    <span class="hljs-keyword">return</span>  a<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸²"><a href="#æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸²" class="headerlink" title="æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸²"></a><strong>æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸²</strong></h3><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://www.nowcoder.com/practice/046a55e6cd274cffb88fc32dba695668?tpId=13&tqId=1024831&ru=/exam/oj/ta&qru=/ta/coding-interviews/question-ranking&sourceUrl=/exam/oj/ta?page=1&tpId=13&type=13">æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸²</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;streambuf&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>  <span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä»£ç ä¸­çš„ç±»åã€æ–¹æ³•åã€å‚æ•°åå·²ç»æŒ‡å®šï¼Œè¯·å‹¿ä¿®æ”¹ï¼Œç›´æ¥è¿”å›æ–¹æ³•è§„å®šçš„å€¼å³å¯</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * è§£ç </span><br><span class="hljs-comment">     * @param nums stringå­—ç¬¦ä¸² æ•°å­—ä¸²</span><br><span class="hljs-comment">     * @return intæ•´å‹</span><br><span class="hljs-comment">     */</span><br>   <br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">solve</span><span class="hljs-params">(string nums)</span> </span>&#123;<br>        <span class="hljs-comment">// write code here</span><br>          <span class="hljs-type">int</span> dp[nums.<span class="hljs-built_in">size</span>()] ;<br>          <span class="hljs-built_in">memset</span>(dp, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(dp));<br>        <span class="hljs-keyword">if</span> (nums[<span class="hljs-number">0</span>] != <span class="hljs-string">&#x27;0&#x27;</span>) &#123;<br>            dp[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span> ; i &lt; nums.<span class="hljs-built_in">size</span>(); i++) &#123;<br>            <span class="hljs-keyword">if</span> (nums[i] != <span class="hljs-string">&#x27;0&#x27;</span>) &#123;<br>                dp[i] += dp[i -<br>                            <span class="hljs-number">1</span>]; <span class="hljs-comment">// å¦‚æœnums[i]ä¸ä¸º0ï¼Œé‚£ä¹ˆå°±å¯ä»¥å•ç‹¬ä½œä¸ºä¸€ä¸ªæ•°è¿›è¡Œè§£æ</span><br>            &#125;<br><br>            <span class="hljs-comment">//æ¥ç€åˆ¤æ–­æ˜¯å¦å¯ä»¥å’Œnums[i-1]è¿›è¡Œç»„åˆç¿»è¯‘</span><br>            <span class="hljs-keyword">if</span> (nums[i - <span class="hljs-number">1</span>] != <span class="hljs-string">&#x27;0&#x27;</span>) &#123;<br>                string str;<br>                str.<span class="hljs-built_in">push_back</span>(nums[i - <span class="hljs-number">1</span>]);<br>                str.<span class="hljs-built_in">push_back</span>(nums[i]);<br>                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">stoi</span>(str) &gt;= <span class="hljs-number">10</span> &amp;&amp; <span class="hljs-built_in">stoi</span>(str) &lt;= <span class="hljs-number">26</span>) &#123;<br>                    <span class="hljs-keyword">if</span> (i == <span class="hljs-number">1</span>) &#123; <span class="hljs-comment">//å³f(2)ï¼Œå› ä¸ºä¸å­˜åœ¨f(0)ï¼Œæ‰€ä»¥éœ€è¦ç‰¹æ®Šå¤„ç†ï¼š</span><br>                        dp[i] += <span class="hljs-number">1</span>;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        dp[i] += dp[i - <span class="hljs-number">2</span>];<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br><br><br>        <span class="hljs-keyword">return</span> dp[nums.<span class="hljs-built_in">length</span>()<span class="hljs-number">-1</span>];<br><br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="å®Œå…¨å¹³æ–¹æ•°"><a href="#å®Œå…¨å¹³æ–¹æ•°" class="headerlink" title="å®Œå…¨å¹³æ–¹æ•°"></a>å®Œå…¨å¹³æ–¹æ•°</h3><p>é¢˜ç›®é“¾æ¥ï¼š <a href="https://leetcode.cn/problems/perfect-squares/">å®Œå…¨å¹³æ–¹æ•°</a></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">numSquares</span><span class="hljs-params">(n <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>    m := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>,n+<span class="hljs-number">1</span>)<br>    m[<span class="hljs-number">0</span>] =<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i:=<span class="hljs-number">1</span>;i&lt;=n;i++ &#123;<br>        minn:= math.MaxInt32<br>        <span class="hljs-keyword">for</span> j:=<span class="hljs-number">1</span>; j*j&lt;=i;j++ &#123;<br>            minn = min(minn,m[i-j*j])<br>        &#125;<br>        m[i] = minn+<span class="hljs-number">1</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> m[n]<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">min</span><span class="hljs-params">(a,b <span class="hljs-type">int</span> )</span></span> <span class="hljs-type">int</span>&#123;<br>    <span class="hljs-keyword">if</span> a&lt;b &#123;<br>        <span class="hljs-keyword">return</span> a<br>    &#125;<br>    <span class="hljs-keyword">return</span> b<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ä¹˜ç§¯æœ€å¤§å­æ•°ç»„"><a href="#ä¹˜ç§¯æœ€å¤§å­æ•°ç»„" class="headerlink" title="ä¹˜ç§¯æœ€å¤§å­æ•°ç»„"></a>ä¹˜ç§¯æœ€å¤§å­æ•°ç»„</h3><p>é¢˜ç›®é“¾æ¥ ï¼š <a href="https://leetcode.cn/problems/maximum-product-subarray/">ä¹˜ç§¯æœ€å¤§å­æ•°ç»„</a></p><p>é¢˜è§£çš„æ€è·¯éå¸¸çš„å·§å¦™ç®€æ´</p><p>é¢˜è§£ç”¨äº†ä¸¤ç§çŠ¶æ€è¿›è¡Œè®°å½•è€Œä¸æ˜¯ä¸€ç§</p><p>å¹¶ä¸”ä½¿ç”¨æ»šåŠ¨æ•°ç»„å°†ç©ºé—´å¤æ‚åº¦é™åˆ°äº†O(1), å› ä¸ºåŒ…å«å½“å‰ä¸‹æ ‡ä¹˜ç§¯dp[i] å’Œä»–çš„å‰ä¸€ä¸ªdp[i-1]æ˜¯å¼ºç›¸å…³çš„</p><p>ä¸ºä»€ä¹ˆä½¿ç”¨ä¸¤ç§çŠ¶æ€ä¼šæ˜¯ä½¿å¾—ä»£ç å˜å¾—æ›´ç®€æ´æ›´ä¼˜é›…</p><p>ä½¿ç”¨ä¸€ç§çŠ¶æ€çš„è¯ï¼Œå¯¹äºnums[i]å¤§äºç­‰äº0çš„æ—¶å€™æ˜¯æ²¡æœ‰å½±å“çš„</p><p>ä½†æ˜¯å½“nums[i]å°äº0çš„æ—¶å€™ï¼Œdp[i]å’Œdp[i-1]ä¸æ˜¯å¼ºç›¸å…³çš„</p><p>å¦‚æœdp[i]æ˜¯æ­£çš„ï¼Œå¦‚æœä½¿ç”¨nums[i]å¤§äº0çš„é€’æ¨å…¬å¼ï¼Œé‚£ä¹ˆæ¯”å¦‚ -2 3 -4  ï¼Œä¼šå› ä¸ºdp[1] &#x3D;3 ,3* -4 &#x3D; -12 è€Œä½¿å¾—dp[2] &#x3D; -4,ä½†æ˜¯å®é™…ä¸Šdp[2]&#x3D; -2* 3 *-4 &#x3D; 24</p><p>å¦‚æœè¦å¤„ç†çš„è¯è¦åŠ å¾ˆå¤šæ¡ä»¶è¯­å¥è¿›è¡Œåˆ¤æ–­</p><p>ä½†å¦‚æœä½¿ç”¨ä¸¤ç§çŠ¶æ€çš„è¯ï¼Œæ¯”å¦‚å®šä¹‰ä¸€ä¸ªmaxå’Œmin ï¼Œåˆ†åˆ«ç”¨äºè®¡å…¥ä¸‹æ ‡iä¹‹å‰æœ€å¤§å€¼å’Œæœ€å°å€¼</p><p>å½“nums[i]å¤§äº0çš„æ—¶å€™ï¼Œä¹˜ä¸Šæœ€å¤§å€¼ï¼Œé‚£ä¹ˆå¾—åˆ°çš„å°±æ˜¯dp[i]çš„æœ€å¤§å€¼</p><p>å½“nums[i]æ˜¯å°äº0æ—¶ï¼Œå¯ä»¥å°è¯•ä¹˜ä¸Šæœ€å°å€¼ï¼Œå¦‚æœæœ€å°å€¼æ˜¯å°äº0çš„ï¼Œé‚£ä¹ˆå°±ä¼šçš„åˆ°ä¸€ä¸ªæœ€å¤§å€¼ï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³nums[i]ä¸ºè´Ÿæ•°çš„é—®é¢˜</p><p>å¼•å…¥ä¸€ä¸ªæœ€å°å€¼çš„çŠ¶æ€ï¼Œå¯è°“æ˜¯ç”»é¾™ç‚¹ç›ä¹‹ç¬”</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">maxProduct</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>m := nums[<span class="hljs-number">0</span>]<br>    mi:=  nums[<span class="hljs-number">0</span>]<br>    ans := nums[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt; <span class="hljs-built_in">len</span>(nums); i++ &#123;    <br>    mx, mn := m, mi<br>m= max(max(nums[i], mx*nums[i]),nums[i]*mn)<br>    mi = min( min(nums[i], mn*nums[i]),mx*nums[i])     <br>         ans =max(ans,m)<br>&#125;<br><span class="hljs-keyword">return</span> ans<br>&#125; <br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">max</span><span class="hljs-params">(a,b <span class="hljs-type">int</span> )</span></span><span class="hljs-type">int</span> &#123;<br>    <span class="hljs-keyword">if</span> a&lt;b &#123;<br>        <span class="hljs-keyword">return</span> b<br>    &#125;<br>    <span class="hljs-keyword">return</span> a <br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">min</span><span class="hljs-params">(a,b <span class="hljs-type">int</span> )</span></span><span class="hljs-type">int</span> &#123;<br>    <span class="hljs-keyword">if</span> a&gt;b &#123;<br>        <span class="hljs-keyword">return</span> b<br>    &#125;<br>    <span class="hljs-keyword">return</span> a <br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åˆ†å‰²ç­‰å’Œå­é›†"><a href="#åˆ†å‰²ç­‰å’Œå­é›†" class="headerlink" title="åˆ†å‰²ç­‰å’Œå­é›†"></a>åˆ†å‰²ç­‰å’Œå­é›†</h3><p>é¢˜ç›®é“¾æ¥ ï¼š <a href="https://leetcode.cn/problems/partition-equal-subset-sum/">åˆ†å‰²ç­‰å’Œå­é›†</a></p><p>è™½ç„¶ä¸€æ¬¡å°±åšå‡ºäº†å¹¶ä¸”acäº†ï¼Œå¹¶ä¸”ä»£ç ä¹Ÿè¿˜ç®—ä¼˜é›…</p><p>ä½†ä¸€çœ‹æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦ã€‚ã€‚ã€‚æˆ‘å¤ªèœäº†è¿˜æ˜¯QAQ</p><p>è®°å½•ä¸€ä¸‹è‡ªå·±çš„è§£æ³•</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">canPartition</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>)</span></span> <span class="hljs-type">bool</span> &#123;<br><span class="hljs-comment">//å°±æ˜¯ä¸ªç±»0-1èƒŒåŒ…</span><br>count := <span class="hljs-number">0</span><br>ans := <span class="hljs-literal">false</span><br><span class="hljs-keyword">for</span> _, v := <span class="hljs-keyword">range</span> nums &#123;<br>count += v<br>&#125;<br><span class="hljs-keyword">if</span> count%<span class="hljs-number">2</span> != <span class="hljs-number">0</span> &#123;<br><span class="hljs-keyword">return</span> ans<br>&#125;<br><span class="hljs-keyword">var</span> dp [<span class="hljs-number">210</span>][<span class="hljs-number">20010</span>]<span class="hljs-type">int</span><br>dp[<span class="hljs-number">0</span>][nums[<span class="hljs-number">0</span>]] = nums[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt; <span class="hljs-built_in">len</span>(nums); i++ &#123;<br><span class="hljs-keyword">for</span> j := <span class="hljs-number">1</span>; j &lt; count; j++ &#123;<br><span class="hljs-keyword">if</span> dp[i<span class="hljs-number">-1</span>][j] != <span class="hljs-number">0</span> &#123;<br>dp[i][j] = dp[i<span class="hljs-number">-1</span>][j]<br>&#125;<br><span class="hljs-keyword">if</span> dp[i<span class="hljs-number">-1</span>][j] != <span class="hljs-number">0</span> &amp;&amp; dp[i][j]+nums[i] == dp[i<span class="hljs-number">-1</span>][j]+nums[i] &#123;<br>dp[i][j+nums[i]] = dp[i<span class="hljs-number">-1</span>][j] + nums[i]<br>&#125;<br>&#125;<br><span class="hljs-keyword">if</span> dp[i][count/<span class="hljs-number">2</span>] == count/<span class="hljs-number">2</span> &#123;<br>ans = <span class="hljs-literal">true</span><br>&#125;<br>&#125;<br><br><span class="hljs-keyword">return</span> ans<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¼˜åŒ–æ’ä¸ªçœ¼</p><h2 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h2><h3 id="æ•°ç»„ä¸­çš„é€†åºå¯¹"><a href="#æ•°ç»„ä¸­çš„é€†åºå¯¹" class="headerlink" title="æ•°ç»„ä¸­çš„é€†åºå¯¹"></a>æ•°ç»„ä¸­çš„é€†åºå¯¹</h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://www.nowcoder.com/practice/96bd6684e04a44eb80e6a68efc0ec6c5?tpId=13&tqId=23260&ru=/exam/oj/ta&qru=/ta/coding-interviews/question-ranking&sourceUrl=/exam/oj/ta?page=1&tpId=13&type=13">æ•°ç»„ä¸­çš„é€†åºå¯¹</a></p><p>ä½¿ç”¨åˆ°äº†å½’å¹¶æ’åºçš„æ€æƒ³ ï¼ˆç„¶è€Œå¹³æ—¶ä¸æ€ä¹ˆç”¨ï¼Œå¿˜çš„å·®ä¸å¤šäº†ã€‚ã€‚ å›é¡¾ä¸€ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>  <span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä»£ç ä¸­çš„ç±»åã€æ–¹æ³•åã€å‚æ•°åå·²ç»æŒ‡å®šï¼Œè¯·å‹¿ä¿®æ”¹ï¼Œç›´æ¥è¿”å›æ–¹æ³•è§„å®šçš„å€¼å³å¯</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * @param nums intæ•´å‹vector</span><br><span class="hljs-comment">     * @return intæ•´å‹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">int</span> count=<span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Merge</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; sourceArr, <span class="hljs-type">int</span> tempArr[], <span class="hljs-type">int</span> startIndex, <span class="hljs-type">int</span> midIndex,</span></span><br><span class="hljs-params"><span class="hljs-function">               <span class="hljs-type">int</span> endIndex)</span> </span>&#123;<br>        <span class="hljs-type">int</span> i = startIndex, j = midIndex + <span class="hljs-number">1</span>, k = startIndex;<br>        <span class="hljs-keyword">while</span> (i != midIndex + <span class="hljs-number">1</span> &amp;&amp; j != endIndex + <span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-keyword">if</span> (sourceArr[i] &gt; sourceArr[j]) &#123;<br>                tempArr[k++] = sourceArr[j++];<br>                count+=midIndex-i+<span class="hljs-number">1</span>;<br>                count %= <span class="hljs-number">1000000007</span>;<br>            &#125; <span class="hljs-keyword">else</span><br>                tempArr[k++] = sourceArr[i++];<br>        &#125;<br>        <span class="hljs-keyword">while</span> (i != midIndex + <span class="hljs-number">1</span>)<br>            tempArr[k++] = sourceArr[i++];<br>        <span class="hljs-keyword">while</span> (j != endIndex + <span class="hljs-number">1</span>)<br>            tempArr[k++] = sourceArr[j++];<br>        <span class="hljs-keyword">for</span> (i = startIndex; i &lt;= endIndex; i++)<br>            sourceArr[i] = tempArr[i];<br>    &#125;<br><br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MergeSort</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; sourceArr, <span class="hljs-type">int</span> tempArr[], <span class="hljs-type">int</span> startIndex,</span></span><br><span class="hljs-params"><span class="hljs-function">                   <span class="hljs-type">int</span> endIndex)</span> </span>&#123;<br>        <span class="hljs-type">int</span> midIndex;<br>        <span class="hljs-keyword">if</span> (startIndex &lt; endIndex) &#123;<br>            midIndex = startIndex + (endIndex - startIndex) / <span class="hljs-number">2</span>; <br>            <span class="hljs-built_in">MergeSort</span>(sourceArr, tempArr, startIndex, midIndex);<br>            <span class="hljs-built_in">MergeSort</span>(sourceArr, tempArr, midIndex + <span class="hljs-number">1</span>, endIndex);<br>            <span class="hljs-built_in">Merge</span>(sourceArr, tempArr, startIndex, midIndex, endIndex);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">InversePairs</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums)</span> </span>&#123;<br>        <span class="hljs-type">int</span> b[nums.<span class="hljs-built_in">size</span>()];<br>        <span class="hljs-built_in">MergeSort</span>(nums, b, <span class="hljs-number">0</span>, nums.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>);<br>        <span class="hljs-keyword">return</span> count;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="å“ˆå¸Œ"><a href="#å“ˆå¸Œ" class="headerlink" title="å“ˆå¸Œ"></a>å“ˆå¸Œ</h2><h3 id="ä¸¤æ•°ä¹‹å’Œ"><a href="#ä¸¤æ•°ä¹‹å’Œ" class="headerlink" title="ä¸¤æ•°ä¹‹å’Œ"></a>ä¸¤æ•°ä¹‹å’Œ</h3><p>é¢˜ç›®é“¾æ¥ ï¼š <a href="https://leetcode.cn/problems/two-sum/solutions/434597/liang-shu-zhi-he-by-leetcode-solution/?envType=study-plan-v2&envId=top-100-liked">ä¸¤æ•°ä¹‹å’Œ</a></p><p>æ³¨æ„åˆ°æ–¹æ³•ä¸€çš„æ—¶é—´å¤æ‚åº¦è¾ƒé«˜çš„åŸå› æ˜¯å¯»æ‰¾ target - x çš„æ—¶é—´å¤æ‚åº¦è¿‡é«˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ›´ä¼˜ç§€çš„æ–¹æ³•ï¼Œèƒ½å¤Ÿå¿«é€Ÿå¯»æ‰¾æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨ç›®æ ‡å…ƒç´ ã€‚å¦‚æœå­˜åœ¨ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾å‡ºå®ƒçš„ç´¢å¼•ã€‚</p><p>ä½¿ç”¨å“ˆå¸Œè¡¨ï¼Œå¯ä»¥å°†å¯»æ‰¾ target - x çš„æ—¶é—´å¤æ‚åº¦é™ä½åˆ°ä» O(N)O(N)O(N) é™ä½åˆ° O(1)O(1)O(1)ã€‚</p><p>è¿™æ ·æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œå¯¹äºæ¯ä¸€ä¸ª xï¼Œæˆ‘ä»¬é¦–å…ˆæŸ¥è¯¢å“ˆå¸Œè¡¨ä¸­æ˜¯å¦å­˜åœ¨ target - xï¼Œç„¶åå°† x æ’å…¥åˆ°å“ˆå¸Œè¡¨ä¸­ï¼Œå³å¯ä¿è¯ä¸ä¼šè®© x å’Œè‡ªå·±åŒ¹é…ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">twoSum</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>, target <span class="hljs-type">int</span>)</span></span> []<span class="hljs-type">int</span> &#123;<br>      <span class="hljs-keyword">var</span> m  = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]<span class="hljs-type">int</span>)<br>        <span class="hljs-keyword">for</span> i,v := <span class="hljs-keyword">range</span> nums&#123;<br>           index ,ok:= m[target-v];<br>           <span class="hljs-keyword">if</span> !ok &#123;<br>             m[v] = i;<br>           &#125;<span class="hljs-keyword">else</span>&#123;<br>             <span class="hljs-keyword">return</span> []<span class="hljs-type">int</span>&#123;index,i&#125;<br>           &#125;<br>        &#125;<br><br>    <span class="hljs-keyword">return</span> []<span class="hljs-type">int</span>&#123;&#125; <br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å­—æ¯å¼‚ä½è¯åˆ†ç»„"><a href="#å­—æ¯å¼‚ä½è¯åˆ†ç»„" class="headerlink" title="å­—æ¯å¼‚ä½è¯åˆ†ç»„"></a>å­—æ¯å¼‚ä½è¯åˆ†ç»„</h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://leetcode.cn/problems/group-anagrams/?envType=study-plan-v2&envId=top-100-liked">å­—æ¯å¼‚ä½è¯åˆ†ç»„</a></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">groupAnagrams</span><span class="hljs-params">(strs []<span class="hljs-type">string</span>)</span></span> [][]<span class="hljs-type">string</span> &#123;<br>    <span class="hljs-keyword">var</span> m  = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>][]<span class="hljs-type">string</span>)<br>    <span class="hljs-keyword">var</span> str [][]<span class="hljs-type">string</span><br>   <br>    <span class="hljs-keyword">for</span> _,v:=<span class="hljs-keyword">range</span> strs&#123;<br>        chars := []<span class="hljs-type">byte</span>(v)<br>        sort.Slice(chars,<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(i,j <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">bool</span>&#123;<br>             <span class="hljs-keyword">return</span> chars[i] &lt; chars[j]<br>        &#125;)<br>         sortedStr := <span class="hljs-type">string</span>(chars)<br>        m[sortedStr] = <span class="hljs-built_in">append</span>(m[sortedStr],v)<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> _,v := <span class="hljs-keyword">range</span> m&#123;<br>        str=<span class="hljs-built_in">append</span>(str,v)<br>    &#125; <br>         <br>    <span class="hljs-keyword">return</span> str<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æœ€é•¿è¿ç»­åºåˆ—"><a href="#æœ€é•¿è¿ç»­åºåˆ—" class="headerlink" title="æœ€é•¿è¿ç»­åºåˆ—"></a>æœ€é•¿è¿ç»­åºåˆ—</h3><p> é¢˜ç›®é“¾æ¥ <a href="https://leetcode.cn/problems/longest-consecutive-sequence/">æœ€é•¿è¿ç»­åºåˆ—</a></p><p>æˆ‘çš„è§£æ³• O(nlogn + n)   </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">longestConsecutive</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>     <span class="hljs-keyword">var</span> m = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]<span class="hljs-type">int</span>)<br>     <span class="hljs-built_in">len</span> := <span class="hljs-number">0</span><br>     sort.Ints(nums)<br>    <span class="hljs-keyword">for</span> _ ,v := <span class="hljs-keyword">range</span> nums&#123;<br>        _,ok := m[v<span class="hljs-number">-1</span>]<br>        <span class="hljs-keyword">if</span> !ok &#123;<br>            m[v]=<span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>&lt;m[v])&#123;<br>                <span class="hljs-built_in">len</span>= m[v]<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            m[v]=m[v<span class="hljs-number">-1</span>]+<span class="hljs-number">1</span><br>             <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>&lt;m[v])&#123;<br>                <span class="hljs-built_in">len</span>= m[v]<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span><br>&#125;<br></code></pre></td></tr></table></figure><p>O(n)æˆ–è€…è¯´O(2n)è§£æ³•  </p><p>è¿™è¾¹æ˜¯ç›´æ¥å¤åˆ¶é¢˜è§£çš„ï¼Œå…¶å®ä¸¤ç§æ–¹æ³•å¤§å·®ä¸å·®ï¼Œéƒ½æ˜¯æ ¹æ®m[i-1]æ¥åˆ¤æ–­é•¿åº¦ï¼Œè¿™ä¸ªå°±æ˜¯å°†æ’åºæ¢æˆäº†åˆå§‹åŒ–mapï¼Œç„¶åæ¯æ¬¡ä¼šé‡æ–°ç»Ÿè®¡æ€»æ•°</p><p>ä½†æ˜¯è¿™ç§è§£æ³•ç¡®å®ä¼šæ¯”æˆ‘çš„æ›´åŠ èŠ‚çœå†…å­˜ï¼Œä»¥åŠç¡®å®æ›´å¿«</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">longestConsecutive</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>    m := <span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]<span class="hljs-type">bool</span>&#123;&#125;<br>    <span class="hljs-keyword">for</span> _, v := <span class="hljs-keyword">range</span> nums &#123;<br>        m[v] = <span class="hljs-literal">true</span><br>    &#125;<br>    <span class="hljs-keyword">var</span> maxCount <span class="hljs-type">int</span><br>    <span class="hljs-keyword">var</span> tmpCount <span class="hljs-type">int</span><br>    <span class="hljs-keyword">for</span> num := <span class="hljs-keyword">range</span> m &#123;<br>        <span class="hljs-keyword">if</span> m[num<span class="hljs-number">-1</span>] &#123;<br>            <span class="hljs-keyword">continue</span><br>        &#125;<br>        tmpCount = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> m[num] &#123;<br>            num++<br>            tmpCount++<br>        &#125;<br>        <span class="hljs-keyword">if</span> tmpCount &gt; maxCount &#123;<br>            maxCount = tmpCount<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> maxCount<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="åŒæŒ‡é’ˆ"><a href="#åŒæŒ‡é’ˆ" class="headerlink" title="åŒæŒ‡é’ˆ"></a>åŒæŒ‡é’ˆ</h2><h3 id="ç§»åŠ¨é›¶"><a href="#ç§»åŠ¨é›¶" class="headerlink" title="ç§»åŠ¨é›¶"></a>ç§»åŠ¨é›¶</h3><p>é¢˜ç›®é“¾æ¥ <a href="https://leetcode.cn/problems/move-zeroes/">ç§»åŠ¨é›¶</a></p><p>ä¸ªäººè§£æ³•ï¼Œæ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦éƒ½é«˜äº†</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">moveZeroes</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>)</span></span>  &#123;<br>     length := <span class="hljs-built_in">len</span>(nums)<br>    <span class="hljs-keyword">for</span>  i:=<span class="hljs-number">0</span>;i&lt;length; &#123;<br>        <span class="hljs-keyword">if</span> nums[i]==<span class="hljs-number">0</span> &#123;<br>            <span class="hljs-keyword">if</span> i==length &#123;<br>                <span class="hljs-keyword">break</span><br>            &#125;<br>            <span class="hljs-keyword">for</span>  j := i;j&lt;length<span class="hljs-number">-1</span>;j++&#123;<br>                temp :=  nums[j]<br>                nums[j]=nums[j+<span class="hljs-number">1</span>]<br>                nums[j+<span class="hljs-number">1</span>]=temp<br>            &#125;<br>            length--<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            i++<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>æ›´å¿«æ›´ç®€å•çš„è§£æ³•</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">moveZeroes</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>)</span></span>  &#123;<br>     length := <span class="hljs-built_in">len</span>(nums)<br>     left:=<span class="hljs-number">0</span><br>     right :=<span class="hljs-number">0</span><br>    <br>    <span class="hljs-keyword">for</span> left&lt;length&amp;&amp;right&lt;length &#123;<br>        <span class="hljs-keyword">if</span> nums[right] != <span class="hljs-number">0</span> &#123;<br>            nums[left], nums[right] = nums[right], nums[left]   <span class="hljs-comment">//è¿™æ ·å†™ä¼šæ›´åŠ èŠ‚çœæ—¶é—´</span><br>            left++<br>        &#125;<br>        right++<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ä¸‰æ•°ä¹‹å’Œ"><a href="#ä¸‰æ•°ä¹‹å’Œ" class="headerlink" title="ä¸‰æ•°ä¹‹å’Œ"></a>ä¸‰æ•°ä¹‹å’Œ</h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://leetcode.cn/problems/3sum/">ä¸‰æ•°ä¹‹å’Œ</a></p><p>çªç„¶å‘ç°çµç¥è®²çš„ç¡®å®æŒºä¸é”™çš„ï¼Œçœ‹ä»–çš„è®²ä¸‰æ•°ä¹‹å’Œçš„è§†é¢‘æ²¡åˆ°ä¸€åŠå°±æ‡‚äº† ï¼Œå¾ˆé€å½»ï¼Œæœ‰å¼•å¯¼</p><p>å¼ºçƒˆæ¨è  <a href="https://www.bilibili.com/video/BV1bP411c7oJ/?vd_source=9b4c75905899e9c060de474426e69d22">çµç¥è§†é¢‘</a></p><p>çµç¥è§†é¢‘é‡Œæåˆ°ä¸€ä¸ªç‚¹ï¼š<strong>å¦‚æœæ•°ç»„æ˜¯æœ‰åºçš„å°±å¯ä»¥ä½¿ç”¨ç›¸å‘åŒæŒ‡é’ˆäº†</strong> ï¼Œ æ„Ÿè§‰è¿˜æ˜¯æŒºæœ‰ç”¨çš„</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">threeSum</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>)</span></span> [][]<span class="hljs-type">int</span> &#123;<br>sort.Ints(nums) <span class="hljs-comment">//æ’å¥½åºåå°±å¯ä»¥ä½¿ç”¨ç›¸å‘åŒæŒ‡é’ˆäº†</span><br>i := <span class="hljs-number">0</span><br><span class="hljs-keyword">var</span> ans [][]<span class="hljs-type">int</span><br><span class="hljs-keyword">for</span> ; i &lt; <span class="hljs-built_in">len</span>(nums)<span class="hljs-number">-2</span>; i++ &#123;<br><span class="hljs-keyword">if</span> i &gt; <span class="hljs-number">0</span> &amp;&amp; nums[i] == nums[i<span class="hljs-number">-1</span>] &#123;<br><span class="hljs-keyword">continue</span><br>&#125;<br>k := <span class="hljs-built_in">len</span>(nums) - <span class="hljs-number">1</span><br>j := i + <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> j &lt; k &#123;<br><span class="hljs-keyword">if</span> nums[i]+nums[j]+nums[k] == <span class="hljs-number">0</span> &#123;<br>ans = <span class="hljs-built_in">append</span>(ans, []<span class="hljs-type">int</span>&#123;nums[i], nums[j], nums[k]&#125;)<br>j++<br><span class="hljs-keyword">for</span> j&lt;k&amp;&amp; nums[j] == nums[j<span class="hljs-number">-1</span>] &#123;<br>j++<br>&#125;<br>k--<br><span class="hljs-keyword">for</span> k&gt;j&amp;&amp; nums[k] == nums[k+<span class="hljs-number">1</span>] &#123;<br>k--<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> nums[i]+nums[j]+nums[k] &lt; <span class="hljs-number">0</span> &#123;<br>j++<br><span class="hljs-keyword">for</span> j&lt;k&amp;&amp;nums[j] == nums[j<span class="hljs-number">-1</span>] &#123;<br>j++<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">if</span> nums[i]+nums[j]+nums[k] &gt; <span class="hljs-number">0</span> &#123;<br>k--<br><span class="hljs-keyword">for</span>  k&gt;j&amp;&amp;nums[k] == nums[k+<span class="hljs-number">1</span>] &#123;<br>k--<br>&#125;<br>&#125;<br>&#125;<br>&#125;<br><br>&#125;<br><span class="hljs-keyword">return</span> ans<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ¥é›¨æ°´"><a href="#æ¥é›¨æ°´" class="headerlink" title="æ¥é›¨æ°´"></a>æ¥é›¨æ°´</h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://leetcode.cn/problems/trapping-rain-water/">æ¥é›¨æ°´</a></p><p>é€šè¿‡ç§»åŠ¨å·¦å³åŒæŒ‡é’ˆæ¥æ‰¾ä¸¤è¾¹çš„maxé«˜åº¦ï¼Œå› ä¸ºå°äºmaxé«˜åº¦å°±è¯´æ˜è¯¥é«˜åº¦æ˜¯å¯èƒ½å¯ä»¥æ¥æ°´çš„</p><p>ç”±å› ä¸ºæœ¨æ¡¶æ•ˆåº”ï¼Œèƒ½ä¸èƒ½æ¥æ°´å…³é”®å–å†³äºæœ€çŸ­çš„é‚£æ¡è¾¹ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡å¯¹pre_maxå’Œsuf_maxè¿›è¡Œåï¼Œå¯¹å°çš„é‚£è¾¹è¿›è¡Œè¿ç®—ï¼Œmaxå‡å»heightå°±æ˜¯å¯ä»¥æ¥çš„é›¨æ°´</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">trap</span><span class="hljs-params">(height []<span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>    left :=<span class="hljs-number">0</span> <br>    right := <span class="hljs-built_in">len</span>(height)<span class="hljs-number">-1</span><br>    pre_max := <span class="hljs-number">0</span><br>    suf_max := <span class="hljs-number">0</span><br>    ans :=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> left&lt;=right&#123;<br>      pre_max = max(pre_max,height[left])<br>      suf_max = max(suf_max,height[right])<br>      <span class="hljs-keyword">if</span> pre_max &lt; suf_max&#123;<br>        ans +=pre_max - height[left]<br>        left++<br>      &#125;<span class="hljs-keyword">else</span>&#123;<br>        ans+=suf_max-height[right]<br>        right--<br>      &#125;<br>     <br>    &#125;<br><br>  <span class="hljs-keyword">return</span> ans<br>    <br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">max</span><span class="hljs-params">(a,b <span class="hljs-type">int</span>)</span></span><span class="hljs-type">int</span> &#123;<br>  <span class="hljs-keyword">if</span> a&lt;b&#123;<br>    <span class="hljs-keyword">return</span> b<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">return</span> a<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="çŸ©é˜µ"><a href="#çŸ©é˜µ" class="headerlink" title="çŸ©é˜µ"></a>çŸ©é˜µ</h2><h3 id="çŸ©é˜µç½®é›¶"><a href="#çŸ©é˜µç½®é›¶" class="headerlink" title="çŸ©é˜µç½®é›¶"></a>çŸ©é˜µç½®é›¶</h3><p>é¢˜ç›®è¿æ¥ ï¼š<a href="https://leetcode.cn/problems/set-matrix-zeroes/">çŸ©é˜µç½®é›¶</a></p><p>è¿™é¢˜è¦æƒ³å®ç°å¸¸æ•°çº§çš„ç©ºé—´å¤æ‚åº¦ï¼Œéœ€è¦å¤ç”¨matrixçš„ç©ºé—´ï¼Œç”¨ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—è¿›è¡Œæ ‡è®°è¯¥è¡Œæˆ–è¯¥åˆ—æ˜¯å¦æœ‰å€¼ä¸º0çš„æ•°</p><p>åœ¨æ ‡è®°å®Œæˆåï¼Œå†é€šè¿‡ä¸€è½®éå†å®Œæˆèµ‹å€¼0ï¼Œæœ€åå†å¯¹ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—è¿›è¡Œå¤„ç†ï¼Œé¿å…å‘ç”Ÿè¦†ç›–</p><p>è¿™è¾¹è¦æ³¨æ„çš„ä¸€ä¸ªç‚¹å°±æ˜¯åœ¨èµ‹å€¼çš„æ—¶å€™è®°å¾—æŠŠ<code>matrix[0][0]</code>ç»™è·³è¿‡äº†ï¼Œä¸ç„¶å¦‚æœè¿™ä¸ªåœ°æ–¹çš„å€¼ä¸º0ï¼Œå°†ä¼šå‘ç”Ÿè¦†ç›–ç°è±¡ï¼Œå› ä¸ºè¿™ä¸ªç‚¹ä¼šå…ˆå¤„ç†</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @Author: lrc</span><br><span class="hljs-comment"> * @Date: 2023/9/25-14:29</span><br><span class="hljs-comment"> * @Desc:</span><br><span class="hljs-comment"> **/</span><br><br><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">setZeroes</span><span class="hljs-params">(matrix [][]<span class="hljs-type">int</span>)</span></span> &#123;<br>flag_h := <span class="hljs-number">0</span><br>flag_l := <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">len</span>(matrix[<span class="hljs-number">0</span>]); i++ &#123;<br><span class="hljs-keyword">if</span> flag_h == <span class="hljs-number">0</span> &amp;&amp; matrix[<span class="hljs-number">0</span>][i] == <span class="hljs-number">0</span> &#123;<br>flag_h = <span class="hljs-number">1</span><br>&#125;<br>&#125;<br><br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">len</span>(matrix); i++ &#123;<br><span class="hljs-keyword">if</span> flag_l == <span class="hljs-number">0</span> &amp;&amp; matrix[i][<span class="hljs-number">0</span>] == <span class="hljs-number">0</span> &#123;<br>flag_l = <span class="hljs-number">1</span><br>&#125;<br>&#125;<br><br><span class="hljs-keyword">for</span> i, v := <span class="hljs-keyword">range</span> matrix &#123;<br><span class="hljs-keyword">for</span> j, va := <span class="hljs-keyword">range</span> v &#123;<br><span class="hljs-keyword">if</span> va == <span class="hljs-number">0</span> &#123;<br>matrix[i][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span><br>matrix[<span class="hljs-number">0</span>][j] = <span class="hljs-number">0</span><br>&#125;<br>&#125;<br>&#125;<br><span class="hljs-comment">// matrix[0][0]æœ‰å½±å“</span><br><span class="hljs-keyword">for</span> i, v := <span class="hljs-keyword">range</span> matrix &#123;<br><span class="hljs-keyword">for</span> j, _ := <span class="hljs-keyword">range</span> v &#123;<br><span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span> || j == <span class="hljs-number">0</span> &#123;<br><span class="hljs-keyword">continue</span><br>&#125;<br><span class="hljs-keyword">if</span> matrix[i][<span class="hljs-number">0</span>] == <span class="hljs-number">0</span> &#123;<br>matrix[i][j] = <span class="hljs-number">0</span><br>&#125;<br><span class="hljs-keyword">if</span> matrix[<span class="hljs-number">0</span>][j] == <span class="hljs-number">0</span> &#123;<br>matrix[i][j] = <span class="hljs-number">0</span><br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">len</span>(matrix[<span class="hljs-number">0</span>]); i++ &#123;<br><span class="hljs-keyword">if</span> flag_h == <span class="hljs-number">1</span> &#123;<br>matrix[<span class="hljs-number">0</span>][i] = <span class="hljs-number">0</span><br>&#125;<br>&#125;<br><br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">len</span>(matrix); i++ &#123;<br><span class="hljs-keyword">if</span> flag_l == <span class="hljs-number">1</span> &#123;<br>matrix[i][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span><br>&#125;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ—‹è½¬å›¾åƒ"><a href="#æ—‹è½¬å›¾åƒ" class="headerlink" title="æ—‹è½¬å›¾åƒ"></a>æ—‹è½¬å›¾åƒ</h3><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://leetcode.cn/problems/rotate-image/">æ—‹è½¬å›¾åƒ</a></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">rotate</span><span class="hljs-params">(matrix [][]<span class="hljs-type">int</span>)</span></span>  &#123;<br>    n:= <span class="hljs-built_in">len</span>(matrix[<span class="hljs-number">0</span>])<span class="hljs-number">-1</span><br>    <span class="hljs-keyword">for</span> i := <span class="hljs-keyword">range</span> matrix &#123;<br>    <span class="hljs-keyword">for</span> j := <span class="hljs-number">0</span>; j &lt; i; j++ &#123;<br>        matrix[i][j], matrix[j][i] = matrix[j][i], matrix[i][j]<br>    &#125;<br>&#125;<br><span class="hljs-keyword">for</span> i := <span class="hljs-keyword">range</span> matrix &#123;<br>    <span class="hljs-keyword">for</span> j := <span class="hljs-number">0</span>; j &lt; (n+<span class="hljs-number">1</span>)/<span class="hljs-number">2</span>; j++ &#123;<br>        matrix[i][j], matrix[i][n-j] = matrix[i][n-j], matrix[i][j]<br>    &#125;<br>&#125;<br><br>&#125;   <br></code></pre></td></tr></table></figure><p>çœ‹åˆ°äº†ä¸€ä¸ªé¢˜è§£æˆ‘è§‰å¾—å†™çš„æ€è·¯éå¸¸å¥½,è¿™è¾¹è®°å½•ä¸€ä¸‹</p><p>è§£é¢˜æ€è·¯<br>é¡ºæ—¶é’ˆæ—‹è½¬90ï¼šå…ˆæ²¿å¯¹è§’çº¿åè½¬çŸ©é˜µï¼Œå†æ²¿ç«–ä¸­è½´çº¿åè½¬çŸ©é˜µï¼›<br>é¡ºæ—¶é’ˆæ—‹è½¬180ï¼šå…ˆæ²¿æ¨ªä¸­è½´çº¿åè½¬çŸ©é˜µï¼Œå†æ²¿ç«–ä¸­è½´çº¿åè½¬çŸ©é˜µï¼›<br>é¡ºæ—¶é’ˆæ—‹è½¬270ï¼šå…ˆæ²¿å¯¹è§’çº¿åè½¬çŸ©é˜µï¼Œå†æ²¿æ¨ªä¸­è½´çº¿åè½¬çŸ©é˜µï¼›<br>ä»£ç <br>ç»™å‡ºå„ç§æ–¹å¼çš„åè½¬çš„å®ç°ï¼Œè§£å…·ä½“é¢˜ç›®æ—¶å°†ä»–ä»¬ç»„åˆå°±å¥½äº†</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs go">idx, halfLen := <span class="hljs-built_in">len</span>(matrix)<span class="hljs-number">-1</span>, <span class="hljs-built_in">len</span>(matrix) / <span class="hljs-number">2</span> <span class="hljs-comment">// è®°å½•æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡å’Œè¾¹é•¿çš„ä¸€åŠ</span><br><br><span class="hljs-comment">// æŒ‰å¯¹è§’çº¿åè½¬çŸ©é˜µ</span><br><span class="hljs-keyword">for</span> i := <span class="hljs-keyword">range</span> matrix &#123;<br>    <span class="hljs-keyword">for</span> j := <span class="hljs-number">0</span>; j &lt; i; j++ &#123;<br>        matrix[i][j], matrix[j][i] = matrix[j][i], matrix[i][j]<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æŒ‰ç«–ä¸­è½´çº¿åè½¬çŸ©é˜µ</span><br><span class="hljs-keyword">for</span> i := <span class="hljs-keyword">range</span> matrix &#123;<br>    <span class="hljs-keyword">for</span> j := <span class="hljs-number">0</span>; j &lt; halfLen; j++ &#123;<br>        matrix[i][j], matrix[i][idx-j] = matrix[i][idx-j], matrix[i][j]<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æŒ‰æ¨ªä¸­è½´çº¿åè½¬çŸ©é˜µ</span><br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; helfLen; i++ &#123;<br>    <span class="hljs-keyword">for</span> j := <span class="hljs-keyword">range</span> matrix[i] &#123;<br>        matrix[idx-i][j], matrix[i][j] = matrix[i][j], matrix[idx-i][j]<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h2><h3 id="é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯"><a href="#é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯" class="headerlink" title="é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯"></a>é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯</h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://leetcode.cn/problems/product-of-array-except-self/">é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯</a></p><p>æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦éƒ½å¤ªå·®äº†ï¼Œæ’ä¸ªçœ¼å¾…ä¼˜åŒ–</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">productExceptSelf</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>)</span></span>  []<span class="hljs-type">int</span> &#123;<br>    L := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>,<span class="hljs-built_in">len</span>(nums))<br>     R := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>,<span class="hljs-built_in">len</span>(nums))<br>     ans := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>,<span class="hljs-built_in">len</span>(nums))<br><br>    L[<span class="hljs-number">0</span>] = nums[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">for</span> i,_ := <span class="hljs-keyword">range</span> nums &#123;<br>        <span class="hljs-keyword">if</span> i==<span class="hljs-number">0</span> &#123;<br>            <span class="hljs-keyword">continue</span><br>        &#125;<br>        L[i] = L[i<span class="hljs-number">-1</span>]*nums[i]<br>    &#125;<br>    R[<span class="hljs-built_in">len</span>(nums)<span class="hljs-number">-1</span>] = nums[<span class="hljs-built_in">len</span>(nums)<span class="hljs-number">-1</span>]<br>    <span class="hljs-keyword">for</span> i:=<span class="hljs-built_in">len</span>(nums)<span class="hljs-number">-2</span>;i&gt;=<span class="hljs-number">0</span>;i--&#123;<br>        R[i] = R[i+<span class="hljs-number">1</span>]*nums[i]<br>        <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>  &#123;<br>            ans[i] = R[i+<span class="hljs-number">1</span>]<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            ans[i]= L[i<span class="hljs-number">-1</span>]*R[i+<span class="hljs-number">1</span>]<br>        &#125;<br>    &#125;<br>    ans[<span class="hljs-built_in">len</span>(nums)<span class="hljs-number">-1</span>]=L[<span class="hljs-built_in">len</span>(nums)<span class="hljs-number">-2</span>]<br>    <span class="hljs-keyword">return</span> ans<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¼˜åŒ–åçš„ä»£ç </p><p>å¯ä»¥ä¸å¼€è¾Ÿé™¤äº†è¿”å›çš„æ•°ç»„å¤–çš„å…¶ä»–æ•°ç»„ï¼Œå¯ä»¥åœ¨ç®—å³ä¾§åç¼€ç§¯çš„æ—¶å€™é¡ºä¾¿æŠŠç­”æ¡ˆç®—å‡ºæ¥</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">productExceptSelf</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>)</span></span>  []<span class="hljs-type">int</span> &#123;<br>    L := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>,<span class="hljs-built_in">len</span>(nums))<br><br><br>    L[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i:=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-built_in">len</span>(nums)<span class="hljs-number">-1</span>;i++ &#123;<br>        L[i] = L[i<span class="hljs-number">-1</span>]*nums[i<span class="hljs-number">-1</span>]<br>    &#125;<br>    r := <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i:=<span class="hljs-built_in">len</span>(nums)<span class="hljs-number">-1</span>;i&gt;=<span class="hljs-number">0</span>;i--&#123;<br>        L[i] = L[i]*r<br>        r*=nums[i]<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> L<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°"><a href="#ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°" class="headerlink" title="ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°"></a>ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°</h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://leetcode.cn/problems/first-missing-positive/">ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°</a></p><p>ç›´æ¥ç”¨æ’åºç„¶åæ¥åšç©ºé—´å¤æ‚åº¦ä¼šæ›´å¥½ä¸€ç‚¹ï¼Œä½†æ—¶é—´å¤æ‚åº¦ä¸çŸ¥é“ï¼Œåæ­£ä¸æ˜¯O(n)</p><p>è¦ä¸ç”¨æ’åºçš„è¯å¾—ç”¨ç½®æ¢çš„æ–¹æ³•ï¼Œå¦‚æœå¯¹åº”ä¸‹æ ‡çš„å­˜çš„å€¼ä¸æ˜¯å¯¹åº”numsï¼Œé‚£ä¹ˆå°±å°†å­˜çš„å€¼æ¢åˆ°å¯¹åº”ä¸‹æ ‡ä¸‹</p><p>åŒæ—¶ç”¨lenï¼ˆnï¼‰è¿›è¡Œçº¦æŸ ï¼ˆå¦‚æœå¯¹åº”çš„æ•°å€¼è¶…å‡ºäº†lenï¼ˆnï¼‰ï¼Œå¯¹åº”ä¸‹æ ‡è¶…å‡ºäº†numsçš„èŒƒå›´ï¼Œç›´æ¥ä¸äº¤æ¢å³å¯ï¼‰</p><p>åªæœ‰nums[i]ä¸æ»¡è¶³æ¡ä»¶çš„æ—¶å€™æ‰è¿›è¡Œ++ï¼Œä¸ç„¶æ— æ³•æ­£ç¡®å½’ä½å„æ•°</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">firstMissingPositive</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>    n:= <span class="hljs-built_in">len</span>(nums)<br>    i:= <span class="hljs-number">0</span> <br>    <span class="hljs-keyword">for</span> i&lt;<span class="hljs-built_in">len</span>(nums)  &#123;<br>        <span class="hljs-keyword">if</span> nums[i] != i+<span class="hljs-number">1</span>&amp;&amp;nums[i]&gt;<span class="hljs-number">0</span>&amp;&amp;nums[i]&lt;n &#123;<br>            <span class="hljs-keyword">if</span> nums[nums[i]<span class="hljs-number">-1</span>] != nums[i] &#123;<br>             nums[i], nums[nums[i]<span class="hljs-number">-1</span>] = nums[nums[i]<span class="hljs-number">-1</span>],nums[i]<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>i++<br>&#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            i++<br>          &#125;<br>    &#125; <br><br>    <span class="hljs-keyword">for</span> j,v :=<span class="hljs-keyword">range</span> nums &#123;<br>        <span class="hljs-keyword">if</span>  j+<span class="hljs-number">1</span> != v &#123;<br>            <span class="hljs-keyword">return</span> j+<span class="hljs-number">1</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> n+<span class="hljs-number">1</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="é“¾è¡¨"><a href="#é“¾è¡¨" class="headerlink" title="é“¾è¡¨"></a>é“¾è¡¨</h2><h3 id="åè½¬é“¾è¡¨-II"><a href="#åè½¬é“¾è¡¨-II" class="headerlink" title="åè½¬é“¾è¡¨ II"></a>åè½¬é“¾è¡¨ II</h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://leetcode.cn/problems/reverse-linked-list-ii/">åè½¬é“¾è¡¨ II</a></p><p>æœ€åˆçš„ä»£ç ï¼Œæ€è·¯åŸºæœ¬æ­£ç¡®ï¼Œä½†æ²¡è€ƒè™‘åˆ°left ç­‰äº1çš„æƒ…å†µï¼Œæ­¤æ—¶æ²¡æœ‰èŠ‚ç‚¹æŒ‡å‘left &#x3D; 1 çš„èŠ‚ç‚¹ï¼Œå¦‚æœé€šè¿‡å˜é‡æ¥è®°å½•çš„è¯ï¼Œæœ€åå°†è®°å½•å˜é‡çš„nextæŒ‡å‘æ–°èŠ‚ç‚¹çš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œå› ä¸ºä»–æ˜¯ç©ºçš„</p><p>è§£å†³æ–¹æ³•å°±æ˜¯åœ¨æœ€å‰é¢åŠ ä¸€ä¸ªå“¨å…µèŠ‚ç‚¹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Definition for singly-linked list.</span><br><span class="hljs-comment"> * type ListNode struct &#123;</span><br><span class="hljs-comment"> *     Val int</span><br><span class="hljs-comment"> *     Next *ListNode</span><br><span class="hljs-comment"> * &#125;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reverseBetween</span><span class="hljs-params">(head *ListNode, left <span class="hljs-type">int</span>, right <span class="hljs-type">int</span>)</span></span> *ListNode &#123;<br>  <span class="hljs-keyword">if</span> head == <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><br>&#125;<br><span class="hljs-keyword">if</span> head.Next == <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> head<br>&#125;<br>  <span class="hljs-keyword">var</span> dummy *ListNode = head <br><span class="hljs-keyword">var</span> pre, cur, l, r *ListNode = dummy, head, <span class="hljs-literal">nil</span>, <span class="hljs-literal">nil</span><br>count := <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> count != left &#123;<br>pre = cur<br>cur = cur.Next<br>count++<br>&#125;<br>l = pre<br>r = cur<br><span class="hljs-keyword">for</span> count != right+<span class="hljs-number">1</span> &#123;<br>nxt := cur.Next<br>cur.Next = pre<br>pre = cur<br>cur = nxt<br>count++<br><br>&#125;<br>l.Next = pre<br>r.Next = cur<br><span class="hljs-keyword">return</span> head<br>&#125;<br></code></pre></td></tr></table></figure><p>è§£å†³é—®é¢˜åçš„ä»£ç </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reverseBetween</span><span class="hljs-params">(head *ListNode, left <span class="hljs-type">int</span>, right <span class="hljs-type">int</span>)</span></span> *ListNode &#123;<br><span class="hljs-keyword">if</span> head == <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><br>&#125;<br><span class="hljs-keyword">if</span> head.Next == <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> head<br>&#125;<br>dummy := &amp;ListNode&#123;Next: head&#125;<br>p0 := dummy<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; left<span class="hljs-number">-1</span>; i++ &#123;<br>p0 = p0.Next<br>&#125;<br><span class="hljs-keyword">var</span> pre, cur *ListNode = <span class="hljs-literal">nil</span>, head<br>count := <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> count != left &#123;<br>pre = cur<br>cur = cur.Next<br>count++<br>&#125;<br><br><span class="hljs-keyword">for</span> count != right+<span class="hljs-number">1</span> &#123;<br>nxt := cur.Next<br>cur.Next = pre<br>pre = cur<br>cur = nxt<br>count++<br><br>&#125;<br><br>p0.Next.Next = cur<br>p0.Next = pre<br><span class="hljs-keyword">return</span> dummy.Next<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬-N-ä¸ªç»“ç‚¹"><a href="#åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬-N-ä¸ªç»“ç‚¹" class="headerlink" title="åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N ä¸ªç»“ç‚¹"></a>åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N <strong>ä¸ªç»“ç‚¹</strong></h3><p>é¢˜ç›®é“¾æ¥ï¼š <a href="https://leetcode.cn/problems/remove-nth-node-from-end-of-list/">åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N ä¸ªç»“ç‚¹</a></p><p>æœ€ä¼˜åšæ³•ä½¿ç”¨åŒæŒ‡é’ˆï¼Œå·¦æŒ‡é’ˆè·ç¦»å³æŒ‡é’ˆnä¸ªè·ç¦»</p><p>æ³¨æ„ä½¿ç”¨å“¨å…µèŠ‚ç‚¹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">removeNthFromEnd</span><span class="hljs-params">(head *ListNode, n <span class="hljs-type">int</span>)</span></span> *ListNode &#123;<br>    <span class="hljs-keyword">var</span> dummy *ListNode = &amp;ListNode&#123;Val:<span class="hljs-number">0</span>,Next:<span class="hljs-literal">nil</span>&#125;<br>    dummy.Next = head<br>    <span class="hljs-keyword">var</span> left,right *ListNode =dummy, head<br>    <span class="hljs-keyword">for</span> i:= <span class="hljs-number">0</span>;i&lt;n;i++ &#123;<br>        right= right.Next<br>    &#125;<br>    <span class="hljs-keyword">for</span> right != <span class="hljs-literal">nil</span>&#123;<br>        right = right.Next<br>        left = left.Next<br>    &#125;<br>    left.Next = left.Next.Next<br><br>    <span class="hljs-keyword">return</span> dummy.Next<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="K-ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨"><a href="#K-ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨" class="headerlink" title="K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨"></a>K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨</h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://leetcode.cn/problems/reverse-nodes-in-k-group/">K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨</a></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reverseKGroup</span><span class="hljs-params">(head *ListNode, k <span class="hljs-type">int</span>)</span></span> *ListNode &#123;<br>tmp1 := head<br>tmp2 := head<br><span class="hljs-keyword">var</span> l *ListNode = head<br>dummy := &amp;ListNode&#123;Val: <span class="hljs-number">0</span>, Next: head&#125;<br>count := <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> l != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">var</span> pre, cur, tmp3 *ListNode = <span class="hljs-literal">nil</span>, tmp1, tmp1<br><span class="hljs-keyword">for</span> count != k &amp;&amp; l != <span class="hljs-literal">nil</span> &#123;<br>count++<br>l = l.Next<br>&#125;<br><span class="hljs-keyword">if</span> count != k &#123;<br><span class="hljs-keyword">if</span> tmp1 == head &#123;<br><span class="hljs-keyword">return</span> dummy.Next<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>tmp2.Next = tmp1<br><span class="hljs-keyword">return</span> dummy.Next<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">for</span> cur != l &amp;&amp; count != <span class="hljs-number">1</span> &#123;<br>nxt := cur.Next<br>tmp1 = nxt <span class="hljs-comment">//</span><br>cur.Next = pre<br>pre = cur<br>cur = nxt<br>&#125;<br><span class="hljs-keyword">if</span> dummy.Next == head &amp;&amp; count != <span class="hljs-number">1</span> &#123;<br>dummy.Next = pre<br>tmp2 = head<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">if</span> count != <span class="hljs-number">1</span> &#123;<br>tmp2.Next = pre<br>tmp2 = tmp3<br>&#125;<br>&#125;<br><br>count = <span class="hljs-number">0</span><br>&#125;<br><span class="hljs-keyword">return</span> dummy.Next<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="éšæœºé“¾è¡¨çš„å¤åˆ¶"><a href="#éšæœºé“¾è¡¨çš„å¤åˆ¶" class="headerlink" title="éšæœºé“¾è¡¨çš„å¤åˆ¶"></a>éšæœºé“¾è¡¨çš„å¤åˆ¶</h3><p>é¢˜ç›®é“¾æ¥ ï¼š <a href="https://leetcode.cn/problems/copy-list-with-random-pointer/">éšæœºé“¾è¡¨çš„å¤åˆ¶</a></p><p>è¿™é¢˜å¯ä»¥ç”¨å“ˆå¸Œè¡¨æˆ–è€…è¿­ä»£çš„æ–¹å¼æ¥åš</p><p>ä½†æ˜¯å“ˆå¸Œè¡¨åŠ ä¸¤æ¬¡éå†æ˜¯æœ€ç®€å•ä¸”æ—¶é—´å¤æ‚åº¦ä½çš„ï¼Œç©ºé—´å¤æ‚åº¦ä¸­ç­‰</p><p>ä½¿ç”¨è¿­ä»£ç©ºé—´å¤æ‚åº¦æœ€ä½ï¼Œä½†æ˜¯æ—¶é—´å¤æ‚åº¦é«˜ï¼Œå¾—éå†ä¸‰æ¬¡</p><p>å“ˆå¸Œè¡¨åŠ å›æº¯ï¼Œæ—¶é—´å¤æ‚åº¦é«˜ï¼Œç©ºé—´å¤æ‚åº¦ä¹Ÿé«˜ï¼Œä»£ç ä¹Ÿä¸æ˜“ç†è§£ï¼Œä¸‹ä¸‹ç­–</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"> <br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">copyRandomList</span><span class="hljs-params">(head *Node)</span></span> *Node &#123;<br>    hash := <span class="hljs-keyword">map</span>[*Node]*Node&#123;&#125;<br>    <span class="hljs-keyword">for</span> it := head; it != <span class="hljs-literal">nil</span>; it = it.Next &#123;<br>        hash[it] = &amp;Node&#123;it.Val, <span class="hljs-literal">nil</span>, <span class="hljs-literal">nil</span>&#125; <br>    &#125;<br>    <span class="hljs-keyword">for</span> it := head; it != <span class="hljs-literal">nil</span>; it = it.Next &#123;<br>        itNew := hash[it]<br>        itNew.Next, itNew.Random = hash[it.Next], hash[it.Random] <br>    &#125;<br>    <span class="hljs-keyword">return</span> hash[head]<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äºŒå‰æ ‘"><a href="#äºŒå‰æ ‘" class="headerlink" title="äºŒå‰æ ‘"></a>äºŒå‰æ ‘</h2><h3 id="å¯¹ç§°äºŒå‰æ ‘"><a href="#å¯¹ç§°äºŒå‰æ ‘" class="headerlink" title="å¯¹ç§°äºŒå‰æ ‘"></a>å¯¹ç§°äºŒå‰æ ‘</h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://leetcode.cn/problems/symmetric-tree/">å¯¹ç§°äºŒå‰æ ‘</a></p><p>åŒç™¾åšæ³• ï¼š é€’å½’</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">dfs</span><span class="hljs-params">(left *TreeNode,right *TreeNode)</span></span><span class="hljs-type">bool</span> &#123;<br>    <span class="hljs-keyword">if</span> (left ==<span class="hljs-literal">nil</span>&amp;&amp;right!=<span class="hljs-literal">nil</span>)||(left != <span class="hljs-literal">nil</span> &amp;&amp;right==<span class="hljs-literal">nil</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    &#125;<br><br>    <span class="hljs-keyword">if</span> left == <span class="hljs-literal">nil</span>&amp;&amp;right==<span class="hljs-literal">nil</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <br>    &#125;<br><br>    <span class="hljs-keyword">if</span> left.Val == right.Val&#123;<br>        ok:=dfs(left.Left,right.Right)<br>        ok2:=dfs(left.Right,right.Left)<br>        <span class="hljs-keyword">return</span> ok&amp;&amp;ok2<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    &#125;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">isSymmetric</span><span class="hljs-params">(root *TreeNode)</span></span> <span class="hljs-type">bool</span> &#123;<br>    <span class="hljs-keyword">if</span> root==<span class="hljs-literal">nil</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <br>    &#125;<br>    <span class="hljs-keyword">return</span> dfs(root.Left,root.Right)<br><br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é¢˜å¾ˆç®€å•ï¼Œä½†æ˜¯å› ä¸ºè¦ç”¨è¿­ä»£æ¥åšæ‰€ä»¥æŸ¥ä¸ªçœ¼ï¼Œå›æ¥æŠŠè¿­ä»£åšæ³•è¡¥ä¸Š</p><h3 id="äºŒå‰æ ‘çš„å±‚åºéå†"><a href="#äºŒå‰æ ‘çš„å±‚åºéå†" class="headerlink" title="äºŒå‰æ ‘çš„å±‚åºéå†"></a>äºŒå‰æ ‘çš„å±‚åºéå†</h3><p>é¢˜ç›®é“¾æ¥ ï¼š <a href="https://leetcode.cn/problems/binary-tree-level-order-traversal/">äºŒå‰æ ‘çš„å±‚åºéå†</a></p><p>è§£æ³•ä¸€ ï¼š ä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">levelOrder</span><span class="hljs-params">(root *TreeNode)</span></span> (ans [][]<span class="hljs-type">int</span>) &#123;<br><span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> ans<br>&#125;<br>q := <span class="hljs-built_in">make</span>([]*TreeNode, <span class="hljs-number">1</span>)<br>q2 := <span class="hljs-built_in">make</span>([]*TreeNode, <span class="hljs-number">0</span>)<br>q[<span class="hljs-number">0</span>] = root<br>top := <span class="hljs-number">0</span><br>top2 := <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> top != <span class="hljs-built_in">len</span>(q) || top2 != <span class="hljs-built_in">len</span>(q2) &#123;<br>m2 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">0</span>)<br><span class="hljs-keyword">for</span> top != <span class="hljs-built_in">len</span>(q) &#123;<br>m2 = <span class="hljs-built_in">append</span>(m2, q[top].Val)<br><span class="hljs-keyword">if</span> q[top].Left != <span class="hljs-literal">nil</span> &#123;<br>q2 = <span class="hljs-built_in">append</span>(q2, q[top].Left)<br>&#125;<br><span class="hljs-keyword">if</span> q[top].Right != <span class="hljs-literal">nil</span> &#123;<br>q2 = <span class="hljs-built_in">append</span>(q2, q[top].Right)<br>&#125;<br><br>top++<br><span class="hljs-keyword">if</span> top == <span class="hljs-built_in">len</span>(q) &#123;<br>ans = <span class="hljs-built_in">append</span>(ans, m2)<br>q = q[<span class="hljs-number">0</span>:<span class="hljs-number">0</span>]<br><span class="hljs-keyword">break</span><br>&#125;<br>&#125;<br>top = <span class="hljs-number">0</span><br>m := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">0</span>)<br><span class="hljs-keyword">for</span> top2 != <span class="hljs-built_in">len</span>(q2) &#123;<br><br>m = <span class="hljs-built_in">append</span>(m, q2[top2].Val)<br><span class="hljs-keyword">if</span> q2[top2].Left != <span class="hljs-literal">nil</span> &#123;<br>q = <span class="hljs-built_in">append</span>(q, q2[top2].Left)<br>&#125;<br><span class="hljs-keyword">if</span> q2[top2].Right != <span class="hljs-literal">nil</span> &#123;<br>q = <span class="hljs-built_in">append</span>(q, q2[top2].Right)<br>&#125;<br><br>top2++<br><span class="hljs-keyword">if</span> top2 == <span class="hljs-built_in">len</span>(q2) &#123;<br>ans = <span class="hljs-built_in">append</span>(ans, m)<br>q2 = q2[<span class="hljs-number">0</span>:<span class="hljs-number">0</span>]<br><span class="hljs-keyword">break</span><br>&#125;<br>&#125;<br>top2 = <span class="hljs-number">0</span><br>&#125;<br><span class="hljs-keyword">return</span><br>&#125;<br></code></pre></td></tr></table></figure><p>è§£æ³•äºŒä¼˜åŒ– ï¼š ä½¿ç”¨ä¸€ä¸ªé˜Ÿåˆ—</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">levelOrder</span><span class="hljs-params">(root *TreeNode)</span></span> (ans [][]<span class="hljs-type">int</span>) &#123;<br><span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> ans<br>&#125;<br>q := <span class="hljs-built_in">make</span>([]*TreeNode, <span class="hljs-number">1</span>)<br>q[<span class="hljs-number">0</span>] = root<br>top := <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> <span class="hljs-built_in">len</span>(q) != <span class="hljs-number">0</span> &#123;<br>n := <span class="hljs-built_in">len</span>(q)<br>m2 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">0</span>)<br><span class="hljs-keyword">for</span> top != n &#123;<br>m2 = <span class="hljs-built_in">append</span>(m2, q[top].Val)<br><span class="hljs-keyword">if</span> q[top].Left != <span class="hljs-literal">nil</span> &#123;<br>q = <span class="hljs-built_in">append</span>(q, q[top].Left)<br>&#125;<br><span class="hljs-keyword">if</span> q[top].Right != <span class="hljs-literal">nil</span> &#123;<br>q = <span class="hljs-built_in">append</span>(q, q[top].Right)<br>&#125;<br>top++<br><br><span class="hljs-keyword">if</span> top == n &#123;<br>ans = <span class="hljs-built_in">append</span>(ans, m2)<br>q = q[n:]<br><span class="hljs-keyword">break</span><br>&#125;<br>&#125;<br>top = <span class="hljs-number">0</span><br>&#125;<br><span class="hljs-keyword">return</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸¤ç§æ–¹æ³•å„æœ‰ä¼˜åŠ¿ï¼Œç¬¬ä¸€ç§æ–¹æ³•ä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œå¯¹äºå†…å­˜çš„æ¶ˆè€—æ¥è¯´æ˜¯å°äºç¬¬äºŒç§æ–¹æ³•çš„ï¼Œç¬¬äºŒç§æ–¹æ³•å°±æ˜¯é€Ÿåº¦ä¼šæ¯”ç¬¬ä¸€ç§æ–¹æ³•çš„å¿«</p><h3 id="äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ "><a href="#äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ " class="headerlink" title="äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ "></a>äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ </h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://leetcode.cn/problems/kth-smallest-element-in-a-bst/">äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ </a></p><p>ä¹‹å‰è‡ªå·±æƒ³çš„å¤ªå¤æ‚äº†ï¼Œå‘ç°ä¸€ç¯‡é¢˜è§£çš„ä»£ç éå¸¸ç®€æ´é«˜æ•ˆï¼Œå°±ç›´æ¥ç”¨ä»–çš„ä»£ç äº†</p><p>ï¼ˆæ°´å¹³è¿˜ä¸å¤Ÿï¼Œé‰´å®šä¸ºåˆ·é¢˜åˆ·å°‘äº†0.0ï¼‰</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">kthSmallest</span><span class="hljs-params">(root *TreeNode, k <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>    arr := []<span class="hljs-type">int</span>&#123;&#125;<br>    <span class="hljs-keyword">var</span> f <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(n *TreeNode)</span></span><br>    f = <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(n *TreeNode)</span></span>  &#123;<br>    <span class="hljs-keyword">if</span> n == <span class="hljs-literal">nil</span>&#123;<br>        <span class="hljs-keyword">return</span> <br>    &#125;<br>    f(n.Left)<br>    arr = <span class="hljs-built_in">append</span>(arr,n.Val)<br>    f(n.Right)<br>    &#125;<br>    f(root)<br>    <span class="hljs-keyword">return</span> arr[k<span class="hljs-number">-1</span>]<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨"><a href="#äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨" class="headerlink" title="äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨"></a>äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨</h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://leetcode.cn/problems/flatten-binary-tree-to-linked-list/">äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨</a></p><p>æ—¶é—´å¤æ‚åº¦å¤ªå·®äº†ï¼Œå¾…ä¼˜åŒ–</p><p>è¿˜æ˜¯æˆ‘å¤ªåƒåœ¾äº†ï¼Œå®˜æ–¹é¢˜è§£çš„æœ€åä¸€ç§åšæ³•ç›´æ¥å¯ä»¥è¾¾åˆ°åŒç™¾QAQ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Definition for a binary tree node.</span><br><span class="hljs-comment"> * type TreeNode struct &#123;</span><br><span class="hljs-comment"> *     Val int</span><br><span class="hljs-comment"> *     Left *TreeNode</span><br><span class="hljs-comment"> *     Right *TreeNode</span><br><span class="hljs-comment"> * &#125;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">dfs</span><span class="hljs-params">(root *TreeNode)</span></span> *TreeNode &#123;<br><span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><br>&#125;<br>l := dfs(root.Left)<br>    <span class="hljs-keyword">var</span> r *TreeNode<br><span class="hljs-keyword">if</span> l == <span class="hljs-literal">nil</span> &#123;<br>r = dfs(root.Right)<br><span class="hljs-keyword">if</span> r == <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> root<br>&#125;<br>&#125;<br><span class="hljs-keyword">if</span> root.Left != <span class="hljs-literal">nil</span> &#123;<br>tmp := root.Right<br>root.Right = root.Left<br>l.Right = tmp<br>root.Left = <span class="hljs-literal">nil</span><br><span class="hljs-keyword">if</span> l.Right == <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> l<br>&#125;<br><span class="hljs-keyword">return</span> dfs(l.Right)<br>&#125;<br><br><span class="hljs-keyword">if</span> root.Right != <span class="hljs-literal">nil</span> &#123;<br>        <span class="hljs-keyword">if</span> r != <span class="hljs-literal">nil</span> &#123;<br>            <span class="hljs-keyword">return</span> r<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> dfs(root.Right)<br>        &#125;<br><br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">flatten</span><span class="hljs-params">(root *TreeNode)</span></span>  &#123;<br>    <span class="hljs-keyword">if</span> root ==<span class="hljs-literal">nil</span> &#123;<br>        <span class="hljs-keyword">return</span><br>    &#125;<br>    dfs(root)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è·¯å¾„æ€»å’Œ-III"><a href="#è·¯å¾„æ€»å’Œ-III" class="headerlink" title="è·¯å¾„æ€»å’Œ III"></a>è·¯å¾„æ€»å’Œ III</h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://leetcode.cn/problems/path-sum-iii/">è·¯å¾„æ€»å’Œ III</a></p><p>è¿™é¢˜å‰‘æŒ‡offerä¸Šæœ‰ï¼Œä½†æ˜¯å½“æ—¶æ˜¯ç”¨çš„æš´åŠ›åšæ³•åšçš„ï¼Œä»Šå¤©åœ¨leetcodeä¸ŠäºŒåˆ·ï¼Œæ¢äº†ç§æ›´å¥½çš„æ€è·¯ï¼Œåˆ©ç”¨å‰ç¼€å’Œæ¥å®Œæˆè¿™ä¸€é¢˜ï¼Œå¯ä»¥å¾—åˆ°æœ€ä¼˜çš„æ—¶é—´å¤æ‚åº¦</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">pathSum</span><span class="hljs-params">(root *TreeNode, targetSum <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>    m := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]<span class="hljs-type">int</span>)<br>    m[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span> <br>    ans  := <span class="hljs-number">0</span><br>    <span class="hljs-keyword">var</span> dfs <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(root *TreeNode,num <span class="hljs-type">int</span>)</span></span><br>   dfs =   <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(root *TreeNode,num <span class="hljs-type">int</span>)</span></span> &#123;<br>    <span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;<br>        <span class="hljs-keyword">return</span> <br>    &#125;<br>    ans += m[num + root.Val - targetSum]<br>    m[num + root.Val] +=<span class="hljs-number">1</span> <br>    dfs(root.Left,num + root.Val)<br>    dfs(root.Right,num + root.Val)<br>    m[num+root.Val]--<br>    <span class="hljs-keyword">return</span> <br>&#125;<br>    dfs(root,<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">return</span> ans<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å›æº¯"><a href="#å›æº¯" class="headerlink" title="å›æº¯"></a>å›æº¯</h2><h3 id="å­é›†"><a href="#å­é›†" class="headerlink" title="å­é›†"></a>å­é›†</h3><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://leetcode.cn/problems/subsets/">å­é›†</a></p><p>çµç¥è®²è§£è§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1mG4y1A7Gu/?vd_source=9b4c75905899e9c060de474426e69d22">å›æº¯ç®—æ³•å¥—è·¯â‘ å­é›†å‹å›æº¯ã€åŸºç¡€ç®—æ³•ç²¾è®² 14ã€‘_å“”å“©å“”å“©_bilibili</a></p><p>å­é›†å‹å›æº¯ï¼Œå¯¹æ¯ä¸€ä¸ªå…ƒç´ éƒ½è¿›è¡Œåˆ¤æ–­é€‰æˆ–è€…ä¸é€‰ï¼Œé€’å½’åˆ°æœ€å</p><p>å‘ç‚¹ï¼šè®°å¾—copyï¼Œä¸è¦ç›´æ¥æŠŠtmp appendè¿›å»äº†&gt;_&lt;</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">subsets</span><span class="hljs-params">(nums []<span class="hljs-type">int</span>)</span></span> (ans [][]<span class="hljs-type">int</span>) &#123;<br><span class="hljs-keyword">var</span> dfs <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(<span class="hljs-type">int</span>)</span></span><br>tmp := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">0</span>)<br>dfs = <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(count <span class="hljs-type">int</span>)</span></span> &#123;<br><span class="hljs-keyword">if</span> count == <span class="hljs-built_in">len</span>(nums) &#123;<br>a := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">0</span>)<br>a = <span class="hljs-built_in">append</span>(a, tmp...)<br>ans = <span class="hljs-built_in">append</span>(ans, a)<br><span class="hljs-keyword">return</span><br>&#125;<br>dfs(count + <span class="hljs-number">1</span>)<br>tmp = <span class="hljs-built_in">append</span>(tmp, nums[count])<br>dfs(count + <span class="hljs-number">1</span>)<br>tmp = tmp[:<span class="hljs-built_in">len</span>(tmp)<span class="hljs-number">-1</span>]<br><span class="hljs-keyword">return</span><br>&#125;<br>dfs(<span class="hljs-number">0</span>)<br><span class="hljs-keyword">return</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ç»„åˆæ€»å’Œ"><a href="#ç»„åˆæ€»å’Œ" class="headerlink" title="ç»„åˆæ€»å’Œ"></a>ç»„åˆæ€»å’Œ</h3><p>é¢˜ç›®é“¾æ¥ï¼š <a href="https://leetcode.cn/problems/combination-sum/">ç»„åˆæ€»å’Œ</a></p><p>é¦–å…ˆæ‹¿åˆ°é¢˜ç›®å¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€é“ç»„åˆå‹å›æº¯</p><p>ä½†æ˜¯é¢˜ç›®è¦æ±‚æ¯ä¸ªæ•°éƒ½å¯ä»¥æ— é™æ¬¡ä½¿ç”¨ - - - &gt; é‚£ä¹ˆæˆ‘ä»¬å¯¹æ¯ä¸ªæ•°å°±ä¸æ˜¯é‡‡å–é€‰æˆ–è€…ä¸é€‰è¿™ç§ç­–ç•¥äº†</p><p>ä¸æ˜¯è¯´æ¯ä¸ªæ•°å¯æ— é™é€‰å—ï¼Œé‚£ä¹ˆæˆ‘æ¯æ¬¡é€’å½’éƒ½å¯¹æ‰€æœ‰çš„æ•°è¿›è¡Œåˆ¤æ–­ï¼Œæ— è®ºä¹‹å‰é€‰æ²¡é€‰è¿‡</p><p>è¿™æ ·å¯ä»¥å¾—å‡ºæ­£ç¡®ç»“æœï¼Œ<strong>ä½†æ˜¯æœ‰é‡å¤</strong></p><p>è¿™è¾¹ç¿»äº†ä¸‹leetcodeé¢˜è§£ï¼Œå‘ç°æœ‰ä¸ªå¤§ä½¬çš„æ€è·¯éå¸¸å·§å¦™ç®€æ´&gt;_&lt;</p><p>æ€è·¯æ˜¯æ¯æ¬¡é€’å½’çš„æ—¶å€™ä¼ ä¸€ä¸ªheadå‚æ•°è¿›å»ï¼Œåšä¸ºä¸‹ä¸€ä¸ªæ•°çš„èµ·ç‚¹</p><p>è¿™æ ·å°±èƒ½å¾ˆå¥½çš„é¿å…å‡ºç°å³è¾¹å‡ºç°ä¹‹å‰å‡ºç°è¿‡çš„æ•°</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">combinationSum</span><span class="hljs-params">(candidates []<span class="hljs-type">int</span>, target <span class="hljs-type">int</span>)</span></span> (ans [][]<span class="hljs-type">int</span>) &#123;<br>    <span class="hljs-comment">//é‚£å…¶å®å°±æ˜¯æ¯æ¬¡éƒ½è®¡ç®—æ‰€æœ‰æ¡ä»¶</span><br>    <span class="hljs-keyword">var</span> dfs <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(<span class="hljs-type">int</span>)</span></span><br>    count := <span class="hljs-number">0</span><br>    <span class="hljs-keyword">var</span> tmp []<span class="hljs-type">int</span> = <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>,<span class="hljs-number">0</span>)<br>    dfs = <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">( head <span class="hljs-type">int</span>)</span></span>&#123;<br>        <span class="hljs-keyword">if</span> count == target&#123;<br>           ans = <span class="hljs-built_in">append</span>(ans,<span class="hljs-built_in">append</span>([]<span class="hljs-type">int</span>(<span class="hljs-literal">nil</span>),tmp...))<br>           <span class="hljs-keyword">return</span>  <br>        &#125;<br>        <span class="hljs-keyword">for</span> i:=head;i&lt;<span class="hljs-built_in">len</span>(candidates);i++&#123;<br>            <span class="hljs-keyword">if</span>  candidates[i]+count&lt;=target&#123;<br>                count += candidates[i]<br>                tmp =<span class="hljs-built_in">append</span>(tmp,candidates[i])<br>                dfs(i)<br>                tmp = tmp[:<span class="hljs-built_in">len</span>(tmp)<span class="hljs-number">-1</span>]<br>                count-= candidates[i]<br>            &#125;<br>        &#125;<br>    &#125;<br>    dfs(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">return</span>  <br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åˆ†å‰²å›æ–‡ä¸²"><a href="#åˆ†å‰²å›æ–‡ä¸²" class="headerlink" title="åˆ†å‰²å›æ–‡ä¸²"></a>åˆ†å‰²å›æ–‡ä¸²</h3><p>é¢˜ç›®é“¾æ¥ ï¼š <a href="https://leetcode.cn/problems/palindrome-partitioning/">åˆ†å‰²å›æ–‡ä¸²</a></p><p>è¿™é¢˜ä¹Ÿæ˜¯å¯ä»¥ç”¨é€‰æˆ–è€…ä¸é€‰æ¥åšï¼Œä½†æ˜¯åœ¨å®ç°çš„æ—¶å€™æœ‰å˜ï¼Œä¸åªæ˜¯å•çº¯çš„ä¸é€‰å°±ç›´æ¥dfs(i+1),é€‰äº†çš„è¯å°±è®°å½•çŠ¶æ€</p><p>è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªforå¾ªç¯æ¥å®ç°åŸºäºå‰ä¸€ä¸ªåˆ†å‰²å¤„å¾€åæ‰€æœ‰çš„å­—ç¬¦ä¸²çš„å¯èƒ½æ€§</p><p>å¹¶è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœå­—ç¬¦ä¸²æ˜¯å›æ–‡çš„ï¼Œé‚£ä¹ˆå°±ä»¥è¯¥å­—ç¬¦ä¸²çš„ç»“å°¾+1ä½œä¸ºdfsçš„å‚æ•°ï¼ˆä¸‹ä¸€ä¸ªå­—ç¬¦ä¸²çš„èµ·ç‚¹ï¼‰</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ishuiwen</span><span class="hljs-params">(a <span class="hljs-type">string</span>)</span></span><span class="hljs-type">bool</span>&#123;<br>    <span class="hljs-keyword">if</span> a == <span class="hljs-string">&quot;&quot;</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    &#125;<br>    head := <span class="hljs-number">0</span><br>    near := <span class="hljs-built_in">len</span>(a)<span class="hljs-number">-1</span><br>    <span class="hljs-keyword">for</span> head &lt; near &#123;<br>        <span class="hljs-keyword">if</span> a[head] == a[near]&#123;<br>            head ++ <br>            near --<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">partition</span><span class="hljs-params">(s <span class="hljs-type">string</span>)</span></span> (ans [][]<span class="hljs-type">string</span>) &#123;<br>    <span class="hljs-keyword">var</span> tmp []<span class="hljs-type">string</span> = <span class="hljs-built_in">make</span>([]<span class="hljs-type">string</span> , <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">var</span> dfs <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(<span class="hljs-type">int</span>)</span></span><br>    dfs = <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(count <span class="hljs-type">int</span>)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>  count == <span class="hljs-built_in">len</span>(s) &#123;<br>            ans = <span class="hljs-built_in">append</span>(ans ,<span class="hljs-built_in">append</span>([]<span class="hljs-type">string</span>(<span class="hljs-literal">nil</span>),tmp...))<br>            <span class="hljs-keyword">return</span> <br>        &#125;<br>        <span class="hljs-keyword">for</span> j := count;j&lt;<span class="hljs-built_in">len</span>(s);j++ &#123;<br>            <span class="hljs-keyword">if</span> ishuiwen(s[count:j+<span class="hljs-number">1</span>]) &#123;<br>                tmp = <span class="hljs-built_in">append</span>(tmp,s[count:j+<span class="hljs-number">1</span>])<br>                dfs(j+<span class="hljs-number">1</span>)<br>                tmp = tmp[:<span class="hljs-built_in">len</span>(tmp)<span class="hljs-number">-1</span>]<br>            &#125;<br>        &#125;<br>    &#125;<br>    dfs(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">return</span> ans <br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å›¾è®º"><a href="#å›¾è®º" class="headerlink" title="å›¾è®º"></a>å›¾è®º</h2><h3 id="è¯¾ç¨‹è¡¨"><a href="#è¯¾ç¨‹è¡¨" class="headerlink" title="è¯¾ç¨‹è¡¨"></a>è¯¾ç¨‹è¡¨</h3><p>é¢˜ç›®é“¾æ¥ ï¼š<a href="https://leetcode.cn/problems/course-schedule/">è¯¾ç¨‹è¡¨</a></p><p>å›¾è®ºçš„é¢˜æœ‰å‘å›¾è¿˜æ˜¯æœ‰ç‚¹éš¾åº¦çš„ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹åˆ·åˆ°çš„ä¸€é¢˜æœ‰å‘å›¾çš„ç®—æ³•é¢˜ç›®</p><p>æ³¨æ„ï¼Œæ— å‘å›¾å¦‚æœå‡ ä¸ªç‚¹ç›¸äº’ä¹‹é—´éƒ½è¿èµ·æ¥äº†ï¼Œé‚£å°±çœŸçš„æ˜¯ç¯ï¼Œä½†æœ‰å‘å›¾å¾—çœ‹æ–¹å‘ï¼Œä¸ä¸€å®šå°±æ˜¯ç¯</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">canFinish</span><span class="hljs-params">(numCourses <span class="hljs-type">int</span>, prerequisites [][]<span class="hljs-type">int</span>)</span></span> <span class="hljs-type">bool</span> &#123;<br><span class="hljs-keyword">var</span> nums [][]<span class="hljs-type">int</span> = <span class="hljs-built_in">make</span>([][]<span class="hljs-type">int</span>, <span class="hljs-number">0</span>)<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; numCourses; i++ &#123;<br>nums = <span class="hljs-built_in">append</span>(nums, <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">0</span>))<br>&#125;<br><span class="hljs-keyword">for</span> _, v := <span class="hljs-keyword">range</span> prerequisites &#123;<br>nums[v[<span class="hljs-number">1</span>]] = <span class="hljs-built_in">append</span>(nums[v[<span class="hljs-number">1</span>]], v[<span class="hljs-number">0</span>])<br>&#125;<br><span class="hljs-comment">//æ£€æŸ¥æ˜¯å¦æœ‰æœ‰å‘ç¯</span><br><span class="hljs-keyword">var</span> visited []<span class="hljs-type">int</span> = <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, numCourses)<br><span class="hljs-keyword">var</span> dfs <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(<span class="hljs-type">int</span>)</span></span> <span class="hljs-type">bool</span><br>dfs = <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(i <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">bool</span> &#123;<br><span class="hljs-keyword">if</span> visited[i] == <span class="hljs-number">1</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><span class="hljs-keyword">if</span> visited[i] == <span class="hljs-number">-1</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br>visited[i] = <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> _, v := <span class="hljs-keyword">range</span> nums[i] &#123;<br><span class="hljs-keyword">if</span> !dfs(v) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br>&#125;<br>visited[i] = <span class="hljs-number">-1</span><br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; numCourses; i++ &#123;<br><span class="hljs-keyword">if</span> !dfs(i) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰‘æŒ‡offer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MIT6.S081å®éªŒè®°å½•</title>
    <link href="/2023/09/02/MIT6-S081%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95/"/>
    <url>/2023/09/02/MIT6-S081%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<p>å¸å–cs144çš„æ•™è®­ï¼Œä¸€å®šè¦å†™å®Œä¸€ä¸ªlabå°±æŠŠblogç»™å†™äº†ï¼Œä¸ç„¶æ—¶é—´ä¹…äº†ï¼Œè¦ä¹ˆä¸è®°å¾—äº†ï¼Œè¦ä¹ˆå°±ä¼šè§‰å¾—å½“æ—¶å¡äº†å¾ˆä¹…çš„é—®é¢˜ï¼Œå…¶å®å¾ˆç®€å•ï¼Œä¸æƒ³å†™ä¸Šå»</p><p>è£…ç¯å¢ƒè¿™å—ç›¸æ¯”cs144æ¥è¯´æ›´éº»çƒ¦ä¸€ç‚¹ï¼Œéœ€è¦è‡ªå·±ä¸‹è½½ç¼–è¯‘ï¼Œä½†æ˜¯æŒ‰ç…§å®˜æ–¹çš„å®‰è£…è¯´æ˜æ¥å…¶å®ä¹Ÿè¿˜å¥½</p><p><a href="https://pdos.csail.mit.edu/6.S081/2020/tools.html">å®éªŒç¯å¢ƒå®‰è£…</a></p><p>å› ä¸ºæ‰é‡æ–°å¼€å§‹å†™blogä¸ä¹…ï¼Œç¡®å®æœ‰å¾ˆå¤šåœ°æ–¹åšçš„ä¸å¤ªå¥½ï¼Œç›®å‰æ¥è¯´çš„å‡ ç¯‡blogæ„Ÿè§‰ä¸èƒ½è®©è¯»è€…éå¸¸è½»æ¾çš„é˜…è¯»ï¼Œåªé€‚åˆè‡ªå·±é˜…è¯»ï¼Œè¿™ç‚¹åé¢æ…¢æ…¢æ”¹å§</p><p>ï¼ˆ9.4ï¼šå› ä¸ºlab1å’Œlab2æ²¡æœ‰ç”¨gitåšç‰ˆæœ¬æ§åˆ¶å¯¼è‡´åº“é‡Œæ²¡æœ‰è¿™ä¸¤å®éªŒçš„ç›¸å…³codeï¼Œåªèƒ½åœ¨blogé‡Œè®°å½•äº†ï¼‰</p><h2 id="lab1-Xv6-and-Unix-utilities"><a href="#lab1-Xv6-and-Unix-utilities" class="headerlink" title="lab1 Xv6 and Unix utilities"></a>lab1 Xv6 and Unix utilities</h2><p><strong>ä»£ç ä»“åº“åœ°å€ï¼š</strong><a href="https://github.com/MadFrey/xv6">MadFrey&#x2F;xv6 (github.com)</a></p><p>This lab will familiarize you with xv6 and its system calls.</p><h3 id="sleep-easy"><a href="#sleep-easy" class="headerlink" title="sleep (easy)"></a>sleep (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">easy</a>)</h3><p>ç»ƒæ‰‹é¢˜ï¼Œéå¸¸ç®€å•  ä¸»è¦æ˜¯ç†Ÿæ‚‰ä¸€ä¸‹æ€ä¹ˆè¾“å…¥è¾“å‡º</p><p>å› ä¸ºæˆ‘å¼€å§‹å¹¶ä¸ç†Ÿæ‚‰æ•´ä¸ªå®éªŒçš„ç¯å¢ƒå’Œæµ‹è¯•æµç¨‹ï¼Œæ‰€ä»¥sleepæˆ‘å°±æ‹¿å¤§ä½¬çš„ä»£ç æ¥å¿«é€Ÿä¸Šæ‰‹äº†ï¼Œä»£ç ä¹Ÿå¾ˆç®€å•ï¼Œä¸»è¦æ˜¯ç†Ÿæ‚‰ä¸€ä¸‹å®éªŒå¹³å°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// sleep.c</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/types.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/stat.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;user/user.h&quot;</span> <span class="hljs-comment">// å¿…é¡»ä»¥è¿™ä¸ªé¡ºåº includeï¼Œç”±äºä¸‰ä¸ªå¤´æ–‡ä»¶æœ‰ä¾èµ–å…³ç³»</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> **argv)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span>(argc &lt; <span class="hljs-number">2</span>) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;usage: sleep &lt;ticks&gt;\n&quot;</span>);<br>    &#125;<br>    <span class="hljs-built_in">sleep</span>(<span class="hljs-built_in">atoi</span>(argv[<span class="hljs-number">1</span>]));<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="pingpong-easy"><a href="#pingpong-easy" class="headerlink" title="pingpong (easy)"></a>pingpong (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">easy</a>)</h3><p>è¿™é‡Œæ¶‰åŠåˆ°ä¸¤ä¸ªå…³é”®çš„ç‚¹ï¼Œforkï¼ˆï¼‰å’Œpipeï¼ˆï¼‰ï¼Œå¦‚æœèƒ½ç†è§£åˆ°è¿™ä¸¤ç³»ç»Ÿè°ƒç”¨çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Œé‚£è¿™é¢˜ä¹Ÿéå¸¸ç®€å•</p><p>todoï¼š pipe()çš„æ¦‚å¿µ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/types.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/stat.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;user/user.h&quot;</span> <span class="hljs-comment">// å¿…é¡»ä»¥è¿™ä¸ªé¡ºåº includeï¼Œç”±äºä¸‰ä¸ªå¤´æ–‡ä»¶æœ‰ä¾èµ–å…³ç³»</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc,<span class="hljs-type">char</span>* argv[])</span>&#123;<br>    <span class="hljs-type">int</span> pi[<span class="hljs-number">2</span>];<br>    <span class="hljs-type">int</span> pi2[<span class="hljs-number">2</span>];<br>    pipe(pi);<br>    pipe(pi2);<br>    <span class="hljs-keyword">if</span>(fork()==<span class="hljs-number">0</span>)&#123;<span class="hljs-comment">//child process</span><br>        <span class="hljs-type">char</span> buf;<br>        read(pi[<span class="hljs-number">0</span>],&amp;buf,<span class="hljs-keyword">sizeof</span>(buf));<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d: received ping\n&quot;</span>,getpid());<br>        write(pi2[<span class="hljs-number">1</span>],&amp;buf,<span class="hljs-keyword">sizeof</span>(buf));<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        write(pi[<span class="hljs-number">1</span>],<span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-number">1</span>);<br>        <span class="hljs-type">char</span> buf;<br>        read(pi2[<span class="hljs-number">0</span>],&amp;buf,<span class="hljs-keyword">sizeof</span>(buf));<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d: received pong\n&quot;</span>,getpid());<br>    &#125;<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="primes-moderate-hard"><a href="#primes-moderate-hard" class="headerlink" title="primes (moderate)&#x2F;(hard)"></a>primes (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">moderate</a>)&#x2F;(<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">hard</a>)</h3><p>è¿™é¢˜å¦‚æœè¯´æ˜¯éš¾é¢˜ï¼Œé‚£ä¹ˆéš¾å°±éš¾åœ¨ç†è§£åŸƒæ°ç­›è¿™ä¸ªç®—æ³•å’Œæ€ä¹ˆå®ç°ï¼Œç”±äºæˆ‘ä¹‹å‰åˆ·ç®—æ³•çš„æ—¶å€™åˆ·åˆ°è¿‡ç´ æ•°ç­›ï¼Œæ‰€ä»¥äº†è§£è¿‡ç›¸å…³æ¦‚å¿µï¼Œè¿™é¢˜å¯¹äºæˆ‘æ¥è¯´éš¾åº¦ä¸å¤§ï¼Œå°±æ˜¯å¤„ç†ç»†èŠ‚å¾—èŠ±æŒºå¤šæ—¶é—´</p><p>ç›¸å…³èµ„æ–™ï¼š<a href="https://swtch.com/~rsc/thread/">åŸƒæ°ç­›</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/types.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/stat.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;user/user.h&quot;</span> <span class="hljs-comment">// å¿…é¡»ä»¥è¿™ä¸ªé¡ºåº includeï¼Œç”±äºä¸‰ä¸ªå¤´æ–‡ä»¶æœ‰ä¾èµ–å…³ç³»</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> num,<span class="hljs-type">int</span> pip[])</span>&#123;<br>    <span class="hljs-type">int</span> pi[<span class="hljs-number">2</span>];<br>    pipe(pi);<br>    <span class="hljs-keyword">if</span> (num==<span class="hljs-number">-1</span>)<br>    &#123;<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br>    <br><br>    <span class="hljs-keyword">if</span>(fork()==<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-type">int</span> tmp;<br>        close(pi[<span class="hljs-number">1</span>]);  <span class="hljs-comment">//å…³å†™è¿›ç¨‹</span><br>        close(pip[<span class="hljs-number">0</span>]);<br>        read(pi[<span class="hljs-number">0</span>],&amp;tmp,<span class="hljs-keyword">sizeof</span>(tmp));<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;prime %d\n&quot;</span>, tmp);<br>        dfs(tmp,pi);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-type">int</span> tmp;<br>        close(pi[<span class="hljs-number">0</span>]);  <span class="hljs-comment">//å…³è¯»è¿›ç¨‹</span><br>        <span class="hljs-keyword">while</span>(read(pip[<span class="hljs-number">0</span>],&amp;tmp,<span class="hljs-keyword">sizeof</span>(tmp))&amp;&amp;tmp!=<span class="hljs-number">-1</span>)&#123;<br>            <span class="hljs-keyword">if</span> (tmp%num!=<span class="hljs-number">0</span>)&#123;<br>                write(pi[<span class="hljs-number">1</span>],&amp;tmp,<span class="hljs-keyword">sizeof</span>(tmp));<br>            &#125;<br>        &#125;<br>        <span class="hljs-type">int</span> end = <span class="hljs-number">-1</span>;      <span class="hljs-comment">//å¿˜è®°è¡¥å†™äº†ï¼Œä¸€ç›´åœ¨è¿™é‡Œè¶…æ—¶</span><br>        write(pi[<span class="hljs-number">1</span>],&amp;end,<span class="hljs-keyword">sizeof</span>(end));<br>        wait(<span class="hljs-number">0</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br>    <br>&#125;<br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[])</span>&#123;<br>    <span class="hljs-type">int</span> pi[<span class="hljs-number">2</span>];<br>    pipe(pi);<br>    <span class="hljs-type">int</span> num =<span class="hljs-number">2</span> ;<br>    <span class="hljs-keyword">if</span>(fork()==<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-type">int</span> tmp;<br>        close(pi[<span class="hljs-number">1</span>]);  <span class="hljs-comment">//å…³å†™è¿›ç¨‹</span><br>        read(pi[<span class="hljs-number">0</span>],&amp;tmp,<span class="hljs-keyword">sizeof</span>(tmp));<br>        dfs(tmp,pi);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-type">int</span> tmp = <span class="hljs-number">3</span>;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;prime %d\n&quot;</span>, num);<br>        close(pi[<span class="hljs-number">0</span>]);<br>        <span class="hljs-keyword">while</span>(tmp&lt;=<span class="hljs-number">35</span>)&#123;<br>            <span class="hljs-keyword">if</span>(tmp%num!=<span class="hljs-number">0</span>)&#123;<br>                write(pi[<span class="hljs-number">1</span>],&amp;tmp,<span class="hljs-keyword">sizeof</span>(tmp));<br>            &#125;<br>            tmp++;<br>        &#125;<br>        <span class="hljs-type">int</span> end = <span class="hljs-number">-1</span>;<br>        write(pi[<span class="hljs-number">1</span>],&amp;end,<span class="hljs-keyword">sizeof</span>(end));<br>    &#125;<br>    wait(<span class="hljs-number">0</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™è¾¹çš„ä¸€ä¸ªå‘ç‚¹å°±æ˜¯ç®¡é“ è¦æ³¨æ„å…³é—­ä¸éœ€è¦ç”¨åˆ°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¦åˆ™è·‘åˆ° n &#x3D; 13 çš„æ—¶å€™å°±ä¼šçˆ†æ‰ï¼Œå‡ºç°è¯»åˆ°å…¨æ˜¯ 0 çš„æƒ…å†µã€‚</p><blockquote><p>è¿™é‡Œçš„ç†ç”±æ˜¯ï¼Œfork ä¼šå°†çˆ¶è¿›ç¨‹çš„æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦éƒ½å¤åˆ¶åˆ°å­è¿›ç¨‹é‡Œï¼Œè€Œ xv6 æ¯ä¸ªè¿›ç¨‹èƒ½æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦æ€»æ•°åªæœ‰ 16 ä¸ª ï¼ˆè§ <code>defs.h</code> ä¸­çš„ <code>NOFILE</code> å’Œ <code>proc.h</code> ä¸­çš„ <code>struct file *ofile[NOFILE]; // Open files</code>ï¼‰ã€‚</p><p>ç”±äºä¸€ä¸ªç®¡é“ä¼šåŒæ—¶æ‰“å¼€ä¸€ä¸ªè¾“å…¥æ–‡ä»¶å’Œä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ï¼Œæ‰€ä»¥<strong>ä¸€ä¸ªç®¡é“å°±å ç”¨äº† 2 ä¸ªæ–‡ä»¶æè¿°ç¬¦</strong>ï¼Œå¹¶ä¸”å¤åˆ¶çš„<strong>å­è¿›ç¨‹è¿˜ä¼šå¤åˆ¶çˆ¶è¿›ç¨‹çš„æè¿°ç¬¦</strong>ï¼Œäºæ˜¯è·‘åˆ°ç¬¬å…­ä¸ƒå±‚åï¼Œå°±ä¼šç”±äºæœ€æœ«ç«¯çš„å­è¿›ç¨‹å‡ºç° 16 ä¸ªæ–‡ä»¶æè¿°ç¬¦éƒ½è¢«å æ»¡çš„æƒ…å†µï¼Œå¯¼è‡´æ–°ç®¡é“åˆ›å»ºå¤±è´¥ã€‚</p></blockquote><p>å…³é—­ä¸å¿…è¦çš„ç®¡é“å³å¯ï¼Œå¦‚æ–‡ä¸­ä»£ç æ‰€ç¤º</p><h3 id="find-moderate"><a href="#find-moderate" class="headerlink" title="find (moderate)"></a>find (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">moderate</a>)</h3><blockquote><p>Write a simple version of the UNIX find program: find all the files in a directory tree with a specific name. Your solution should be in the file <code>user/find.c</code>.</p></blockquote><p>hintè®©æˆ‘ä»¬å»çœ‹lsçš„æºç ï¼Œå…¶å®å¤§éƒ¨åˆ†ä»£ç éƒ½å¯ä»¥å¤ç”¨lsçš„ä»£ç ï¼Œæ‰€ä»¥éš¾åº¦ä¸å¤§</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// find.c</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/types.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/stat.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;user/user.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/fs.h&quot;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">char</span> *path, <span class="hljs-type">char</span> *target)</span><br>&#123;<br>    <span class="hljs-type">char</span> buf[<span class="hljs-number">512</span>], *p;<br>    <span class="hljs-type">int</span> fd;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">dirent</span> <span class="hljs-title">de</span>;</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">stat</span> <span class="hljs-title">st</span>;</span><br><br>    <span class="hljs-keyword">if</span> ((fd = open(path, <span class="hljs-number">0</span>)) &lt; <span class="hljs-number">0</span>)<br>    &#123;<br>        <span class="hljs-built_in">fprintf</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;find: cannot open %s\n&quot;</span>, path);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (fstat(fd, &amp;st) &lt; <span class="hljs-number">0</span>)<br>    &#123;<br>        <span class="hljs-built_in">fprintf</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;find: cannot stat %s\n&quot;</span>, path);<br>        close(fd);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">switch</span> (st.type)<br>    &#123;<br>    <span class="hljs-keyword">case</span> T_FILE:<br>       <br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(path + <span class="hljs-built_in">strlen</span>(path) - <span class="hljs-built_in">strlen</span>(target), target) == <span class="hljs-number">0</span>)<br>        &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, path);<br>        &#125;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> T_DIR:<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strlen</span>(path) + <span class="hljs-number">1</span> + DIRSIZ + <span class="hljs-number">1</span> &gt; <span class="hljs-keyword">sizeof</span> buf)<br>        &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;find: path too long\n&quot;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-built_in">strcpy</span>(buf, path);<br>        p = buf + <span class="hljs-built_in">strlen</span>(buf);<br>        *p++ = <span class="hljs-string">&#x27;/&#x27;</span>;<br>        <span class="hljs-keyword">while</span> (read(fd, &amp;de, <span class="hljs-keyword">sizeof</span>(de)) == <span class="hljs-keyword">sizeof</span>(de))<br>        &#123;<br>            <span class="hljs-keyword">if</span> (de.inum == <span class="hljs-number">0</span>)<br>                <span class="hljs-keyword">continue</span>;<br>            memmove(p, de.name, DIRSIZ);<br>            p[DIRSIZ] = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">if</span> (stat(buf, &amp;st) &lt; <span class="hljs-number">0</span>)<br>            &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;find: cannot stat %s\n&quot;</span>, buf);<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            <br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(buf + <span class="hljs-built_in">strlen</span>(buf) - <span class="hljs-number">2</span>, <span class="hljs-string">&quot;/.&quot;</span>) != <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-built_in">strcmp</span>(buf + <span class="hljs-built_in">strlen</span>(buf) - <span class="hljs-number">3</span>, <span class="hljs-string">&quot;/..&quot;</span>) != <span class="hljs-number">0</span>)<br>            &#123;<br>                find(buf, target); <span class="hljs-comment">// é€’å½’æŸ¥æ‰¾</span><br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    close(fd);<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[])</span><br>&#123;<br>    <span class="hljs-keyword">if</span> (argc &lt; <span class="hljs-number">3</span>)<br>    &#123;<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br>    <span class="hljs-type">char</span> target[<span class="hljs-number">512</span>];<br>    target[<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;/&#x27;</span>; <span class="hljs-comment">// ä¸ºæŸ¥æ‰¾çš„æ–‡ä»¶åæ·»åŠ  / åœ¨å¼€å¤´</span><br>    <span class="hljs-built_in">strcpy</span>(target + <span class="hljs-number">1</span>, argv[<span class="hljs-number">2</span>]);<br>    find(argv[<span class="hljs-number">1</span>], target);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="xargs-moderate"><a href="#xargs-moderate" class="headerlink" title="xargs (moderate)"></a>xargs (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">moderate</a>)</h3><blockquote><p>Write a simple version of the UNIX xargs program: read lines from the standard input and run a command for each line, supplying the line as arguments to the command. Your solution should be in the file <code>user/xargs.c</code>.</p></blockquote><p>è¿™é¢˜å¯¹äºæˆ‘æ¥è¯´ä¸€ä¸ªæ˜¯ç†è§£åˆ°ä½xargsçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Œä¸€ä¸ªæ˜¯cçš„è¯­æ³•å’Œç‰¹æ€§ï¼Œæ¯”å¦‚åœ¨é¢˜è§£ä¸­ä½¿ç”¨äº†çš„å¤§é‡çš„æŒ‡é’ˆç­‰ç­‰</p><p>xargsï¼šå°†æ ‡å‡†è¾“å…¥è½¬æ¢æˆå‘½ä»¤è¡Œè¾“å…¥ï¼ˆè®©echoç­‰å‘½ä»¤å¯ä»¥æ¥æ”¶åˆ°ï¼‰ï¼Œç„¶åè¿˜æœ‰å…¶ä»–çš„ä½œç”¨ï¼Œæ¯”å¦‚è¯´æ ¼å¼åŒ–è¾“å‡ºç­‰ç­‰ <a href="https://www.runoob.com/linux/linux-comm-xargs.html">Linux xargs å‘½ä»¤ | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></p><p>ä¹‹å‰ä¸€ç›´æ²¡èŠ±å¤ªå¤šæ—¶é—´åœ¨cè¯­è¨€ä¸Šï¼Œå¯èƒ½å¯¹äºæˆ‘æ¥è¯´è¿˜æ˜¯ä¸å¤ªç†Ÿæ‚‰cçš„ç‰¹æ€§å’Œæ“ä½œç³»ç»Ÿçš„ç›¸å…³æ¦‚å¿µï¼Œå†™è¿™é¢˜è¿˜æ˜¯èŠ±äº†æŒºé•¿æ—¶é—´çš„ï¼Œæœ€åè¿™é¢˜è¿˜æ˜¯å‚è€ƒäº†å¤§ä½¬çš„åšå®¢æ‰åƒé€æŠŠè¿™é¢˜è¿‡äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// xargs.c</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/types.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/stat.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;user/user.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/fs.h&quot;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">(<span class="hljs-type">char</span> *program, <span class="hljs-type">char</span> **args)</span><br>&#123;<br>    <span class="hljs-keyword">if</span> (fork() == <span class="hljs-number">0</span>)<br>    &#123; <span class="hljs-comment">// child exec</span><br>        exec(program, args);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span>; <span class="hljs-comment">// parent return</span><br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[])</span><br>&#123;<br>    <span class="hljs-comment">// è¯»å–æ‰€æœ‰çš„xargsçš„å‚æ•°</span><br>    <span class="hljs-type">char</span> buf[<span class="hljs-number">2048</span>]; <span class="hljs-comment">// ç¼“å†²readé‡Œè¯»å‡ºæ¥çš„å­—ç¬¦æ‹¼æ¥æˆå­—ç¬¦ä¸²å‚æ•°</span><br>    <span class="hljs-type">char</span> **argans;<br>    <span class="hljs-type">char</span> *argv2[<span class="hljs-number">128</span>]; <span class="hljs-comment">// ä¸èƒ½ç›´æ¥ä½¿ç”¨++ç§»åŠ¨æŒ‡é’ˆ</span><br>    argans = argv2;<br>    <span class="hljs-type">char</span> *start = buf;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; argc; i++)<br>    &#123;<br>        *argans = argv[i];<br>        argans++;<br>    &#125;<br><br>    <span class="hljs-comment">// è¯»å…¥å‚æ•°</span><br>    <span class="hljs-type">char</span> *p = buf;<br>    <span class="hljs-type">char</span> **pa = argans; <span class="hljs-comment">// argansä½œä¸ºå¤´éƒ¨æŒ‡é’ˆï¼Œé‡ç½®åˆ°æ•°ç»„å¼€å¤´çš„æ—¶å€™ç”¨</span><br>    <span class="hljs-keyword">while</span> (read(<span class="hljs-number">0</span>, p, <span class="hljs-number">1</span>) != <span class="hljs-number">0</span>)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (*p == <span class="hljs-string">&#x27; &#x27;</span>) <span class="hljs-comment">// è¯´æ˜æ˜¯å‚æ•°</span><br>        &#123;<br>            *p = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>            *(pa++) = start;<br>            start = p + <span class="hljs-number">1</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (*p == <span class="hljs-string">&#x27;\n&#x27;</span>) <span class="hljs-comment">// å¼€å§‹æ‰§è¡ŒæŒ‡ä»¤</span><br>        &#123;<br>            *p = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>            *(pa++) = start;<br>            start = p + <span class="hljs-number">1</span>;<br>            *pa = <span class="hljs-number">0</span>;<br>            run(argv[<span class="hljs-number">1</span>], argv2);<br>            pa = argans; <span class="hljs-comment">// é‡ç½®</span><br>        &#125;<br>        p++;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (pa != argans)<br>    &#123; <span class="hljs-comment">// å¦‚æœæœ€åä¸€è¡Œä¸æ˜¯ç©ºè¡Œ</span><br>        <span class="hljs-comment">// æ”¶å°¾æœ€åä¸€ä¸ªå‚æ•°</span><br>        *p = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>        *(pa++) = start;<br>        <span class="hljs-comment">// æ”¶å°¾æœ€åä¸€è¡Œ</span><br>        *pa = <span class="hljs-number">0</span>; <span class="hljs-comment">// å‚æ•°åˆ—è¡¨æœ«å°¾ç”¨ null æ ‡è¯†åˆ—è¡¨ç»“æŸ</span><br>        <span class="hljs-comment">// æ‰§è¡Œæœ€åä¸€è¡ŒæŒ‡ä»¤</span><br>        run(argv[<span class="hljs-number">1</span>], argv2);<br>    &#125;<br><br>    <span class="hljs-keyword">while</span> (wait(<span class="hljs-number">0</span>) != <span class="hljs-number">-1</span>)<br>    &#123;<br>    &#125;; <span class="hljs-comment">// å¾ªç¯ç­‰å¾…æ‰€æœ‰å­è¿›ç¨‹å®Œæˆï¼Œæ¯ä¸€æ¬¡ wait(0) ç­‰å¾…ä¸€ä¸ª</span><br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230903095735393.png"></p><h2 id="lab2"><a href="#lab2" class="headerlink" title="lab2"></a>lab2</h2><p><strong>ä»£ç ä»“åº“åœ°å€ï¼š</strong><a href="https://github.com/MadFrey/xv6">MadFrey&#x2F;xv6 (github.com)</a></p><blockquote><p>è®°å½•ä¸€ä¸‹è‡ªå·±åœ¨åšå®éªŒè¿‡ç¨‹ä¸­çš„ç–‘æƒ‘</p><p>trapframe : å‘ç”Ÿtrapæ—¶ï¼Œç”¨äºä¿å­˜å½“å‰è¿›ç¨‹å¦‚å¯„å­˜å™¨ç­‰çŠ¶æ€</p></blockquote><p>lab2å’Œlab1éƒ½æ˜¯æŒºç®€å•çš„ï¼Œè€Œä¸”lab2çš„ä»»åŠ¡é‡å’Œéš¾åº¦éƒ½æ¯”lab1å°ï¼Œç•™æ„labç»™çš„æç¤ºå°±è¡Œ</p><p>å› ä¸ºlab2çš„æºç ä¹Ÿä¸¢å¤±äº†ï¼Œè¿™é‡Œä¹Ÿæ²¡åŠæ³•æ”¾ä»£ç äº†</p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230903140502352.png"></p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/20230917104450.png"></p><p>åŠ¡å¿…æ³¨æ„æŒ‡å¯¼ä¹¦æç¤ºï¼š</p><blockquote><p>Some hints:</p><ul><li>Add <code>$U/_trace</code> to UPROGS in Makefile</li><li>Run make qemu and you will see that the compiler cannot compile <code>user/trace.c</code>, because the user-space stubs for the system call donâ€™t exist yet: add a prototype for the system call to <code>user/user.h</code>, a stub to <code>user/usys.pl</code>, and a syscall number to <code>kernel/syscall.h</code>. The Makefile invokes the perl script <code>user/usys.pl</code>, which produces <code>user/usys.S</code>, the actual system call stubs, which use the RISC-V <code>ecall</code> instruction to transition to the kernel. Once you fix the compilation issues, run trace 32 grep hello README; it will fail because you havenâ€™t implemented the system call in the kernel yet.</li><li>Add a <code>sys_trace()</code> function in <code>kernel/sysproc.c</code> that implements the new system call by remembering its argument in a new variable in the <code>proc</code> structure (see <code>kernel/proc.h</code>). The functions to retrieve system call arguments from user space are in <code>kernel/syscall.c</code>, and you can see examples of their use in <code>kernel/sysproc.c</code>.</li><li>Modify <code>fork()</code> (see <code>kernel/proc.c</code>) to copy the trace mask from the parent to the child process.</li><li>Modify the <code>syscall()</code> function in <code>kernel/syscall.c</code> to print the trace output. You will need to add an array of syscall names to index into.</li></ul></blockquote><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230903151705364.png"></p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/20230917104433.png"></p><h2 id="lab3"><a href="#lab3" class="headerlink" title="lab3"></a>lab3</h2><p><strong>ä»£ç ä»“åº“åœ°å€ï¼š</strong><a href="https://github.com/MadFrey/xv6">MadFrey&#x2F;xv6 (github.com)</a></p><h3 id="Print-a-page-table"><a href="#Print-a-page-table" class="headerlink" title="Print a page table"></a>Print a page table</h3><blockquote><p>Define a function called <code>vmprint()</code>. It should take a <code>pagetable_t</code> argument, and print that pagetable in the format described below. Insert <code>if(p-&gt;pid==1) vmprint(p-&gt;pagetable)</code> in exec.c just before the <code>return argc</code>, to print the first processâ€™s page table. You receive full credit for this assignment if you pass the <code>pte printout</code> test of <code>make grade</code>.</p></blockquote><p>ç¬¬ä¸€è¡Œæ‰“å°ä¼ å…¥vmçš„å‚æ•°ï¼Œæˆ‘ä»¬æŠŠä¼ è¿›æ¥çš„pagetableç”¨%pæ‰“å°ä¸€ä¸‹å°±å¥½äº†</p><blockquote><p>The root of the tree is a 4096-byte page-table page that contains 512 PTEs, which contain the physical addresses for page-table pages in the next level of the tree.Each of those pages contains 512 PTEs for the final level in the tree.</p></blockquote><p>æ¥ç€éå†ä»–çš„512ä¸ªPTEï¼Œæ ¹æ®æ ‡å¿—ä½åˆ¤æ–­æ˜¯å¦æœ‰childï¼Œå¦‚æœæœ‰çš„è¯å°±ç»§ç»­é€’å½’ï¼Œè¿™è¾¹å¯ä»¥é€šè¿‡depthå‚æ•°æ¥è¿›è¡Œæ‰“å° .. çš„æ“ä½œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span><br><span class="hljs-title function_">dfs</span><span class="hljs-params">(<span class="hljs-type">pagetable_t</span> pagetable,uint64 depth)</span><br>&#123;<br>    <span class="hljs-keyword">if</span> (depth&gt;<span class="hljs-number">2</span>)&#123;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(depth==<span class="hljs-number">1</span>)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;.. ..&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">512</span>; i++)&#123;<br>        <span class="hljs-type">pte_t</span> pte = pagetable[i];<br>        <span class="hljs-keyword">if</span>((pte &amp; PTE_V) )&#123;<br>            <span class="hljs-keyword">if</span> (depth==<span class="hljs-number">0</span>)&#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;..&quot;</span>);<br>            &#125;<br>            <span class="hljs-keyword">if</span> (depth==<span class="hljs-number">2</span>)&#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;.. .. ..&quot;</span>);<br>            &#125;<br>            uint64 child = PTE2PA(pte);<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d: pte %p pa %p\n&quot;</span>,i,pagetable[i],child);<br>            <span class="hljs-keyword">if</span>( (pte &amp; (PTE_R|PTE_W|PTE_X)) == <span class="hljs-number">0</span>)&#123;<br>                dfs((<span class="hljs-type">pagetable_t</span>)child,depth+<span class="hljs-number">1</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">vmprint</span><span class="hljs-params">(<span class="hljs-type">pagetable_t</span> ptb)</span>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;page table %p\n&quot;</span>, ptb);<br>    dfs(ptb,<span class="hljs-number">0</span>);<br>&#125;s<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230904172005306.png"></p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230904172910125.png"></p><h3 id="A-kernel-page-table-per-process"><a href="#A-kernel-page-table-per-process" class="headerlink" title="A kernel page table per process"></a>A kernel page table per process</h3><blockquote><p>Your first job is to modify the kernel so that every process uses its own copy of the kernel page table when executing in the kernel. Modify <code>struct proc</code> to maintain a kernel page table for each process, and modify the scheduler to switch kernel page tables when switching processes. For this step, each per-process kernel page table should be identical to the existing global kernel page table. You pass this part of the lab if <code>usertests</code> runs correctly.</p></blockquote><p>è¿™é¢˜æ³¨æ„ä»–ç»™çš„hintï¼Œçœ‹ç€ä¸€æ­¥ä¸€æ­¥æ¥ï¼Œè¿˜æ˜¯æ¯”è¾ƒå¥½åšçš„ï¼Œä¸»è¦æ˜¯é¢˜æ„å¥½ç†è§£</p><blockquote><p>A PTE can only refer to a physical address that is aligned on a 4096-byte boundary (is a multiple of 4096), so freerange uses PGROUNDUP to ensure that it frees only aligned physical addresses. </p></blockquote><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230905163657350.png"></p><h3 id="Simplify-copyin-copyinstr"><a href="#Simplify-copyin-copyinstr" class="headerlink" title="Simplify copyin/copyinstr"></a>Simplify <code>copyin/copyinstr</code></h3><blockquote><p>Replace the body of <code>copyin</code> in <code>kernel/vm.c</code> with a call to <code>copyin_new</code> (defined in <code>kernel/vmcopyin.c</code>); do the same for <code>copyinstr</code> and <code>copyinstr_new</code>. Add mappings for user addresses to each processâ€™s kernel page table so that <code>copyin_new</code> and <code>copyinstr_new</code> work. You pass this assignment if <code>usertests</code> runs correctly and all the <code>make grade</code> tests pass.</p></blockquote><p>å¡äº†æœ‰æ®µæ—¶é—´ï¼Œä¸€å¼€å§‹é¢˜æ„ç†è§£åˆ°å°±å»åšï¼Œè´¹äº†å¾ˆå¤§çš„ç²¾åŠ›ï¼Œæœ€åè¿˜æ˜¯ä¸å¾—ä¸å›æ»šåˆ°ä¸€å¼€å§‹çš„ç‰ˆæœ¬ï¼ˆæ‰€ä»¥ä¸‹æ¬¡ä¸€å®šæŠŠä»–çš„é¢˜ç›®æ„æ€æ˜¯ä»€ä¹ˆææ‡‚å†å»åšï¼Œä¸ç„¶å¾ˆå®¹æ˜“ç†è§£é”™é¢˜æ„ï¼Œæµªè´¹ç²¾åŠ›ã€‚ã€‚è™½ç„¶ä½†æ˜¯èŠ±çš„æ—¶é—´ä¹Ÿæ˜¯å»äº†è§£xv6çš„è®¾è®¡ï¼Œä¹Ÿå¯ä»¥è¯´ä¸ç®—æµªè´¹ï¼Ÿï¼‰</p><blockquote><p> However, this scheme does limit the maximum size of a user process to be less than the kernelâ€™s lowest virtual address. After the kernel has booted, that address is <code>0xC000000</code> in xv6, the address of the PLIC registers; see <code>kvminit()</code> in <code>kernel/vm.c</code>, <code>kernel/memlayout.h</code>, and Figure 3-4 in the text. Youâ€™ll need to modify xv6 to prevent user processes from growing larger than the PLIC address.</p></blockquote><p>copyinåœ¨ç”¨æˆ·è¿›ç¨‹ä½¿ç”¨ï¼Œva !&#x3D; paï¼Œcopyin_newåœ¨kernelä¸­ä½¿ç”¨ï¼Œva &#x3D; paã€‚ ç†è§£åˆ°è¿™ä¸ªå°±éå¸¸ç®€å•äº†</p><p>è¯¦è§ä¸‹é¢ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨çš„æ˜¯0åˆ°PLICä¸‹é¢çš„åœ°å€</p><p>æ‰€ä»¥æˆ‘ä»¬æ˜ å°„çš„æ—¶å€™ä¸éœ€è¦æ˜ å°„CLINT</p><p>æ¥ç€æ ¹æ®hintæåˆ°çš„å’Œå†…æ ¸é¡µè¡¨ç›¸å…³çš„åœ°æ–¹è¿›è¡Œä¿®æ”¹</p><p><img src="http://xv6.dgs.zone/tranlate_books/book-riscv-rev1/images/c3/p3.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230905204525549.png"></p><h2 id="lab4-Traps"><a href="#lab4-Traps" class="headerlink" title="lab4 Traps"></a>lab4 Traps</h2><p><strong>ä»£ç ä»“åº“åœ°å€ï¼š</strong><a href="https://github.com/MadFrey/xv6">MadFrey&#x2F;xv6 (github.com)</a></p><h3 id="RISC-V-assembly"><a href="#RISC-V-assembly" class="headerlink" title="RISC-V assembly"></a>RISC-V assembly</h3><ul><li>Which registers contain arguments to functions? For example, which register holds 13 in mainâ€™s call to <code>printf</code>?</li></ul><p>â€‹     <strong>A:</strong>   a0-a7; a2;</p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230906112130650.png"></p><ul><li>Where is the call to function f in the assembly code for main? Where is the call to g? <strong>(Hint: the compiler may inline functions.)</strong></li></ul><p><strong>A:</strong> è¢«å†…è”åˆ°äº†mainå‡½æ•°ä¸­</p><ul><li>At what address is the function <code>printf</code> located?</li></ul><p> <strong>A:</strong> 0x630</p><ul><li>What value is in the register <code>ra</code> just after the <code>jalr</code> to <code>printf</code> in <code>main</code>?</li></ul><p><strong>A:</strong> 0x38</p><ul><li><blockquote><p>Run the following code.</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs perl">unsigned <span class="hljs-keyword">int</span> i = <span class="hljs-number">0x00646c72</span>;<br><span class="hljs-keyword">printf</span>(<span class="hljs-string">&quot;H%x Wo%s&quot;</span>, <span class="hljs-number">57616</span>, &amp;i);<br>     <br></code></pre></td></tr></table></figure><p>What is the output? <a href="http://web.cs.mun.ca/~michael/c/ascii-table.html">Hereâ€™s an ASCII table</a> that maps bytes to characters.</p><p>The output depends on that fact that the RISC-V is little-endian. If the RISC-V were instead big-endian what would you set <code>i</code> to in order to yield the same output? Would you need to change <code>57616</code> to a different value?</p><p><a href="http://www.webopedia.com/TERM/b/big_endian.html">Hereâ€™s a description of little- and big-endian</a> and <a href="http://www.networksorcery.com/enp/ien/ien137.txt">a more whimsical description</a>.</p></blockquote></li></ul><p>å¾ˆç®€å•ï¼Œæ‡’å¾—å¤åˆ¶ä»£ç è·‘äº†ï¼Œ</p><ul><li>In the following code, what is going to be printed after â€˜y&#x3D;â€™? (note: the answer is not a specific value.) Why does this happen?</li></ul><p><strong>A:</strong>  éšæœºçš„ï¼Œå–å†³äºa2å¯„å­˜å™¨é‡Œçš„å€¼</p><h3 id="Backtrace"><a href="#Backtrace" class="headerlink" title="Backtrace"></a>Backtrace</h3><blockquote><p>Implement a <code>backtrace()</code> function in <code>kernel/printf.c</code>. Insert a call to this function in <code>sys_sleep</code>, and then run bttest, which calls <code>sys_sleep</code>. Your output should be as follows:</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">backtrace:</span><br><span class="hljs-number">0x0000000080002cda</span><br><span class="hljs-number">0x0000000080002bb6</span><br><span class="hljs-number">0x0000000080002898</span><br>  <br></code></pre></td></tr></table></figure><p>After <code>bttest</code> exit qemu. In your terminal: the addresses may be slightly different but if you run <code>addr2line -e kernel/kernel</code> (or <code>riscv64-unknown-elf-addr2line -e kernel/kernel</code>) and cut-and-paste the above addresses as follows:</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">$ addr2line -e kernel/kernel<br><span class="hljs-number">0x0000000080002de2</span><br><span class="hljs-number">0x0000000080002f4a</span><br><span class="hljs-number">0x0000000080002bfc</span><br>Ctrl-D<br>  <br></code></pre></td></tr></table></figure><p>You should see something like this:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">kernel</span>/sysproc.c:<span class="hljs-number">74</span><br><span class="hljs-attribute">kernel</span>/syscall.c:<span class="hljs-number">224</span><br><span class="hljs-attribute">kernel</span>/trap.c:<span class="hljs-number">85</span><br></code></pre></td></tr></table></figure></blockquote><p>è¿™é¢˜æ³¨æ„ä¸€ä¸‹</p><blockquote><ul><li>These <a href="https://pdos.csail.mit.edu/6.828/2020/lec/l-riscv-slides.pdf">lecture notes</a> have a picture of the layout of stack frames. Note that the return address lives at a fixed offset (-8) from the frame pointer of a stackframe, and that the saved frame pointer lives at fixed offset (-16) from the frame pointer.</li></ul></blockquote><p>è¿™ä¸ªå°±å¥½äº†ï¼Œeasyé¢˜ï¼Œæ²¡ä»€ä¹ˆéš¾åº¦</p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230906164256057.png"></p><h3 id="Alarm"><a href="#Alarm" class="headerlink" title="Alarm"></a>Alarm</h3><blockquote><p>In this exercise youâ€™ll add a feature to xv6 that periodically alerts a process as it uses CPU time. This might be useful for compute-bound processes that want to limit how much CPU time they chew up, or for processes that want to compute but also want to take some periodic action. More generally, youâ€™ll be implementing a primitive form of user-level interrupt&#x2F;fault handlers; you could use something similar to handle page faults in the application, for example. Your solution is correct if it passes alarmtest and usertests.</p></blockquote><p>è¿™è¾¹è°ƒç”¨ä¼ å…¥çš„alarmå‡½æ•°æ˜¯ç›´æ¥ç”¨ç¨‹åºè®¡æ•°å™¨æŒ‡å‘å‡½æ•°è¿›è¡Œè¿è¡Œï¼Œç„¶åé€šè¿‡sigreturnæ¢å¤</p><p>ä½†æ˜¯ä¸€å¼€å§‹å°è¯•åªæ¢å¤epcä¸è¡Œï¼Œè¿˜æ˜¯ä¼šæŠ¥é”™</p><p>åŸå› æ˜¯åœ¨å‡½æ•°è°ƒç”¨çš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šå¯¹å¯„å­˜å™¨è¿›è¡Œä¿®æ”¹</p><p>æ‰€ä»¥å¾—æŠŠæ•´ä¸ªéƒ½ä¿å­˜ä¸‹æ¥</p><p>å› ä¸ºcè¯­è¨€çš„åŸºç¡€ç¡®å®å·®ï¼Œæœ€åç”¨çš„ç¬¨æ–¹æ³•ï¼Œç›´æ¥å­˜å‚¨30å¤šä¸ªå¯„å­˜å™¨çš„å€¼ï¼Œä¸€å¼€å§‹ä¹Ÿæƒ³ç€ç”¨ä¸€ä¸ªstruct trapframe *trapframe è¿™æ ·çš„ç»“æ„ä½“æŒ‡é’ˆçš„ï¼Œå‘ç°ç›´æ¥èµ‹å€¼è¡Œä¸é€šï¼Œç„¶åå°è¯•åˆå§‹åŒ–æŒ‡é’ˆåˆ†é…å†…å­˜åè¿˜æ˜¯æŠ¥é”™ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œç„¶åå°±ç›´æ¥æŠŠ30å¤šä¸ªå¯„å­˜å™¨éƒ½æ”¾åˆ°pé‡Œç”¨äºä¿å­˜ã€‚</p><blockquote><p>åé¢äº†è§£åˆ°å¥½åƒè¿˜å¾—å®ç°ç»“æ„ä½“çš„freeæ‰è¡Œï¼Œä½†æˆ‘åé¢æ²¡å»æ²¡å°è¯•è¿‡</p></blockquote><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230907221659128.png"></p><h2 id="lab5-xv6-lazy-page-allocation"><a href="#lab5-xv6-lazy-page-allocation" class="headerlink" title="lab5 xv6 lazy page allocation"></a>lab5 xv6 lazy page allocation</h2><p><strong>ä»£ç ä»“åº“åœ°å€ï¼š</strong><a href="https://github.com/MadFrey/xv6">MadFrey&#x2F;xv6 (github.com)</a></p><blockquote><p>One of the many neat tricks an O&#x2F;S can play with page table hardware is lazy allocation of user-space heap memory. Xv6 applications ask the kernel for heap memory using the sbrk() system call. In the kernel weâ€™ve given you, sbrk() allocates physical memory and maps it into the processâ€™s virtual address space. It can take a long time for a kernel to allocate and map memory for a large request. Consider, for example, that a gigabyte consists of 262,144 4096-byte pages; thatâ€™s a huge number of allocations even if each is individually cheap. In addition, some programs allocate more memory than they actually use (e.g., to implement sparse arrays), or allocate memory well in advance of use. To allow sbrk() to complete more quickly in these cases, sophisticated kernels allocate user memory lazily. That is, sbrk() doesnâ€™t allocate physical memory, but just remembers which user addresses are allocated and marks those addresses as invalid in the user page table. When the process first tries to use any given page of lazily-allocated memory, the CPU generates a page fault, which the kernel handles by allocating physical memory, zeroing it, and mapping it. Youâ€™ll add this lazy allocation feature to xv6 in this lab.</p></blockquote><p>è¿™æ¬¡çš„labæ¯”è¾ƒç®€å•ï¼Œå¤§æ¦‚ç”¨æ—¶3-4å°æ—¶åšå®Œäº†ï¼Œæ²¡æœ‰hardé¢˜</p><h3 id="Eliminate-allocation-from-sbrk-easy"><a href="#Eliminate-allocation-from-sbrk-easy" class="headerlink" title="Eliminate allocation from sbrk() (easy)"></a>Eliminate allocation from sbrk() (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">easy</a>)</h3><blockquote><p>Your first task is to delete page allocation from the sbrk(n) system call implementation, which is the function sys_sbrk() in sysproc.c. The sbrk(n) system call grows the processâ€™s memory size by n bytes, and then returns the start of the newly allocated region (i.e., the old size). Your new sbrk(n) should just increment the processâ€™s size (myproc()-&gt;sz) by n and return the old size. It should not allocate memory â€“ so you should delete the call to growproc() (but you still need to increase the processâ€™s size!).</p></blockquote><p>çº¯æ¦‚å¿µï¼Œæ•…è·³è¿‡</p><p>å› ä¸ºè¿™æ¬¡labçš„å‡ ä¸ªé¢˜éƒ½æ˜¯æœ‰è”ç³»çš„ï¼Œè¿™é¢˜ä¹Ÿæ˜¯ä¸ºäº†åé¢å‡ é¢˜åšé“ºå«</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">  <span class="hljs-keyword">if</span> (n&lt;<span class="hljs-number">0</span>)&#123;<br>        uvmdealloc(myproc()-&gt;pagetable,myproc()-&gt;sz,myproc()-&gt;sz+n);<br>    &#125;<br>  myproc()-&gt;sz=myproc()-&gt;sz+n;<br><br><span class="hljs-comment">//  if(growproc(n) &lt; 0)</span><br><span class="hljs-comment">//    return -1;</span><br></code></pre></td></tr></table></figure><h3 id="Lazy-allocation-moderate"><a href="#Lazy-allocation-moderate" class="headerlink" title="Lazy allocation (moderate)"></a>Lazy allocation (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">moderate</a>)</h3><blockquote><p>Modify the code in trap.c to respond to a page fault from user space by mapping a newly-allocated page of physical memory at the faulting address, and then returning back to user space to let the process continue executing. You should add your code just before the <code>printf</code> call that produced the â€œusertrap(): â€¦â€ message. Modify whatever other xv6 kernel code you need to in order to get <code>echo hi</code> to work.</p></blockquote><p>è¿™é¢˜è·Ÿç€hintèµ°å°±è¡Œï¼Œä¸ºä¸‹ä¸€é¢˜åšé“ºå«</p><blockquote><ul><li>You can check whether a fault is a page fault by seeing if r_scause() is 13 or 15 in usertrap().</li><li><code>r_stval()</code> returns the RISC-V <code>stval</code> register, which contains the virtual address that caused the page fault.</li><li>Steal code from uvmalloc() in vm.c, which is what sbrk() calls (via growproc()). Youâ€™ll need to call kalloc() and mappages().</li><li>Use PGROUNDDOWN(va) to round the faulting virtual address down to a page boundary.</li><li>uvmunmap() will panic; modify it to not panic if some pages arenâ€™t mapped.</li><li>If the kernel crashes, look up sepc in kernel&#x2F;kernel.asm</li><li>Use your <code>vmprint</code> function from pgtbl lab to print the content of a page table.</li><li>If you see the error â€œincomplete type procâ€, include â€œspinlock.hâ€ then â€œproc.hâ€.</li></ul></blockquote><h3 id="Lazytests-and-Usertests-moderate"><a href="#Lazytests-and-Usertests-moderate" class="headerlink" title="Lazytests and Usertests (moderate)"></a>Lazytests and Usertests (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">moderate</a>)</h3><blockquote><p>Weâ€™ve supplied you with <code>lazytests</code>, an xv6 user program that tests some specific situations that may stress your lazy memory allocator. Modify your kernel code so that all of both <code>lazytests</code> and <code>usertests</code> pass.</p></blockquote><p>é¢˜ç›®ä¸­æåˆ°çš„hintéƒ½è¦å®ç°ï¼Œæˆ‘å†™åˆ°åé¢å‘ç°æ¼äº†readè¿™å‡ ä¸ªç³»ç»Ÿè°ƒç”¨ä¹Ÿå¾—ä¿®æ”¹ï¼Œç„¶åå°±æ˜¯æœ€åä¸€ä¸ªstackï¼Œæˆ‘åšäº†åˆ¤æ–­ï¼Œä½†æ˜¯æ²¡æœ‰elseæŠŠkillè®¾ç½®ä¸º1æ€æ‰è¿›ç¨‹ï¼Œå¯¼è‡´usertestè¿‡ä¸å»ï¼Œå¡åœ¨stacké‚£ä¸ªæµ‹è¯•ç‚¹ä¸åŠ¨ï¼Œå› ä¸ºæˆ‘ä¸€ç›´è®¤ä¸ºæˆ‘æ˜¯ifå¦‚æœæ²¡è¿›å»é‚£å°±ä¼šè¢«æ€æ‰ï¼Œå¼€å§‹å°±æ²¡å¾€è¿™è¾¹æƒ³ï¼Œåé¢å›å¤´ä¸€çœ‹æ‰å‘ç°ä¸å¾—è¡Œã€‚æµªè´¹æˆ‘1ä¸ªå¤šå°æ—¶çš„æ—¶é—´</p><blockquote><ul><li>Handle negative sbrk() arguments.</li><li>Kill a process if it page-faults on a virtual memory address higher than any allocated with sbrk().</li><li>Handle the parent-to-child memory copy in fork() correctly.</li><li>Handle the case in which a process passes a valid address from sbrk() to a system call such as read or write, but the memory for that address has not yet been allocated.</li><li>Handle out-of-memory correctly: if kalloc() fails in the page fault handler, kill the current process.</li><li>Handle faults on the invalid page below the user stack.</li></ul></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">usertests</span><br>usertests starting<br>test execout: OK<br>test copyin: OK<br>test copyout: OK<br>test copyinstr1: OK<br>test copyinstr2: OK<br>test copyinstr3: OK<br>test rwsbrk: OK<br>test truncate1: OK<br>test truncate2: OK<br>test truncate3: OK<br>test reparent2: OK<br>test pgbug: OK<br>test sbrkbugs: usertrap(): unexpected scause 0x000000000000000c pid=3235<br>            sepc=0x0000000000005580 stval=0x0000000000005580<br>usertrap(): unexpected scause 0x000000000000000c pid=3236<br>            sepc=0x0000000000005580 stval=0x0000000000005580<br>OK<br>test badarg: OK<br>test reparent: OK<br>test twochildren: OK<br>test forkfork: OK<br>test forkforkfork: OK<br>test argptest: OK<br>test createdelete: OK<br>test linkunlink: OK<br>test linktest: OK<br>test unlinkread: OK<br>test concreate: OK<br>test subdir: OK<br>test fourfiles: OK<br>test sharedfd: OK<br>test exectest: OK<br>test bigargtest: OK<br>test bigwrite: OK<br>test bsstest: OK<br>test sbrkbasic: OK<br>test sbrkmuch: OK<br>test kernmem: OK<br>test sbrkfail: OK<br>test sbrkarg: OK<br>test validatetest: OK<br>test stacktest: OK<br>test opentest: OK<br>test writetest: OK<br>test writebig: OK<br>test createtest: OK<br>test openiput: OK<br>test exitiput: OK<br>test iput: OK<br>test mem: OK<br>test pipe1: OK<br>test preempt: kill... wait... OK<br>test exitwait: OK<br>test rmdot: OK<br>test fourteen: OK<br>test bigfile: OK<br>test dirfile: OK<br>test iref: OK<br>test forktest: OK<br>test bigdir: OK<br>ALL TESTS PASSED<br></code></pre></td></tr></table></figure><h2 id="lab6-Copy-on-Write-Fork-for-xv6"><a href="#lab6-Copy-on-Write-Fork-for-xv6" class="headerlink" title="lab6 Copy-on-Write Fork for xv6"></a>lab6 Copy-on-Write Fork for xv6</h2><blockquote><p>Virtual memory provides a level of indirection: the kernel can intercept memory references by marking PTEs invalid or read-only, leading to page faults, and can change what addresses mean by modifying PTEs. There is a saying in computer systems that any systems problem can be solved with a level of indirection. The lazy allocation lab provided one example. This lab explores another example: copy-on write fork.</p></blockquote><p><strong>ä»£ç ä»“åº“åœ°å€ï¼š</strong><a href="https://github.com/MadFrey/xv6">MadFrey&#x2F;xv6 (github.com)</a></p><p>å“ï¼Œå•¥ä¹Ÿä¸å¤šè¯´äº†ï¼Œé¢˜ç›®åšèµ·æ¥å¿«ï¼Œä½†æ˜¯debugèŠ±çš„æ—¶é—´å¤ªå¤šäº†ï¼ˆæˆ‘å¤ªèœäº†QAQï¼‰</p><p>ç¬¬ä¸€ä¸ªé‡åˆ°çš„bugï¼Œä¹Ÿæ˜¯æˆ‘èŠ±äº†æœ€å¤šæ—¶é—´ï¼Œå¹¶ä¸”ç›®å‰è¿˜æ²¡getåˆ°ä¸ºä»€ä¹ˆä¸è¡Œçš„åœ°æ–¹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">COW_alloc</span><span class="hljs-params">(<span class="hljs-type">pagetable_t</span> ptl,uint64 va)</span>&#123;<br>    va = PGROUNDDOWN(va);<br>    <span class="hljs-type">pte_t</span> * pte;<br>    <span class="hljs-keyword">if</span>((pte=walk(ptl,va,<span class="hljs-number">0</span>))==<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;judge_page_fault walk err\n&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    uint64 pa =   PA2PTE(*pte);<br>    <span class="hljs-comment">//é‡è®¾flag</span><br>    *pte=*pte | PTE_W;<br>    *pte=*pte &amp; ~PTE_COW;<br>    <span class="hljs-type">int</span> flag =  PTE_FLAGS(*pte);<br><br>    <span class="hljs-comment">//åˆ†é…å†…å­˜</span><br>    uint64  mem = (uint64) kalloc();<br>    <span class="hljs-keyword">if</span>(mem==<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;COW_alloc kalloc failed\n&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    memmove((<span class="hljs-type">char</span>*)mem,(<span class="hljs-type">char</span>* )pa,PGSIZE);<br>    <span class="hljs-comment">//è§£é™¤æ˜ å°„å…³ç³»</span><br>    uvmunmap(ptl,va,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>);<br>    <span class="hljs-comment">//é‡æ–°æ˜ å°„</span><br>    <span class="hljs-keyword">if</span>(mappages(ptl,va,PGSIZE,(uint64)mem,flag)&lt;<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;COW_alloc mappages failed\n&quot;</span>);<br>        kfree((<span class="hljs-type">void</span>*)mem);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">cow</span><span class="hljs-params">(<span class="hljs-type">pagetable_t</span> pagetable, uint64 va)</span> &#123;<br>    <span class="hljs-keyword">if</span> (va &gt;= MAXVA) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-comment">// æ‰¾åˆ°vaå¯¹åº”çš„pte</span><br>    <span class="hljs-type">pte_t</span>* pte = walk(pagetable, va, <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span> (pte == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ((*pte &amp; PTE_V) == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ((*pte &amp; PTE_COW) == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ((*pte &amp; PTE_U) == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-comment">// ç‰©ç†åœ°å€</span><br>    uint64 pa = PTE2PA(*pte);<br>    uint64 ka = (uint64) kalloc();<br>    <span class="hljs-keyword">if</span> (ka == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// å¤åˆ¶paåˆ°ka</span><br>        memmove((<span class="hljs-type">char</span>*)ka, (<span class="hljs-type">char</span>*)pa, PGSIZE);<br>        uint64 flags = PTE_FLAGS(*pte);<br>        *pte = PA2PTE(ka) | flags | PTE_W;<br>        *pte &amp;= (~PTE_COW);<br>        <span class="hljs-comment">// æ›´æ–°è®¡æ•°</span><br>        kfree((<span class="hljs-type">void</span> *)pa);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸¤æ®µä»£ç åªæœ‰ä¸‹é¢çš„å¯ä»¥è·‘é€šï¼Œä¸Šé¢çš„ä¸è¡Œï¼Œä½†æˆ‘è‡ªå·±çœ‹èµ·æ¥æ„Ÿè§‰æ²¡ä»€ä¹ˆå¤ªå¤§åŒºåˆ«ï¼Œä¸Šé¢çš„memmoveé€šè¿‡ä¸äº†ï¼Œè¿™æ˜¯æˆ‘æœ€ç–‘æƒ‘çš„åœ°æ–¹ï¼Œå…ˆæ’ä¸ªçœ¼ï¼Œåé¢å›è¿‡å¤´æ¥ç ”ç©¶ä¸‹</p><p>ç¬¬äºŒä¸ªå°±æ˜¯é”ï¼Œä»–çš„æµ‹è¯•æœ‰å‡ ä¸ªæ˜¯ä¼šä¸Šå‹åŠ›å¹¶å‘æµ‹è¯•çš„ï¼Œæˆ‘åœ¨è¿™é‡Œåƒäº†ä¸ªäºï¼Œè¯»å–çš„æ—¶å€™ç›´æ¥returnäº†ï¼ˆQAQï¼‰,æ‰€æœ‰çš„å¯¹COWå¼•ç”¨æ•°ç»„çš„æ“ä½œå…¨è¦åŠ é”ï¼Œä¸ç„¶è¿‡ä¸äº†usertests</p><p>æœ€åæ˜¯vaå¤§äºMAXVAè¿”å›çš„ä½ç½®ï¼Œè®°å¾—è¦æ”¾åˆ°walkå‰ï¼Œä¸ç„¶æœ€åä¼šçˆ†é‡Šæ”¾çš„é¡µæ•°å¯¹ä¸ä¸Šçš„é—®é¢˜</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> (va &gt;= MAXVA) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>  &#125;<br></code></pre></td></tr></table></figure><p>å·®ä¸€ä¸ªpageå¯¹ä¸ä¸Šï¼Œæ”¹è¿™é‡Œã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span><br><span class="hljs-title function_">freerange</span><span class="hljs-params">(<span class="hljs-type">void</span> *pa_start, <span class="hljs-type">void</span> *pa_end)</span><br>&#123;<br>  <span class="hljs-type">char</span> *p;<br>  p = (<span class="hljs-type">char</span>*)PGROUNDUP((uint64)pa_start);<br>  <span class="hljs-keyword">for</span>(; p + PGSIZE &lt;= (<span class="hljs-type">char</span>*)pa_end; p += PGSIZE)&#123;<br>      COW_COUNT[((uint64)p)/<span class="hljs-number">4096</span>] = <span class="hljs-number">1</span>;    <br>      kfree(p);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230911111329196.png"></p><h2 id="lab7-Multithreading"><a href="#lab7-Multithreading" class="headerlink" title="lab7 Multithreading"></a>lab7 Multithreading</h2><p><strong>ä»£ç ä»“åº“åœ°å€ï¼š</strong><a href="https://github.com/MadFrey/xv6">MadFrey&#x2F;xv6 (github.com)</a></p><blockquote><p>This lab will familiarize you with multithreading. You will implement switching between threads in a user-level threads package, use multiple threads to speed up a program, and implement a barrier.</p></blockquote><p>çº¿ç¨‹ç›¸å…³çš„ä¸¤èŠ‚è¯¾çœ‹çš„æˆ‘æœ‰ç‚¹å¿ƒç´¯ï¼Œä¹Ÿè®¸æ˜¯è¿™ä¸¤å¤©çŠ¶æ€æ²¡æœ‰è°ƒæ•´å¥½ï¼Œè¿˜æ˜¯è¯´è¯¾ç¨‹æœ¬æ¥å°±æ¯”è¾ƒæŠ½è±¡ï¼Ÿï¼ˆåº”è¯¥æ˜¯è‡ªå·±çš„åŸå› å§ï¼Œç¡®å®æ„Ÿè§‰è¿™ä¸¤å¤©å¾ˆç´¯ï¼‰</p><h3 id="Uthread-switching-between-threads-moderate"><a href="#Uthread-switching-between-threads-moderate" class="headerlink" title="Uthread: switching between threads (moderate)"></a>Uthread: switching between threads (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">moderate</a>)</h3><blockquote><p>Your job is to come up with a plan to create threads and save&#x2F;restore registers to switch between threads, and implement that plan. When youâ€™re done, <code>make grade</code> should say that your solution passes the <code>uthread</code> test.</p></blockquote><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230912212557518.png"></p><h3 id="Using-threads-moderate"><a href="#Using-threads-moderate" class="headerlink" title="Using threads (moderate)"></a>Using threads (moderate)</h3><blockquote><p>Why are there missing keys with 2 threads, but not with 1 thread? Identify a sequence of events with 2 threads that can lead to a key being missing. Submit your sequence with a short explanation in answers-thread.txt</p><p>To avoid this sequence of events, insert lock and unlock statements in <code>put</code> and <code>get</code> in <code>notxv6/ph.c</code> so that the number of keys missing is always 0 with two threads. The relevant pthread calls are:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">pthread_mutex_t <span class="hljs-keyword">lock</span>;            // <span class="hljs-keyword">declare</span> a <span class="hljs-keyword">lock</span><br>pthread_mutex_init(&amp;<span class="hljs-keyword">lock</span>, <span class="hljs-keyword">NULL</span>); // initialize the <span class="hljs-keyword">lock</span><br>pthread_mutex_lock(&amp;<span class="hljs-keyword">lock</span>);       // acquire <span class="hljs-keyword">lock</span><br>pthread_mutex_lock(&amp;<span class="hljs-keyword">lock</span>);       // <span class="hljs-keyword">release</span> <span class="hljs-keyword">lock</span><br></code></pre></td></tr></table></figure><p>Youâ€™re done when <code>make grade</code> says that your code passes the <code>ph_safe</code> test, which requires zero missing keys with two threads. Itâ€™s OK at this point to fail the <code>ph_fast</code> test.</p></blockquote><p>è¿™é‡Œæ˜¯å¹¶å‘ä¸å®‰å…¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæµ‹è¯•åœ¨è¿™é‡ŒåŠ é”</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">static</span> <span class="hljs-type">void</span> *<br><span class="hljs-title function_">put_thread</span><span class="hljs-params">(<span class="hljs-type">void</span> *xa)</span><br>&#123;<br>  <span class="hljs-type">int</span> n = (<span class="hljs-type">int</span>) (<span class="hljs-type">long</span>) xa; <span class="hljs-comment">// thread number</span><br>  <span class="hljs-type">int</span> b = NKEYS/nthread;<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; b; i++) &#123;<br>pthread_mutex_lock(&amp;lock);     <span class="hljs-comment">//here</span><br>    put(keys[b*n + i], n);<br>pthread_mutex_lock(&amp;lock);  <span class="hljs-comment">//here</span><br>  &#125;<br><br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ˜¯å¯ä»¥é€šè¿‡å®‰å…¨æµ‹è¯•çš„ï¼Œä½†æ˜¯é€Ÿåº¦ä¸Šæ…¢å¾—å¤šï¼ŒåŸå› æ˜¯æˆ‘ä»¬åŠ é”ç²’åº¦å¤ªå¤§äº†ï¼Œæˆ‘ä»¬ä¸€æ¬¡æŠŠæ•´ä¸ªå“ˆå¸Œè¡¨éƒ½é”ä½äº†</p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å»é™ä½é”çš„ç²’åº¦ï¼Œé”ä½æ¯ä¸€ä¸ªæ¡¶ï¼Œè€Œä¸æ˜¯æ•´ä¸ªè¡¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs c"><br><span class="hljs-type">static</span> <br><span class="hljs-type">void</span> <span class="hljs-title function_">put</span><span class="hljs-params">(<span class="hljs-type">int</span> key, <span class="hljs-type">int</span> value)</span><br>&#123;<br>  <span class="hljs-type">int</span> i = key % NBUCKET;<br>    pthread_mutex_lock(&amp;lock[i]);<br>  <span class="hljs-comment">// is the key already present?</span><br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">entry</span> *<span class="hljs-title">e</span> =</span> <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> (e = table[i]; e != <span class="hljs-number">0</span>; e = e-&gt;next) &#123;<br>    <span class="hljs-keyword">if</span> (e-&gt;key == key)<br>      <span class="hljs-keyword">break</span>;<br>  &#125;<br>  <span class="hljs-keyword">if</span>(e)&#123;<br>    <span class="hljs-comment">// update the existing key.</span><br>    e-&gt;value = value;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// the new is new.</span><br>    insert(key, value, &amp;table[i], table[i]);<br>  &#125;<br>    pthread_mutex_unlock(&amp;lock[i]);<br>&#125;<br><br><span class="hljs-type">static</span> <span class="hljs-keyword">struct</span> entry*<br><span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> key)</span><br>&#123;<br>  <span class="hljs-type">int</span> i = key % NBUCKET;<br>    pthread_mutex_lock(&amp;lock[i]);<br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">entry</span> *<span class="hljs-title">e</span> =</span> <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> (e = table[i]; e != <span class="hljs-number">0</span>; e = e-&gt;next) &#123;<br>    <span class="hljs-keyword">if</span> (e-&gt;key == key) <span class="hljs-keyword">break</span>;<br>  &#125;<br>    pthread_mutex_unlock(&amp;lock[i]);<br>  <span class="hljs-keyword">return</span> e;<br>&#125;<br><br><span class="hljs-type">static</span> <span class="hljs-type">void</span> *<br><span class="hljs-title function_">put_thread</span><span class="hljs-params">(<span class="hljs-type">void</span> *xa)</span><br>&#123;<br>  <span class="hljs-type">int</span> n = (<span class="hljs-type">int</span>) (<span class="hljs-type">long</span>) xa; <span class="hljs-comment">// thread number</span><br>  <span class="hljs-type">int</span> b = NKEYS/nthread;<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; b; i++) &#123;<br><br>    put(keys[b*n + i], n);<br><br>  &#125;<br><br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>&#125;<br><br><span class="hljs-type">int</span><br><span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[])</span><br>&#123;<br>  <span class="hljs-type">pthread_t</span> *tha;<br>  <span class="hljs-type">void</span> *value;<br>  <span class="hljs-type">double</span> t1, t0;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;NBUCKET;i++) &#123;<br>        pthread_mutex_init(&amp;lock[i],<span class="hljs-literal">NULL</span>);<br>    &#125;<br>  <span class="hljs-keyword">if</span> (argc &lt; <span class="hljs-number">2</span>) &#123;<br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">&quot;Usage: %s nthreads\n&quot;</span>, argv[<span class="hljs-number">0</span>]);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">-1</span>);<br>  &#125;<br>  nthread = atoi(argv[<span class="hljs-number">1</span>]);<br>  tha = <span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">pthread_t</span>) * nthread);<br>  srandom(<span class="hljs-number">0</span>);<br>  assert(NKEYS % nthread == <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; NKEYS; i++) &#123;<br>    keys[i] = random();<br>  &#125;<br><br>  <span class="hljs-comment">//</span><br>  <span class="hljs-comment">// first the puts</span><br>  <span class="hljs-comment">//</span><br>  t0 = now();<br>  <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nthread; i++) &#123;<br>    assert(pthread_create(&amp;tha[i], <span class="hljs-literal">NULL</span>, put_thread, (<span class="hljs-type">void</span> *) (<span class="hljs-type">long</span>) i) == <span class="hljs-number">0</span>);<br>  &#125;<br>  <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nthread; i++) &#123;<br>    assert(pthread_join(tha[i], &amp;value) == <span class="hljs-number">0</span>);<br>  &#125;<br>  t1 = now();<br><br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d puts, %.3f seconds, %.0f puts/second\n&quot;</span>,<br>         NKEYS, t1 - t0, NKEYS / (t1 - t0));<br><br>  <span class="hljs-comment">//</span><br>  <span class="hljs-comment">// now the gets</span><br>  <span class="hljs-comment">//</span><br>  t0 = now();<br>  <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nthread; i++) &#123;<br>    assert(pthread_create(&amp;tha[i], <span class="hljs-literal">NULL</span>, get_thread, (<span class="hljs-type">void</span> *) (<span class="hljs-type">long</span>) i) == <span class="hljs-number">0</span>);<br>  &#125;<br>  <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nthread; i++) &#123;<br>    assert(pthread_join(tha[i], &amp;value) == <span class="hljs-number">0</span>);<br>  &#125;<br>  t1 = now();<br><br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d gets, %.3f seconds, %.0f gets/second\n&quot;</span>,<br>         NKEYS*nthread, t1 - t0, (NKEYS*nthread) / (t1 - t0));<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="Barrier-moderate"><a href="#Barrier-moderate" class="headerlink" title="Barrier(moderate)"></a>Barrier(moderate)</h3><blockquote><p>Your goal is to achieve the desired barrier behavior. In addition to the lock primitives that you have seen in the <code>ph</code> assignment, you will need the following new pthread primitives; look <a href="https://pubs.opengroup.org/onlinepubs/007908799/xsh/pthread_cond_wait.html">here</a> and <a href="https://pubs.opengroup.org/onlinepubs/007908799/xsh/pthread_cond_broadcast.html">here</a> for details.</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">pthread<span class="hljs-constructor">_cond_wait(&amp;<span class="hljs-params">cond</span>, &amp;<span class="hljs-params">mutex</span>)</span>;  <span class="hljs-comment">// go to sleep on cond, releasing lock mutex, acquiring upon wake up</span><br>pthread<span class="hljs-constructor">_cond_broadcast(&amp;<span class="hljs-params">cond</span>)</span>;     <span class="hljs-comment">// wake up every thread sleeping on cond</span><br></code></pre></td></tr></table></figure><p>Make sure your solution passes <code>make grade</code>â€˜s <code>barrier</code> test.</p></blockquote><p>è·Ÿç€ä»–çš„æç¤ºæ¥å°±è¡Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">static</span> <span class="hljs-type">void</span> <br><span class="hljs-title function_">barrier</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-comment">// YOUR CODE HERE</span><br>  <span class="hljs-comment">//</span><br>  <span class="hljs-comment">// Block until all threads have called barrier() and</span><br>  <span class="hljs-comment">// then increment bstate.round.</span><br>  <span class="hljs-comment">//</span><br>    pthread_mutex_lock(&amp;bstate.barrier_mutex);<br>    bstate.nthread++;<br>    <span class="hljs-keyword">if</span>(bstate.nthread&lt;nthread)&#123;<br>        pthread_cond_wait(&amp;bstate.barrier_cond, &amp;bstate.barrier_mutex);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        bstate.nthread=<span class="hljs-number">0</span>;<br>        bstate.round++;<br>        pthread_cond_broadcast(&amp;bstate.barrier_cond);<br>    &#125;<br>    pthread_mutex_unlock(&amp;bstate.barrier_mutex);<br><br>  <br>&#125;<br></code></pre></td></tr></table></figure><p>æ€ä¹ˆè¯´å‘¢ï¼Œè¿™æ¬¡çš„å®éªŒè¿˜æ˜¯æŒºç®€å•çš„ï¼Œå…¨ç¨‹3ä¸ªå°æ—¶å¤š</p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/20230917103802.png"></p><h2 id="Lab8-locks"><a href="#Lab8-locks" class="headerlink" title="Lab8: locks"></a>Lab8: locks</h2><p><strong>ä»£ç ä»“åº“åœ°å€ï¼š</strong><a href="https://github.com/MadFrey/xv6">MadFrey&#x2F;xv6 (github.com)</a></p><blockquote><p>In this lab youâ€™ll gain experience in re-designing code to increase parallelism. A common symptom of poor parallelism on multi-core machines is high lock contention. Improving parallelism often involves changing both data structures and locking strategies in order to reduce contention. Youâ€™ll do this for the xv6 memory allocator and block cache.</p></blockquote><h3 id="Memory-allocator-moderate"><a href="#Memory-allocator-moderate" class="headerlink" title="Memory allocator (moderate)"></a>Memory allocator (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">moderate</a>)</h3><blockquote><p>Your job is to implement per-CPU freelists, and stealing when a CPUâ€™s free list is empty. You must give all of your locks names that start with â€œkmemâ€. That is, you should call <code>initlock</code> for each of your locks, and pass a name that starts with â€œkmemâ€. Run kalloctest to see if your implementation has reduced lock contention. To check that it can still allocate all of memory, run <code>usertests sbrkmuch</code>. Your output will look similar to that shown below, with much-reduced contention in total on kmem locks, although the specific numbers will differ. Make sure all tests in <code>usertests</code> pass. <code>make grade</code> should say that the kalloctests pass.</p></blockquote><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/20230917104314.png"></p><h3 id="Buffer-cache-hard"><a href="#Buffer-cache-hard" class="headerlink" title="Buffer cache (hard)"></a>Buffer cache (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">hard</a>)</h3><blockquote><p>Modify the block cache so that the number of <code>acquire</code> loop iterations for all locks in the bcache is close to zero when running <code>bcachetest</code>. Ideally the sum of the counts for all locks involved in the block cache should be zero, but itâ€™s OK if the sum is less than 500. Modify <code>bget</code> and <code>brelse</code> so that concurrent lookups and releases for different blocks that are in the bcache are unlikely to conflict on locks (e.g., donâ€™t all have to wait for <code>bcache.lock</code>). You must maintain the invariant that at most one copy of each block is cached. When you are done, your output should be similar to that shown below (though not identical). Make sure usertests still passes. <code>make grade</code> should pass all tests when you are done.</p></blockquote><p>é”ç«äº‰ä¼˜åŒ–ä¸€èˆ¬æœ‰å‡ ä¸ªæ€è·¯ï¼š</p><ul><li>åªåœ¨å¿…é¡»å…±äº«çš„æ—¶å€™å…±äº«ï¼ˆå¯¹åº”ä¸ºå°†èµ„æºä» CPU å…±äº«æ‹†åˆ†ä¸ºæ¯ä¸ª CPU ç‹¬ç«‹ï¼‰</li><li>å¿…é¡»å…±äº«æ—¶ï¼Œå°½é‡å‡å°‘åœ¨å…³é”®åŒºä¸­åœç•™çš„æ—¶é—´ï¼ˆå¯¹åº”â€œå¤§é”åŒ–å°é”â€ï¼Œé™ä½é”çš„ç²’åº¦ï¼‰</li></ul><p>æ„Ÿè§‰æŒºæœ‰ç”¨çš„</p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230913225009710.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">usertests</span><br>usertests starting<br>test manywrites: OK<br>test execout: OK<br>test copyin: OK<br>test copyout: OK<br>test copyinstr1: OK<br>test copyinstr2: OK<br>test copyinstr3: OK<br>test rwsbrk: OK<br>test truncate1: OK<br>test truncate2: OK<br>test truncate3: OK<br>test reparent2: OK<br>test pgbug: OK<br>test sbrkbugs: usertrap(): unexpected scause 0x000000000000000c pid=3243<br>            sepc=0x00000000000056a4 stval=0x00000000000056a4<br>usertrap(): unexpected scause 0x000000000000000c pid=3244<br>            sepc=0x00000000000056a4 stval=0x00000000000056a4<br>OK<br>test badarg: OK<br>test reparent: OK<br>test twochildren: OK<br>test forkfork: OK<br>test forkforkfork: OK<br>test argptest: OK<br>test createdelete: OK<br>test linkunlink: OK<br>test linktest: OK<br>test unlinkread: OK<br>test concreate: OK<br>test subdir: OK<br>test fourfiles: OK<br>test sharedfd: OK<br>test dirtest: OK<br>test exectest: OK<br>test bigargtest: OK<br>test bigwrite: OK<br>test bsstest: OK<br>test sbrkbasic: OK<br>test sbrkmuch: OK<br>test kernmem: usertrap(): unexpected scause 0x000000000000000d pid=6224<br>            sepc=0x000000000000215c stval=0x0000000080000000<br>usertrap(): unexpected scause 0x000000000000000d pid=6225<br>            sepc=0x000000000000215c stval=0x000000008000c350<br>usertrap(): unexpected scause 0x000000000000000d pid=6226<br>            sepc=0x000000000000215c stval=0x00000000800186a0<br>usertrap(): unexpected scause 0x000000000000000d pid=6227<br>            sepc=0x000000000000215c stval=0x00000000800249f0<br>usertrap(): unexpected scause 0x000000000000000d pid=6228<br>            sepc=0x000000000000215c stval=0x0000000080030d40<br>usertrap(): unexpected scause 0x000000000000000d pid=6229<br>            sepc=0x000000000000215c stval=0x000000008003d090<br>usertrap(): unexpected scause 0x000000000000000d pid=6230<br>            sepc=0x000000000000215c stval=0x00000000800493e0<br>usertrap(): unexpected scause 0x000000000000000d pid=6231<br>            sepc=0x000000000000215c stval=0x0000000080055730<br>usertrap(): unexpected scause 0x000000000000000d pid=6232<br>            sepc=0x000000000000215c stval=0x0000000080061a80<br>usertrap(): unexpected scause 0x000000000000000d pid=6233<br>            sepc=0x000000000000215c stval=0x000000008006ddd0<br>usertrap(): unexpected scause 0x000000000000000d pid=6234<br>            sepc=0x000000000000215c stval=0x000000008007a120<br>usertrap(): unexpected scause 0x000000000000000d pid=6235<br>            sepc=0x000000000000215c stval=0x0000000080086470<br>usertrap(): unexpected scause 0x000000000000000d pid=6236<br>            sepc=0x000000000000215c stval=0x00000000800927c0<br>usertrap(): unexpected scause 0x000000000000000d pid=6237<br>            sepc=0x000000000000215c stval=0x000000008009eb10<br>usertrap(): unexpected scause 0x000000000000000d pid=6238<br>            sepc=0x000000000000215c stval=0x00000000800aae60<br>usertrap(): unexpected scause 0x000000000000000d pid=6239<br>            sepc=0x000000000000215c stval=0x00000000800b71b0<br>usertrap(): unexpected scause 0x000000000000000d pid=6240<br>            sepc=0x000000000000215c stval=0x00000000800c3500<br>usertrap(): unexpected scause 0x000000000000000d pid=6241<br>            sepc=0x000000000000215c stval=0x00000000800cf850<br>usertrap(): unexpected scause 0x000000000000000d pid=6242<br>            sepc=0x000000000000215c stval=0x00000000800dbba0<br>usertrap(): unexpected scause 0x000000000000000d pid=6243<br>            sepc=0x000000000000215c stval=0x00000000800e7ef0<br>usertrap(): unexpected scause 0x000000000000000d pid=6244<br>            sepc=0x000000000000215c stval=0x00000000800f4240<br>usertrap(): unexpected scause 0x000000000000000d pid=6245<br>            sepc=0x000000000000215c stval=0x0000000080100590<br>usertrap(): unexpected scause 0x000000000000000d pid=6246<br>            sepc=0x000000000000215c stval=0x000000008010c8e0<br>usertrap(): unexpected scause 0x000000000000000d pid=6247<br>            sepc=0x000000000000215c stval=0x0000000080118c30<br>usertrap(): unexpected scause 0x000000000000000d pid=6248<br>            sepc=0x000000000000215c stval=0x0000000080124f80<br>usertrap(): unexpected scause 0x000000000000000d pid=6249<br>            sepc=0x000000000000215c stval=0x00000000801312d0<br>usertrap(): unexpected scause 0x000000000000000d pid=6250<br>            sepc=0x000000000000215c stval=0x000000008013d620<br>usertrap(): unexpected scause 0x000000000000000d pid=6251<br>            sepc=0x000000000000215c stval=0x0000000080149970<br>usertrap(): unexpected scause 0x000000000000000d pid=6252<br>            sepc=0x000000000000215c stval=0x0000000080155cc0<br>usertrap(): unexpected scause 0x000000000000000d pid=6253<br>            sepc=0x000000000000215c stval=0x0000000080162010<br>usertrap(): unexpected scause 0x000000000000000d pid=6254<br>            sepc=0x000000000000215c stval=0x000000008016e360<br>usertrap(): unexpected scause 0x000000000000000d pid=6255<br>            sepc=0x000000000000215c stval=0x000000008017a6b0<br>usertrap(): unexpected scause 0x000000000000000d pid=6256<br>            sepc=0x000000000000215c stval=0x0000000080186a00<br>usertrap(): unexpected scause 0x000000000000000d pid=6257<br>            sepc=0x000000000000215c stval=0x0000000080192d50<br>usertrap(): unexpected scause 0x000000000000000d pid=6258<br>            sepc=0x000000000000215c stval=0x000000008019f0a0<br>usertrap(): unexpected scause 0x000000000000000d pid=6259<br>            sepc=0x000000000000215c stval=0x00000000801ab3f0<br>usertrap(): unexpected scause 0x000000000000000d pid=6260<br>            sepc=0x000000000000215c stval=0x00000000801b7740<br>usertrap(): unexpected scause 0x000000000000000d pid=6261<br>            sepc=0x000000000000215c stval=0x00000000801c3a90<br>usertrap(): unexpected scause 0x000000000000000d pid=6262<br>            sepc=0x000000000000215c stval=0x00000000801cfde0<br>usertrap(): unexpected scause 0x000000000000000d pid=6263<br>            sepc=0x000000000000215c stval=0x00000000801dc130<br>OK<br>test sbrkfail: usertrap(): unexpected scause 0x000000000000000d pid=6275<br>            sepc=0x00000000000041fc stval=0x0000000000012000<br>OK<br>test sbrkarg: OK<br>test validatetest: OK<br>test stacktest: usertrap(): unexpected scause 0x000000000000000d pid=6279<br>            sepc=0x00000000000022cc stval=0x000000000000fb90<br>OK<br>test opentest: OK<br>test writetest: OK<br>test writebig: OK<br>test createtest: OK<br>test openiput: OK<br>test exitiput: OK<br>test iput: OK<br>test mem: OK<br>test pipe1: OK<br>test preempt: kill... wait... OK<br>test exitwait: OK<br>test rmdot: OK<br>test fourteen: OK<br>test bigfile: OK<br>test dirfile: OK<br>test iref: OK<br>test forktest: OK<br>test bigdir: OK<br>ALL TESTS PASSED<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸ªå‘ç‚¹æŠ˜è…¾äº†å¾ˆä¹…</p><p>å¦‚æœä½ make qemuåä¸make cleanï¼Œé‚£ä¹ˆä½ ä¼šå‘ç°ä½ åœ¨xv6ç»ˆç«¯é‡Œå¯ä»¥é€šè¿‡bcachetestï¼Œä½†æ˜¯é€€å‡ºåmake grade ä¼šæŠ¥é”™</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">== Test   bcachetest: test0 == <br>  bcachetest: test0: FAIL <br>    ...<br>         tot= 3280<br>         test0: FAIL<br>         start test1<br>         test1 OK<br>         $ qemu-system-riscv64: terminating on signal 15 from pid 9889 (make)<br>    MISSING &#x27;^test0: OK$&#x27;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥make gradeçš„æ—¶å€™è®°å¾—å…ˆmake clean QAQ</p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230914090136982.png"></p><h2 id="Lab9-file-system"><a href="#Lab9-file-system" class="headerlink" title="Lab9: file system"></a>Lab9: file system</h2><p>ï¼ˆä»æ­¤é¢˜å¼€å§‹æŒç»­ä¼˜åŒ–blogçš„åˆ›ä½œæµï¼Œç›®å‰è¿˜æ²¡æœ‰å½¢æˆä¸€ä¸ªå±äºè‡ªå·±çš„åˆ›ä½œä½“ç³»ï¼‰</p><p><strong>ä»£ç ä»“åº“åœ°å€ï¼š</strong><a href="https://github.com/MadFrey/xv6">MadFrey&#x2F;xv6 (github.com)</a></p><blockquote><p>Before writing code, you should read â€œChapter 8: File systemâ€ from the <a href="https://pdos.csail.mit.edu/6.S081/2020/xv6/book-riscv-rev1.pdf">xv6 book</a> and study the corresponding code.</p></blockquote><h3 id="Large-files-moderate"><a href="#Large-files-moderate" class="headerlink" title="Large files (moderate)"></a>Large files (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">moderate</a>)</h3><blockquote><p>Modify <code>bmap()</code> so that it implements a doubly-indirect block, in addition to direct blocks and a singly-indirect block. Youâ€™ll have to have only 11 direct blocks, rather than 12, to make room for your new doubly-indirect block; youâ€™re not allowed to change the size of an on-disk inode. The first 11 elements of <code>ip-&gt;addrs[]</code> should be direct blocks; the 12th should be a singly-indirect block (just like the current one); the 13th should be your new doubly-indirect block. You are done with this exercise when <code>bigfile</code> writes 65803 blocks and <code>usertests</code> runs successfully:</p></blockquote><p>ç¬¬ä¸€ä¸ªè¦ä½ å®ç°äºŒçº§é“¾æ¥å—ï¼Œæˆ‘ä¸€å¼€å§‹æ²¡ç†è§£åˆ°é¢˜ç›®æ„æ€ï¼Œç†è§£äº†äºŒçº§é“¾æ¥å—çš„æ¦‚å¿µåï¼Œè¿™é¢˜å°±å¾ˆå¿«äº†</p><p>ä»–æ˜¯æ¯ä¸€ä¸ªbnå¯¹åº”ä¸€ä¸ªå—</p><p>ä¹Ÿå°±æ˜¯è¯´å¦‚æœæ˜¯ç›´æ¥å—ï¼Œé‚£ä¹ˆä¹…å¯ä»¥ç›´æ¥è¯»å– 0â€“10å—</p><p>å¦‚æœæ˜¯é—´æ¥å—ï¼Œä¸€çº§é—´æ¥å—åœ¨11å—</p><p>äºŒçº§é—´æ¥å—åœ¨12å—</p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230915074742194.png"></p><p>å¯¹äº1çº§é—´æ¥å—ï¼Œä»£ç ä¸­å·²ç»ç»™å‡º</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//å¦‚æœå¤§äºç­‰äº11ï¼Œè¯´æ˜æ˜¯ä¸€çº§é—´æ¥å—</span><br>   bn -= NDIRECT;<br>   <span class="hljs-keyword">if</span> (bn &lt; NINDIRECT) &#123;<br>       <span class="hljs-comment">// Load indirect block, allocating if necessary.</span><br>       <span class="hljs-keyword">if</span> ((addr = ip-&gt;addrs[NDIRECT]) == <span class="hljs-number">0</span>)<br>           ip-&gt;addrs[NDIRECT] = addr = balloc(ip-&gt;dev);<br>       bp = bread(ip-&gt;dev, addr);   <span class="hljs-comment">//æ–‡ä»¶è½½å…¥</span><br>       a = (uint *) bp-&gt;data;<br>       <span class="hljs-keyword">if</span> ((addr = a[bn]) == <span class="hljs-number">0</span>) &#123;<br>           a[bn] = addr = balloc(ip-&gt;dev);<br>           log_write(bp);<br>       &#125;<br>       brelse(bp);<br>       <span class="hljs-keyword">return</span> addr;<br>   &#125;<br></code></pre></td></tr></table></figure><p>äºŒçº§é—´æ¥å— ï¼Œä¹‹å‰çœ‹åˆ°ä¸€ä¸ªcsdnè®²äºŒçº§é“¾æ¥å—æ¦‚å¿µçš„blogï¼Œé‡Œé¢æœ‰ç« å›¾å¾ˆå½¢è±¡ï¼Œä½†æ²¡æ‰¾åˆ°ï¼Œè¿™è¾¹å°±æ‰‹åŠ¨ç»˜åˆ¶ä¸€ä¸‹ï¼ˆæœ‰ç‚¹ä¸‘ï¼Œè§è°…QAQï¼‰</p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230915075928178.png"></p><p>ç”±å›¾å¯çŸ¥ï¼Œæˆ‘ä»¬éœ€è¦å…ˆä»å—ç¼“å­˜ä¸­è½½å…¥ä¸€çº§ç´¢å¼•è¡¨ï¼Œç”¨bn&#x2F;NINDIRECTæ‰¾åˆ°æ‰€åœ¨çš„äºŒçº§ç´¢å¼•è¡¨çš„indexï¼Œæœ€åè½½å…¥å¯¹åº”çš„äºŒçº§ç´¢å¼•è¡¨ï¼Œæ ¹æ®bn%NINDIRECT,å¯ä»¥ç¡®å®šå®é™…å—çš„ä½ç½®ï¼Œæ€»ä¹‹ç†è§£åˆ°äº†çš„è¯å°±æ˜¯å¤åˆ¶ç²˜è´´ä¸€çº§ç´¢å¼•å—çš„å¤„ç†æ–¹å¼ï¼Œè®©ä»–å¤šè½½å…¥å‡ æ¬¡</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">static</span> uint<br><span class="hljs-title function_">bmap</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> inode *ip, uint bn)</span> &#123;<br>    uint addr, *a;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">buf</span> *<span class="hljs-title">bp</span>;</span><br><br>    <span class="hljs-keyword">if</span> (bn &lt; NDIRECT) &#123;  <span class="hljs-comment">// å¦‚æœbnæ˜¯å°äº11çš„ï¼Œ å¤„ç†ç›´æ¥å—</span><br>        <span class="hljs-keyword">if</span> ((addr = ip-&gt;addrs[bn]) == <span class="hljs-number">0</span>)<br>            ip-&gt;addrs[bn] = addr = balloc(ip-&gt;dev);<br>        <span class="hljs-keyword">return</span> addr;<br>    &#125;<br>    <span class="hljs-comment">//å¦‚æœå¤§äºç­‰äº11ï¼Œè¯´æ˜æ˜¯ä¸€çº§é—´æ¥å—</span><br>    bn -= NDIRECT;<br>    <span class="hljs-keyword">if</span> (bn &lt; NINDIRECT) &#123;<br>        <span class="hljs-comment">// Load indirect block, allocating if necessary.</span><br>        <span class="hljs-keyword">if</span> ((addr = ip-&gt;addrs[NDIRECT]) == <span class="hljs-number">0</span>)<br>            ip-&gt;addrs[NDIRECT] = addr = balloc(ip-&gt;dev);<br>        bp = bread(ip-&gt;dev, addr);   <span class="hljs-comment">//æ–‡ä»¶è½½å…¥</span><br>        a = (uint *) bp-&gt;data;<br>        <span class="hljs-keyword">if</span> ((addr = a[bn]) == <span class="hljs-number">0</span>) &#123;<br>            a[bn] = addr = balloc(ip-&gt;dev);<br>            log_write(bp);<br>        &#125;<br>        brelse(bp);<br>        <span class="hljs-keyword">return</span> addr;<br>    &#125;<br>    bn -= NINDIRECT;     <span class="hljs-comment">//å‰ªå‰11å—ï¼Œå’Œä¸€çº§é—´æ¥åœ°å€çš„256å—å‡æ‰ï¼Œå°±æ˜¯2çº§é—´æ¥å—çš„åœ°å€</span><br><br>    <span class="hljs-keyword">if</span> (bn &lt; NINDIRECT * NINDIRECT) &#123;<br>        <span class="hljs-comment">// Load indirect block, allocating if necessary.</span><br>        <span class="hljs-keyword">if</span> ((addr = ip-&gt;addrs[NDIRECT + <span class="hljs-number">1</span>]) == <span class="hljs-number">0</span>)<br>            ip-&gt;addrs[NDIRECT + <span class="hljs-number">1</span>] = addr = balloc(ip-&gt;dev);<br>        bp = bread(ip-&gt;dev, addr);   <span class="hljs-comment">//æ–‡ä»¶è½½å…¥   256ä¸ª2çº§ç´¢å¼•è¡¨è½½å…¥</span><br>        a = (uint *) bp-&gt;data;<br>        <span class="hljs-keyword">if</span> ((addr = a[bn / NINDIRECT]) == <span class="hljs-number">0</span>) &#123;   <span class="hljs-comment">//æœ€ç»ˆæŒ‡å‘çš„ç´¢å¼•å—è½½å…¥</span><br>            a[bn / NINDIRECT] = addr = balloc(ip-&gt;dev);<br>            log_write(bp);<br>        &#125;<br>        brelse(bp);<br>        <span class="hljs-comment">//å—ä¸­å¯¹åº”çš„åœ°å€è½½å…¥</span><br>        <span class="hljs-type">int</span> index = bn % NINDIRECT; <span class="hljs-comment">//ç¡®å®šåœ¨å—ä¸­çš„ä½ç½®</span><br>        bp = bread(ip-&gt;dev, addr);   <span class="hljs-comment">//æ–‡ä»¶è½½å…¥   256ä¸ª2çº§ç´¢å¼•è¡¨è½½å…¥</span><br>        a = (uint *) bp-&gt;data;<br>        <span class="hljs-keyword">if</span> ((addr = a[index]) == <span class="hljs-number">0</span>) &#123;<br>            a[index] = addr = balloc(ip-&gt;dev);<br>            log_write(bp);<br>        &#125;<br>        brelse(bp);<br>        <span class="hljs-keyword">return</span> addr;<br>    &#125;<br><br>    panic(<span class="hljs-string">&quot;bmap: out of range&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>ç†è§£åˆ°ä½åï¼Œé‡Šæ”¾ä¹Ÿæ˜¯å·®ä¸å¤šçš„åŸç†ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯å¯ä»¥å¤åˆ¶ç²˜è´´å§</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// Truncate inode (discard contents).</span><br><span class="hljs-comment">// Caller must hold ip-&gt;lock.</span><br><span class="hljs-type">void</span><br><span class="hljs-title function_">itrunc</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> inode *ip)</span> &#123;<br>    <span class="hljs-type">int</span> i, j;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">buf</span> *<span class="hljs-title">bp</span> ,*<span class="hljs-title">bp1</span>;</span><br>    uint *a, *b;<br><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; NDIRECT; i++) &#123;  <span class="hljs-comment">// direct blocks</span><br>        <span class="hljs-keyword">if</span> (ip-&gt;addrs[i]) &#123;<br>            bfree(ip-&gt;dev, ip-&gt;addrs[i]);<br>            ip-&gt;addrs[i] = <span class="hljs-number">0</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (ip-&gt;addrs[NDIRECT]) &#123;   <span class="hljs-comment">//indirect block</span><br>        bp = bread(ip-&gt;dev, ip-&gt;addrs[NDIRECT]);<br>        a = (uint *) bp-&gt;data;<br>        <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; NINDIRECT; j++) &#123;<br>            <span class="hljs-keyword">if</span> (a[j])<br>                bfree(ip-&gt;dev, a[j]);<br>        &#125;<br>        brelse(bp);<br>        bfree(ip-&gt;dev, ip-&gt;addrs[NDIRECT]);<br>        ip-&gt;addrs[NDIRECT] = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (ip-&gt;addrs[NDIRECT + <span class="hljs-number">1</span>]) &#123;   <span class="hljs-comment">// second indirect block</span><br>        bp = bread(ip-&gt;dev, ip-&gt;addrs[NDIRECT + <span class="hljs-number">1</span>]);<br>        a = (uint *) bp-&gt;data;<br>        <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; NINDIRECT; j++) &#123;<br>            <span class="hljs-keyword">if</span>(a[j])&#123;<br>                bp1 = bread(ip-&gt;dev, a[j]);<br>                b = (uint *) bp1-&gt;data;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; NINDIRECT; ++k) &#123;<br>                    <span class="hljs-keyword">if</span> (b[k])<br>                        bfree(ip-&gt;dev, b[k]);<br>                &#125;<br>                brelse(bp1);<br>                bfree(ip-&gt;dev, a[j]);<br>            &#125;<br>        &#125;<br>        brelse(bp);<br>        bfree(ip-&gt;dev, ip-&gt;addrs[NDIRECT + <span class="hljs-number">1</span>]);<br>        ip-&gt;addrs[NDIRECT + <span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>    &#125;<br>    ip-&gt;size = <span class="hljs-number">0</span>;<br>    iupdate(ip);<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230914211707841.png"></p><h3 id="Symbolic-links-moderate"><a href="#Symbolic-links-moderate" class="headerlink" title="Symbolic links (moderate)"></a>Symbolic links (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">moderate</a>)</h3><blockquote><p>You will implement the <code>symlink(char *target, char *path)</code> system call, which creates a new symbolic link at path that refers to file named by target. For further information, see the man page symlink. To test, add symlinktest to the Makefile and run it. Your solution is complete when the tests produce the following output (including usertests succeeding).</p></blockquote><p>è¿™é¢˜æ¯”è¾ƒç®€å•ï¼Œå½“æ—¶ä¹Ÿæ¯”è¾ƒæ™šäº†å¿«11ç‚¹å›¾ä¹¦é¦†é—­é¦†äº†ï¼Œæˆ‘å°±ç›´æ¥çœ‹å¤§ä½¬çš„åšå®¢äº†ï¼Œç†è§£åˆ°äº†æ¦‚å¿µå°±å¾ˆç®€å•</p><p>ç†è§£å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  <a href="https://blog.csdn.net/Csw_PHPer/article/details/106684375">https://blog.csdn.net/Csw_PHPer/article/details/106684375</a></p><p>ä¸ªäººæ„Ÿè§‰æŠŠè½¯é“¾æ¥è®²çš„å¾ˆæ¸…æ¥šäº†</p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230914225252339.png"></p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230915103108823.png"></p><h2 id="Lab10-mmap-hard"><a href="#Lab10-mmap-hard" class="headerlink" title="Lab10: mmap (hard)"></a>Lab10: mmap (<a href="https://pdos.csail.mit.edu/6.S081/2020/labs/guidance.html">hard</a>)</h2><blockquote><p>You should implement enough <code>mmap</code> and <code>munmap</code> functionality to make the <code>mmaptest</code> test program work. If <code>mmaptest</code> doesnâ€™t use a <code>mmap</code> feature, you donâ€™t need to implement that feature.</p></blockquote><p><strong>ä»£ç ä»“åº“åœ°å€ï¼š</strong><a href="https://github.com/MadFrey/xv6">MadFrey&#x2F;xv6 (github.com)</a></p><p>9.17  mit6.s081å°±ç®—æ˜¯æ­£å¼å®Œç»“äº†ï¼Œnetworkè¦çœ‹å¾ˆå¤šæ‰‹å†Œï¼Œè€Œä¸”æˆ‘çœ‹äº†ä¸‹å…¶ä»–åšå®Œäº†çš„åšå®¢ä¹Ÿå¹¶ä¸æ˜¯å¾ˆéš¾ï¼Œè¿™é‡Œå°±å…ˆä¸åšäº†</p><p>ç„¶åmmapè¿˜æ˜¯æœ‰éš¾åº¦çš„ï¼ŒèŠ±äº†æˆ‘å¤§æ¦‚10ä¸ªå°æ—¶å·¦å³çš„æ—¶é—´å§ï¼ˆè™½ç„¶åœ¨å‰ä¸€å¤©èŠ±äº†ä¸€æ™šä¸Šè°ƒbugï¼Œå¤ªèœäº†QAQ)</p><p>å…ˆæ˜¯sys_mmapçš„å®ç°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs c">uint64 <span class="hljs-title function_">sys_mmap</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> &#123;<br>    uint64 addr, sz, offset;<br>    <span class="hljs-type">int</span> prot, flags, fd; <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">file</span> *<span class="hljs-title">f</span>;</span><br>    uint64 end  =  TRAPFRAME;<br>    <span class="hljs-keyword">if</span>(argaddr(<span class="hljs-number">0</span>, &amp;addr) &lt; <span class="hljs-number">0</span> || argaddr(<span class="hljs-number">1</span>, &amp;sz) &lt; <span class="hljs-number">0</span> || argint(<span class="hljs-number">2</span>, &amp;prot) &lt; <span class="hljs-number">0</span><br>       || argint(<span class="hljs-number">3</span>, &amp;flags) &lt; <span class="hljs-number">0</span> || argfd(<span class="hljs-number">4</span>, &amp;fd, &amp;f) &lt; <span class="hljs-number">0</span> || argaddr(<span class="hljs-number">5</span>, &amp;offset) &lt; <span class="hljs-number">0</span> || sz == <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br><br>    <span class="hljs-keyword">if</span>(!f-&gt;writable &amp;&amp; (prot &amp; PROT_WRITE) &amp;&amp; (flags == MAP_SHARED))<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">proc</span> *<span class="hljs-title">p</span> =</span> myproc();<br><br>    <span class="hljs-type">int</span> j = <span class="hljs-number">-1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; VMASIZE; i ++)<br>    &#123;<br>        <span class="hljs-keyword">if</span>(p-&gt;vmas[i].valid == <span class="hljs-number">0</span>)<br>        &#123;<br>            j=i;<br>            p-&gt;vmas[i].valid = <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">break</span>;  <span class="hljs-comment">// important!</span><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            end = PGROUNDDOWN(p-&gt;vmas[i].vastart);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(j == <span class="hljs-number">-1</span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">vma</span>* <span class="hljs-title">v</span> =</span> &amp;p-&gt;vmas[j];<br>    sz = PGROUNDUP(sz);     <span class="hljs-comment">//æ³¨æ„å¯¹é½</span><br><br><br>    v-&gt;vastart = end - sz;<br>    v-&gt;sz = sz;<br>    v-&gt;prot = prot;<br>    v-&gt;flags = flags;<br>    v-&gt;f = f;<br>    v-&gt;offset = offset;<br><br>    filedup(v-&gt;f);<br><br>    <span class="hljs-keyword">return</span> v-&gt;vastart;<br>&#125;<br></code></pre></td></tr></table></figure><p>å‰ä¸€å¤©æ™šä¸Šè°ƒäº†å¾ˆä¹…å°±æ˜¯å› ä¸ºæœ‰äº›ç»†èŠ‚æ²¡å¤„ç†å¥½</p><p>è¿™é‡Œä¸€å®šè¦  end &#x3D; PGROUNDDOWN(p-&gt;vmas[i].vastart)ï¼Œå› ä¸ºtestä¸­æ‰€æœ‰çš„mmapçš„addréƒ½æ˜¯ä»0å¼€å§‹çš„ï¼Œä¸€å®šè¦è®°å¾—æ›´æ–°endï¼Œä¸ç„¶test mmap two files ä¼šè¿‡ä¸å»</p><p>åŠ äº†æ›´æ–°endçš„åˆ†æ”¯åä¸€å®šè¦è®°å¾—åŠ breakï¼Œä¸ç„¶ç¬¬äºŒä¸ªå°±è¿‡ä¸å»äº†ï¼ˆå…¨éƒ¨vmaéƒ½è¢«è®¾ç½®æˆäº†1åœ¨ç¬¬ä¸€ä¸ªæµ‹è¯•ç‚¹ä¸­ï¼‰</p><p>æœ€åä¸è¦å¿˜äº†sz &#x3D; PGROUNDUP(sz); å†…å­˜å¯¹é½</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span>(p-&gt;vmas[i].valid == <span class="hljs-number">0</span>)<br>      &#123;<br>          j=i;<br>          p-&gt;vmas[i].valid = <span class="hljs-number">1</span>;<br>          <span class="hljs-keyword">break</span>;  <span class="hljs-comment">// important!</span><br>      &#125;<span class="hljs-keyword">else</span>&#123;<br>          end = PGROUNDDOWN(p-&gt;vmas[i].vastart);<br>      &#125;<br></code></pre></td></tr></table></figure><p>å› ä¸ºæ˜¯lazy allocationï¼Œæ‰€ä»¥è¦åœ¨usertrapä¸­è¿›è¡Œä¿®æ”¹å¤„ç†page faultï¼Œè¿™ä¸ªå’Œä¹‹å‰åšè¿‡çš„å®éªŒå·®ä¸å¤šï¼Œè¿™é‡Œå°±ä¸å¤šè®²äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span><br><span class="hljs-title function_">usertrap</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>  <span class="hljs-type">int</span> which_dev = <span class="hljs-number">0</span>;<br><br>  <span class="hljs-keyword">if</span>((r_sstatus() &amp; SSTATUS_SPP) != <span class="hljs-number">0</span>)<br>    panic(<span class="hljs-string">&quot;usertrap: not from user mode&quot;</span>);<br><br>  <span class="hljs-comment">// send interrupts and exceptions to kerneltrap(),</span><br>  <span class="hljs-comment">// since we&#x27;re now in the kernel.</span><br>  w_stvec((uint64)kernelvec);<br><br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">proc</span> *<span class="hljs-title">p</span> =</span> myproc();<br>  <br>  <span class="hljs-comment">// save user program counter.</span><br>  p-&gt;trapframe-&gt;epc = r_sepc();<br>  <br>  <span class="hljs-keyword">if</span>(r_scause() == <span class="hljs-number">8</span>)&#123;<br>    <span class="hljs-comment">// system call</span><br><br>    <span class="hljs-keyword">if</span>(p-&gt;killed)<br>      <span class="hljs-built_in">exit</span>(<span class="hljs-number">-1</span>);<br><br>    <span class="hljs-comment">// sepc points to the ecall instruction,</span><br>    <span class="hljs-comment">// but we want to return to the next instruction.</span><br>    p-&gt;trapframe-&gt;epc += <span class="hljs-number">4</span>;<br><br>    <span class="hljs-comment">// an interrupt will change sstatus &amp;c registers,</span><br>    <span class="hljs-comment">// so don&#x27;t enable until done with those registers.</span><br>    intr_on();<br><br>    syscall();<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>((which_dev = devintr()) != <span class="hljs-number">0</span>)&#123;<br>    <span class="hljs-comment">// ok</span><br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">if</span>  (r_scause()==<span class="hljs-number">13</span>||r_scause()==<span class="hljs-number">15</span>)&#123;<br>          uint64 va = r_stval();<br>          <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">vma</span>* <span class="hljs-title">v</span> =</span> <span class="hljs-number">0</span>;<br>          <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; VMASIZE; ++i) &#123;<br>              <span class="hljs-keyword">if</span>(p-&gt;vmas[i].valid == <span class="hljs-number">1</span> &amp;&amp; va &gt;= p-&gt;vmas[i].vastart &amp;&amp; va &lt; p-&gt;vmas[i].vastart + p-&gt;vmas[i].sz) &#123;<br>                 v=&amp;p-&gt;vmas[i];<br>              &#125;<br>          &#125;<br><br>          <span class="hljs-keyword">if</span>(v==<span class="hljs-number">0</span>)&#123;<br>              p-&gt;killed=<span class="hljs-number">1</span>;<br>          &#125;<span class="hljs-keyword">else</span>&#123;<br>              <span class="hljs-type">void</span> *pa = kalloc();<br>              <span class="hljs-keyword">if</span>(pa == <span class="hljs-number">0</span>) &#123;<br>                  panic(<span class="hljs-string">&quot;vmalazytouch: kalloc&quot;</span>);<br>              &#125;<br>              <span class="hljs-built_in">memset</span>(pa, <span class="hljs-number">0</span>, PGSIZE);<br>              begin_op();<br>              ilock(v-&gt;f-&gt;ip);<br>              readi(v-&gt;f-&gt;ip, <span class="hljs-number">0</span>, (uint64)pa, v-&gt;offset + PGROUNDDOWN(va - v-&gt;vastart), PGSIZE);<br>              iunlock(v-&gt;f-&gt;ip);<br>              end_op();<br><br>              <span class="hljs-type">int</span> perm = PTE_U;<br>              <span class="hljs-keyword">if</span>(v-&gt;prot &amp; PROT_READ)<br>                  perm |= PTE_R;<br>              <span class="hljs-keyword">if</span>(v-&gt;prot &amp; PROT_WRITE)<br>                  perm |= PTE_W;<br>              <span class="hljs-keyword">if</span>(v-&gt;prot &amp; PROT_EXEC)<br>                  perm |= PTE_X;<br><br>              <span class="hljs-keyword">if</span>(mappages(p-&gt;pagetable, va, PGSIZE, (uint64)pa, perm) &lt; <span class="hljs-number">0</span>) &#123;<br>                  panic(<span class="hljs-string">&quot;vmalazytouch: mappages&quot;</span>);<br>              &#125;<br><br>          &#125;<br>      &#125;<span class="hljs-keyword">else</span>&#123;<br>          <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;usertrap(): unexpected scause %p pid=%d\n&quot;</span>, r_scause(), p-&gt;pid);<br>          <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;            sepc=%p stval=%p\n&quot;</span>, r_sepc(), r_stval());<br>          p-&gt;killed = <span class="hljs-number">1</span>;<br>      &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">if</span>(p-&gt;killed)<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">-1</span>);<br><br>  <span class="hljs-comment">// give up the CPU if this is a timer interrupt.</span><br>  <span class="hljs-keyword">if</span>(which_dev == <span class="hljs-number">2</span>)<br>    yield();<br><br>  usertrapret();<br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶åæ˜¯munmap ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿ï¼Œå°±ç›´æ¥ä½¿ç”¨é¡µä¸ºå•ä½æ¥è¿›è¡Œè§£é™¤æ˜ å°„ï¼ˆå¯ä»¥ç›´æ¥ä½¿ç”¨uvmmapï¼Œå·ä¸ªæ‡’ï¼‰ï¼Œå¦‚æœszä¸º0äº†è®°å¾—å–æ¶ˆå¼•ç”¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c">uint64 <span class="hljs-title function_">sys_munmap</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> &#123;<br>    uint64 addr, sz;<br><br>    <span class="hljs-keyword">if</span>(argaddr(<span class="hljs-number">0</span>, &amp;addr) &lt; <span class="hljs-number">0</span> || argaddr(<span class="hljs-number">1</span>, &amp;sz) &lt; <span class="hljs-number">0</span> || sz == <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">proc</span> *<span class="hljs-title">p</span> =</span> myproc();<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">vma</span>* <span class="hljs-title">v</span> =</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; VMASIZE; ++i) &#123;<br>        <span class="hljs-keyword">if</span>(p-&gt;vmas[i].valid == <span class="hljs-number">1</span> &amp;&amp; addr &gt;= p-&gt;vmas[i].vastart &amp;&amp; addr &lt; p-&gt;vmas[i].vastart + p-&gt;vmas[i].sz) &#123;<br>            v=&amp;p-&gt;vmas[i];<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(v == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(v-&gt;flags &amp; MAP_SHARED)&#123;<br>        filewrite(v-&gt;f, addr, sz);<br>    &#125;<br><br>    uvmunmap(p-&gt;pagetable, addr, PGROUNDUP(sz) / PGSIZE, <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">if</span>(addr == v-&gt;vastart)&#123;<br>       v-&gt;vastart += PGROUNDUP(sz);<br>    &#125;<br>    v-&gt;sz -= sz;<br>    <span class="hljs-keyword">if</span>(v-&gt;sz == <span class="hljs-number">0</span>)<br>    &#123;<br>        fileclose(v-&gt;f);<br>        <span class="hljs-built_in">memset</span>((<span class="hljs-type">void</span>*)v, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(v));<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>åˆ°æ­¤å°±å·²ç»å¯ä»¥é€šè¿‡mmap_testäº†</p><p>æœ€åå¯¹forkå’Œexitè¿›è¡Œç®€å•ä¿®æ”¹å³å¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span><br><span class="hljs-title function_">fork</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>  <span class="hljs-type">int</span> i, pid;<br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">proc</span> *<span class="hljs-title">np</span>;</span><br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">proc</span> *<span class="hljs-title">p</span> =</span> myproc();<br><br>  <span class="hljs-comment">// Allocate process.</span><br>  <span class="hljs-keyword">if</span>((np = allocproc()) == <span class="hljs-number">0</span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>  &#125;<br><br>  <span class="hljs-comment">// Copy user memory from parent to child.</span><br>  <span class="hljs-keyword">if</span>(uvmcopy(p-&gt;pagetable, np-&gt;pagetable, p-&gt;sz) &lt; <span class="hljs-number">0</span>)&#123;<br>    freeproc(np);<br>    release(&amp;np-&gt;lock);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>  &#125;<br>  np-&gt;sz = p-&gt;sz;<br><br>  np-&gt;parent = p;<br><br>  <span class="hljs-comment">// copy saved user registers.</span><br>  *(np-&gt;trapframe) = *(p-&gt;trapframe);<br><br>  <span class="hljs-comment">// Cause fork to return 0 in the child.</span><br>  np-&gt;trapframe-&gt;a0 = <span class="hljs-number">0</span>;<br><br>  <span class="hljs-comment">// increment reference counts on open file descriptors.</span><br>  <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; NOFILE; i++)<br>    <span class="hljs-keyword">if</span>(p-&gt;ofile[i])<br>      np-&gt;ofile[i] = filedup(p-&gt;ofile[i]);<br>  np-&gt;cwd = idup(p-&gt;cwd);<br><br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; VMASIZE; i++) &#123;<br>        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">vma</span> *<span class="hljs-title">v</span> =</span> &amp;p-&gt;vmas[i];<br>        <span class="hljs-keyword">if</span>(v-&gt;valid) &#123;<br>            np-&gt;vmas[i] = *v;<br>            filedup(v-&gt;f);<br>        &#125;<br>    &#125;<br><br><br>  safestrcpy(np-&gt;name, p-&gt;name, <span class="hljs-keyword">sizeof</span>(p-&gt;name));<br><br>  pid = np-&gt;pid;<br><br>  np-&gt;state = RUNNABLE;<br><br>  release(&amp;np-&gt;lock);<br><br>  <span class="hljs-keyword">return</span> pid;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span><br><span class="hljs-title function_">exit</span><span class="hljs-params">(<span class="hljs-type">int</span> status)</span><br>&#123;<br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">proc</span> *<span class="hljs-title">p</span> =</span> myproc();<br><br>  <span class="hljs-keyword">if</span>(p == initproc)<br>    panic(<span class="hljs-string">&quot;init exiting&quot;</span>);<br><br>  <span class="hljs-comment">// Close all open files.</span><br>  <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> fd = <span class="hljs-number">0</span>; fd &lt; NOFILE; fd++)&#123;<br>    <span class="hljs-keyword">if</span>(p-&gt;ofile[fd])&#123;<br>      <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">file</span> *<span class="hljs-title">f</span> =</span> p-&gt;ofile[fd];<br>      fileclose(f);<br>      p-&gt;ofile[fd] = <span class="hljs-number">0</span>;<br>    &#125;<br>  &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; VMASIZE; i ++)<br>    &#123;<br>        <span class="hljs-keyword">if</span>(p-&gt;vmas[i].valid == <span class="hljs-number">1</span>)<br>        &#123;<br>            uint64 sz = p-&gt;vmas[i].sz;<br>            fileclose(p-&gt;vmas[i].f);<br>            <span class="hljs-comment">// å–æ¶ˆæ˜ å°„</span><br>            uvmunmap(p-&gt;pagetable, p-&gt;vmas[i].vastart, PGROUNDUP(sz) / PGSIZE, <span class="hljs-number">1</span>);<br>            <span class="hljs-comment">// æ¸…ç©ºvma</span><br>            <span class="hljs-built_in">memset</span>((<span class="hljs-type">void</span>*)&amp;p-&gt;vmas[i], <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(p-&gt;vmas[i]));<br><br>        &#125;<br>    &#125;<br><br><br> ......<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨make gradeçš„æ—¶å€™å¯èƒ½ä¼šé‡åˆ°env: python3\r: No such file or directory çš„é—®é¢˜</p><p>vimæ‰“å¼€ lab-mmapè„šæœ¬,è¾“å…¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">:set ff=unix<br>:wq!<br></code></pre></td></tr></table></figure><p>å³å¯è§£å†³é—®é¢˜   <a href="https://code84.com/79.html">env: python3\r</a></p><p>é€šè¿‡æµ‹è¯•å¦‚ä¸‹å›¾</p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230917083149756.png"></p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230917085710821.png"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¤§æ¦‚èŠ±äº†ä¸¤ä¸ªæ˜ŸæœŸå§åšå®Œlab0-lab10 ï¼Œä¸ªäººæ„Ÿè§‰å°è±¡æ·±åˆ»æ˜¯lab3ï¼Œlab8ï¼Œå’Œlab10å§ï¼Œlab8æœ€åä¸€ä¸ªå®éªŒæˆ‘æ˜¯çœ‹ç€å¤§ä½¬çš„åšå®¢æ¥å†™çš„ï¼Œç¡®å®æ°´å¹³è¿˜ä¸å¤Ÿ</p><p>åœ¨è¿™ä¸ªå®éªŒçš„ååŠéƒ¨åˆ†å¼€å§‹æ…¢æ…¢ä¼˜åŒ–æˆ‘çš„blogå†™ä½œï¼Œè¿˜æ˜¯å¸Œæœ›è‡ªå·±çš„blogèƒ½å¤Ÿæœ‰èƒ½å¸®åŠ©å¤§å®¶çš„ä¸œè¥¿ï¼Œæ…¢æ…¢æ¥å§</p><p>ä¸ªäººæ„Ÿè§‰è¿˜æ˜¯å¾ˆæœ‰æ”¶è·çš„ï¼Œä½†æ˜¯æ„Ÿè§‰å¯¹äºå­¦ä¹ osæ¥è¯´è¿˜è¿œè¿œä¸å¤Ÿï¼Œæ¯”å¦‚è¯´ä½œä¸ºæ•™å­¦osçš„xv6ä¸€ä¸ªè¿›ç¨‹åªæœ‰ä¸€ä¸ªçº¿ç¨‹ç­‰ç­‰ï¼Œå¾ˆå¤šåœ°æ–¹éƒ½ç®€åŒ–äº†</p><p>ä½†ä½œä¸ºä¸€é—¨å¯¼è®ºè¯¾æ¥è¯´è¿˜æ˜¯éå¸¸æœ‰å«é‡‘é‡çš„ï¼Œæ•´é¡¿ä¸€ä¸‹æ˜å¤©å¼€äºŒå‘¨ç›®äº†</p><p>æœ‰æœºä¼šæˆ‘æƒ³å¼€ä¸€ä¸ªè¯»è®ºæ–‡çš„å‘äº†ï¼Œåé¢æœ‰æ—¶é—´å†è¯´å§ </p><p>åˆ°è¿™é‡Œå°±å®Œç»“äº†ï¼Œä¸‹ä¸ªå‘å†è§ï¼Œ bye ~</p>]]></content>
    
    
    <categories>
      
      <category>Lab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MIT6.S081</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cs144-lab0~lab7</title>
    <link href="/2023/08/12/cs144-lab0-lab7/"/>
    <url>/2023/08/12/cs144-lab0-lab7/</url>
    
    <content type="html"><![CDATA[<p>lab0-lab5 codeï¼š<a href="https://github.com/MadFrey/minnow">MadFrey&#x2F;minnow (github.com)</a></p><p>lab6å’Œlab7è‡ªè¡Œæµ‹è¯•</p><p>å†æ—¶å¤§æ¦‚ä¸¤ä¸ªæ˜ŸæœŸï¼Œå…«æœˆä¸­æ—¬åˆ°å…«æœˆåº•ï¼ŒæœŸé—´è¿˜æœ‰æ®µæ—¶é—´æ²¡èŠ±åœ¨è¿™ä¸Šé¢</p><p>æ•´ä½“æ„Ÿè§‰ä¸‹æ¥lab1å’Œlab3éš¾åº¦è¾ƒé«˜ï¼Œå…¶ä»–çš„æ ¹æ®pdfçš„æè¿°å†åŠ ä¸Šè‡ªå·±å»äº†è§£ä¸€ä¸‹åŸç†ï¼Œéƒ½ä¸éš¾å†™</p><h2 id="lab-0"><a href="#lab-0" class="headerlink" title="lab 0"></a>lab 0</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell">root@hecs-271160 ~]# telnet cs144.keithw.org http<br>Trying 104.196.238.229...<br>Connected to cs144.keithw.org.<br>Escape character is &#x27;^]&#x27;.<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">telnet&gt; </span><span class="language-bash"></span><br><span class="language-bash">GET /hello HTTP/1.1</span><br>Host: cs144.keithw.org<br><br>HTTP/1.1 200 OK<br>Date: Sat, 12 Aug 2023 15:07:45 GMT<br>Server: Apache<br>Last-Modified: Thu, 13 Dec 2018 15:45:29 GMT<br>ETag: &quot;e-57ce93446cb64&quot;<br>Accept-Ranges: bytes<br>Content-Length: 14<br>Content-Type: text/plain<br><br>Hello, CS144!<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@hecs-271160 ~]# telnet cs144.keithw.org http<br>Trying 104.196.238.229...<br>Connected to cs144.keithw.org.<br>Escape character is &#x27;^]&#x27;.<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">telnet&gt; </span><span class="language-bash"></span><br><span class="language-bash">GET /lab0/MadFrey HTTP/1.1</span>    <br>Host: cs144.keithw.org<br><br>HTTP/1.1 200 OK<br>Date: Sat, 12 Aug 2023 15:13:12 GMT<br>Server: Apache<br>X-You-Said-Your-SunetID-Was: MadFrey<br>X-Your-Code-Is: 794944<br>Content-length: 111<br>Vary: Accept-Encoding<br>Content-Type: text/plain<br><br>Hello! You told us that your SUNet ID was &quot;MadFrey&quot;. Please see the HTTP headers (above) for your secret code.<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@hecs-271160 etc]# telnet localhost 9090<br>Trying ::1...<br>telnet: connect to address ::1: Connection refused<br>Trying 127.0.0.1...<br>Connected to localhost.<br>Escape character is &#x27;^]&#x27;.<br>11111<br>3243435<br>MadFrey <br>^CConnection closed by foreign host.<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@hecs-271160 netcat-0.7.1]# netcat -u 127.0.0.1 8004<br>^C[root@hecs-271160 netcat-0.7.1]# netcat -v -l -p 9090<br>Connection from 127.0.0.1:34572<br>11111<br>3243435<br>MadFrey<br>Exiting.<br>[root@hecs-271160 netcat-0.7.1]# <br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">get_URL</span><span class="hljs-params">( <span class="hljs-type">const</span> string&amp; host, <span class="hljs-type">const</span> string&amp; path )</span></span><br><span class="hljs-function"></span>&#123;<br>  TCPSocket socket;<br>  socket.<span class="hljs-built_in">connect</span>( <span class="hljs-built_in">Address</span>( host, <span class="hljs-string">&quot;http&quot;</span> ) );<br>  socket.<span class="hljs-built_in">write</span>( <span class="hljs-string">&quot;GET &quot;</span> + path + <span class="hljs-string">&quot; HTTP/1.1\r\nHost: &quot;</span> + host + <span class="hljs-string">&quot;\r\nConnection: close\r\n\r\n&quot;</span> );<br><br>  <span class="hljs-keyword">while</span> ( !socket.<span class="hljs-built_in">eof</span>() ) &#123;<br>    std::string buffers;<br>    socket.<span class="hljs-built_in">read</span>( buffers );<br>    cout &lt;&lt; buffers;<br>  &#125;<br>  socket.<span class="hljs-built_in">close</span>();<br>  cerr &lt;&lt; <span class="hljs-string">&quot;Function called: get_URL(&quot;</span> &lt;&lt; host &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> &lt;&lt; path &lt;&lt; <span class="hljs-string">&quot;)\n&quot;</span>;<br>  cerr &lt;&lt; <span class="hljs-string">&quot;Warning: get_URL() has not been implemented yet.\n&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230901135240852.png"></p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230817174534608.png" alt="img"></p><h2 id="lab1"><a href="#lab1" class="headerlink" title="lab1"></a>lab1</h2><p>è‡ªå·±å…ˆç”¨ä¼˜å…ˆé˜Ÿåˆ—å†™äº†ä¸€éï¼Œå‘ç°ä»£ç è¿‡äºå¤æ‚ï¼Œå¹¶ä¸”æ—¶é—´å¤æ‚åº¦å¤ªé«˜äº†ï¼Œæµ‹è¯•ç‚¹è¶…æ—¶</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;reassembler.hh&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">Reassembler::is_closed</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">return</span> closed_ &amp;&amp; <span class="hljs-built_in">bytes_pending</span>() == <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Reassembler::insert</span><span class="hljs-params">( <span class="hljs-type">uint64_t</span> first_index, string data, <span class="hljs-type">bool</span> is_last_substring, Writer&amp; output )</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-comment">// Your code here.</span><br>  <span class="hljs-keyword">if</span> ( is_last_substring ) &#123;<br>    closed_ = <span class="hljs-literal">true</span>;<br>  &#125;<br><br>  <span class="hljs-comment">// important!</span><br>  <span class="hljs-keyword">if</span> ( first_index &gt;= unassembled_index + output.<span class="hljs-built_in">available_capacity</span>() || <span class="hljs-comment">/* Out of bound */</span><br>       first_index + data.<span class="hljs-built_in">length</span>() - <span class="hljs-number">1</span> &lt; unassembled_index ||            <span class="hljs-comment">/* Data have been transferred */</span><br>       data.<span class="hljs-built_in">empty</span>() || output.<span class="hljs-built_in">available_capacity</span>() == <span class="hljs-number">0</span> ) &#123;<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">is_closed</span>() ) &#123;<br>      output.<span class="hljs-built_in">close</span>();<br>    &#125;<br>    <span class="hljs-keyword">return</span>;<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> ( first_index &lt; unassembled_index ) &#123;<br>    <span class="hljs-comment">// overlap</span><br>    <span class="hljs-keyword">if</span> ( first_index + data.<span class="hljs-built_in">size</span>() &gt; unassembled_index ) &#123;<br>      <span class="hljs-comment">// overlap</span><br>      <span class="hljs-type">size_t</span> overlap = unassembled_index - first_index;<br>      <span class="hljs-type">size_t</span> new_data_size = data.<span class="hljs-built_in">size</span>() - overlap;<br>      string new_data = data.<span class="hljs-built_in">substr</span>( overlap, new_data_size );<br>      output.<span class="hljs-built_in">writer</span>().<span class="hljs-built_in">push</span>( new_data );<br>      unassembled_index += new_data_size;<br>    &#125;<br><br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( first_index == unassembled_index ) &#123;<br>    <span class="hljs-comment">// no overlap, è¦è¿›è¡Œcapæ¯”è¾ƒ</span><br>    <span class="hljs-type">uint64_t</span> cap = output.<span class="hljs-built_in">writer</span>().<span class="hljs-built_in">available_capacity</span>();<br>    <span class="hljs-keyword">if</span> ( data.<span class="hljs-built_in">size</span>() &gt; cap ) &#123;<br>      <span class="hljs-comment">// capä¸å¤Ÿ</span><br>      <span class="hljs-type">size_t</span> new_data_size = cap;<br>      string new_data = data.<span class="hljs-built_in">substr</span>( <span class="hljs-number">0</span>, new_data_size );<br>      output.<span class="hljs-built_in">writer</span>().<span class="hljs-built_in">push</span>( new_data );<br>      unassembled_index += new_data_size;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-comment">// capå¤Ÿ</span><br>      output.<span class="hljs-built_in">writer</span>().<span class="hljs-built_in">push</span>( data );<br>      unassembled_index += data.<span class="hljs-built_in">size</span>();<br>    &#125;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// ä½¿ç”¨priority queueæ¥å­˜å‚¨ç¢ç‰‡</span><br>    <span class="hljs-keyword">if</span> ( q.<span class="hljs-built_in">empty</span>() ) &#123;<br>      q.<span class="hljs-built_in">push</span>( <span class="hljs-built_in">make_pair</span>( first_index, data ) );<br>      unassembled_bytes_ += data.<span class="hljs-built_in">size</span>();<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        &#125;<br><br>    <span class="hljs-keyword">while</span> ( !q.<span class="hljs-built_in">empty</span>() ) &#123;<br>      <span class="hljs-type">uint64_t</span> new_index = q.<span class="hljs-built_in">top</span>().first;<br>      std::string new_data = q.<span class="hljs-built_in">top</span>().second;<br>      q.<span class="hljs-built_in">pop</span>();<br>      unassembled_bytes_ -= new_data.<span class="hljs-built_in">size</span>();<br>      <span class="hljs-keyword">if</span> ( q.<span class="hljs-built_in">empty</span>() ) &#123;<br>        q.<span class="hljs-built_in">push</span>( <span class="hljs-built_in">make_pair</span>( new_index, new_data ) );<br>        unassembled_bytes_ += new_data.<span class="hljs-built_in">size</span>();<br>        <span class="hljs-keyword">break</span>;<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-type">uint64_t</span> new_index2 = q.<span class="hljs-built_in">top</span>().first;<br>        std::string new_data2 = q.<span class="hljs-built_in">top</span>().second;<br>        <span class="hljs-keyword">if</span> ( new_index &lt;= new_index2 ) &#123;<br>          <span class="hljs-type">size_t</span> overlap = new_index + new_data.<span class="hljs-built_in">size</span>() - new_index2;<br>          <span class="hljs-keyword">if</span> ( overlap &gt;= new_data.<span class="hljs-built_in">size</span>() ) &#123;<br>            q.<span class="hljs-built_in">pop</span>();<br>            unassembled_bytes_ -= new_data2.<span class="hljs-built_in">size</span>();<br>            q.<span class="hljs-built_in">push</span>( <span class="hljs-built_in">make_pair</span>( new_index, new_data ) );<br>            unassembled_bytes_ += new_data.<span class="hljs-built_in">size</span>();<br>          &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// overlap</span><br>            std::string substr = new_data.<span class="hljs-built_in">substr</span>( <span class="hljs-number">0</span>, new_index2 - new_index )<br>                                 + new_data2.<span class="hljs-built_in">substr</span>( overlap, new_data2.<span class="hljs-built_in">size</span>() - overlap );<br>            q.<span class="hljs-built_in">pop</span>();<br>            unassembled_bytes_ -= new_data2.<span class="hljs-built_in">size</span>();<br>            q.<span class="hljs-built_in">push</span>( <span class="hljs-built_in">make_pair</span>( first_index, substr ) );<br>            unassembled_bytes_ += substr.<span class="hljs-built_in">size</span>();<br>            <span class="hljs-keyword">break</span>;<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">// å¾ªç¯</span><br>  <span class="hljs-keyword">while</span> ( !q.<span class="hljs-built_in">empty</span>() ) &#123;<br>    <span class="hljs-type">uint64_t</span> new_index = q.<span class="hljs-built_in">top</span>().first;<br>    std::string new_data = q.<span class="hljs-built_in">top</span>().second;<br>    <span class="hljs-type">uint64_t</span> cap = output.<span class="hljs-built_in">writer</span>().<span class="hljs-built_in">available_capacity</span>();<br>    <span class="hljs-keyword">if</span> ( new_index &lt;= unassembled_index ) &#123;<br>      <span class="hljs-comment">// overlap</span><br>      <span class="hljs-keyword">if</span> ( new_index + new_data.<span class="hljs-built_in">size</span>() &gt; unassembled_index ) &#123;<br>        <span class="hljs-comment">// overlap</span><br>        <span class="hljs-type">size_t</span> overlap = unassembled_index - new_index;<br>        <span class="hljs-type">size_t</span> new_data_size = <span class="hljs-built_in">min</span>( new_data.<span class="hljs-built_in">size</span>() - overlap, cap );<br>        string new_data_2 = new_data.<span class="hljs-built_in">substr</span>( overlap, new_data_size );<br>        output.<span class="hljs-built_in">writer</span>().<span class="hljs-built_in">push</span>( new_data_2 );<br>        unassembled_index += new_data_size;<br>        unassembled_bytes_ -= data.<span class="hljs-built_in">size</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// no overlap</span><br>        q.<span class="hljs-built_in">pop</span>();<br>        unassembled_bytes_ -= new_data.<span class="hljs-built_in">size</span>();<br>      &#125;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( new_index &gt; unassembled_index ) &#123;<br>      <span class="hljs-keyword">break</span>;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">is_closed</span>() ) &#123; <span class="hljs-comment">// important!</span><br>    output.<span class="hljs-built_in">close</span>();<br>  &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">uint64_t</span> <span class="hljs-title">Reassembler::bytes_pending</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-comment">// Your code here.</span><br>  <span class="hljs-keyword">return</span> unassembled_bytes_;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>æ”¹ç”¨mapåç¬¬14ä¸ªæµ‹è¯•ç‚¹è¶…æ—¶</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;reassembler.hh&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cassert&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">Reassembler::is_closed</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123; <span class="hljs-keyword">return</span> closed_ &amp;&amp; <span class="hljs-built_in">bytes_pending</span>() == <span class="hljs-number">0</span>; &#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Reassembler::insert</span><span class="hljs-params">(<span class="hljs-type">uint64_t</span> first_index, string data, <span class="hljs-type">bool</span> is_last_substring, Writer &amp;output)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (is_last_substring) &#123;<br>        closed_ = <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// Remember index_ points to where the current byte located at.</span><br>    <span class="hljs-comment">// 1. Unacceptable index: first_index overwhelms the capability range.</span><br>    <span class="hljs-comment">// 2. All overlapped: The end index of the substring is smaller than current index_.</span><br>    <span class="hljs-comment">// 3. data is empty.</span><br>    <span class="hljs-comment">// 4. No available space.</span><br>    <span class="hljs-keyword">if</span> (first_index &gt;= unassembled_index_ + output.<span class="hljs-built_in">available_capacity</span>() || <span class="hljs-comment">/* Out of bound */</span><br>        first_index + data.<span class="hljs-built_in">length</span>() - <span class="hljs-number">1</span> &lt; unassembled_index_ ||            <span class="hljs-comment">/* Data have been transferred */</span><br>        data.<span class="hljs-built_in">empty</span>() || output.<span class="hljs-built_in">available_capacity</span>() == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">is_closed</span>()) &#123;<br>            output.<span class="hljs-built_in">close</span>();<br>        &#125;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-type">const</span> <span class="hljs-type">uint64_t</span> cap = output.<span class="hljs-built_in">available_capacity</span>();<br>    <span class="hljs-comment">// new_index actually distinguish where the current data start, the start index</span><br>    <span class="hljs-type">uint64_t</span> new_index = first_index;<br><br>    <span class="hljs-comment">// Data needs to fit the capability limitation</span><br>    <span class="hljs-keyword">if</span> (first_index &lt;= unassembled_index_) &#123;<br>        new_index = unassembled_index_;<br>        <span class="hljs-type">const</span> <span class="hljs-type">uint64_t</span> overlapped_length = unassembled_index_ - first_index;<br>        data = data.<span class="hljs-built_in">substr</span>(overlapped_length, <span class="hljs-built_in">min</span>(data.<span class="hljs-built_in">size</span>() - overlapped_length, cap));<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        data = data.<span class="hljs-built_in">substr</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">min</span>(data.<span class="hljs-built_in">size</span>(), cap));<br>        <span class="hljs-keyword">if</span> (first_index + data.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span> &gt; unassembled_index_ + cap - <span class="hljs-number">1</span>) &#123;<br>            data = data.<span class="hljs-built_in">substr</span>(<span class="hljs-number">0</span>, unassembled_index_ + cap - first_index);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// Get the rear substring and merge the overlapped part</span><br>    <span class="hljs-keyword">auto</span> rear_iter = unassembled_substrings_.<span class="hljs-built_in">lower_bound</span>(new_index);<br>    <span class="hljs-keyword">while</span> (rear_iter != unassembled_substrings_.<span class="hljs-built_in">end</span>()) &#123;<br>        <span class="hljs-keyword">auto</span> &amp;[rear_index, rear_data] = *rear_iter;<br>        <span class="hljs-keyword">if</span> (new_index + data.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span> &lt; rear_index) &#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125; <span class="hljs-comment">// No overlap conflict</span><br>        <span class="hljs-type">uint64_t</span> rear_overlapped_length = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">if</span> (new_index + data.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span> &lt; rear_index + rear_data.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>) &#123;<br>            rear_overlapped_length = new_index + data.<span class="hljs-built_in">size</span>() - rear_index;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            rear_overlapped_length = rear_data.<span class="hljs-built_in">size</span>();<br>        &#125;<br>        <span class="hljs-comment">// Prepare for next rear early, because the data may be erased afterwards.</span><br>        <span class="hljs-type">const</span> <span class="hljs-type">uint64_t</span> next_rear = rear_index + rear_data.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span> (rear_overlapped_length == rear_data.<span class="hljs-built_in">size</span>()) &#123;<br>            unassembled_bytes_ -= rear_data.<span class="hljs-built_in">size</span>();<br>            unassembled_substrings_.<span class="hljs-built_in">erase</span>(rear_index);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// We don&#x27;t combine current data and rear data.</span><br>            <span class="hljs-comment">// Erase the overlapped part in current data is more efficient.</span><br>            data.<span class="hljs-built_in">erase</span>(data.<span class="hljs-built_in">end</span>() - <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">int64_t</span>&gt;(rear_overlapped_length), data.<span class="hljs-built_in">end</span>());<br>        &#125;<br>        rear_iter = unassembled_substrings_.<span class="hljs-built_in">lower_bound</span>(next_rear);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (first_index &gt; unassembled_index_) &#123;<br>        <span class="hljs-keyword">auto</span> front_iter = unassembled_substrings_.<span class="hljs-built_in">upper_bound</span>(new_index);<br>        <span class="hljs-keyword">if</span> (front_iter != unassembled_substrings_.<span class="hljs-built_in">begin</span>()) &#123;<br>            front_iter--;<br>            <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;[front_index, front_data] = *front_iter;<br>            <span class="hljs-keyword">if</span> (front_index + front_data.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span> &gt;= first_index) &#123;<br>                <span class="hljs-type">uint64_t</span> overlapped_length = <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">if</span> (front_index + front_data.<span class="hljs-built_in">size</span>() &lt;= first_index + data.<span class="hljs-built_in">size</span>()) &#123;<br>                    overlapped_length = front_index + front_data.<span class="hljs-built_in">size</span>() - first_index;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    overlapped_length = data.<span class="hljs-built_in">size</span>();<br>                &#125;<br>                <span class="hljs-keyword">if</span> (overlapped_length == front_data.<span class="hljs-built_in">size</span>()) &#123;<br>                    unassembled_bytes_ -= front_data.<span class="hljs-built_in">size</span>();<br>                    unassembled_substrings_.<span class="hljs-built_in">erase</span>(front_index);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    data.<span class="hljs-built_in">erase</span>(data.<span class="hljs-built_in">begin</span>(), data.<span class="hljs-built_in">begin</span>() + <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">int64_t</span>&gt;(overlapped_length));<br>                    <span class="hljs-comment">// Don&#x27;t forget to update the inserted location</span><br>                    new_index = first_index + overlapped_length;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// If the processed data is empty, no need to insert it.</span><br>    <span class="hljs-keyword">if</span> (data.<span class="hljs-built_in">size</span>() &gt; <span class="hljs-number">0</span>) &#123;<br>        unassembled_bytes_ += data.<span class="hljs-built_in">size</span>();<br>        unassembled_substrings_.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">make_pair</span>(new_index, std::<span class="hljs-built_in">move</span>(data)));<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> iter = unassembled_substrings_.<span class="hljs-built_in">begin</span>(); iter != unassembled_substrings_.<span class="hljs-built_in">end</span>(); <span class="hljs-comment">/* nop */</span>) &#123;<br>        <span class="hljs-keyword">auto</span> &amp;[sub_index, sub_data] = *iter;<br>        <span class="hljs-keyword">if</span> (sub_index == unassembled_index_) &#123;<br>            <span class="hljs-type">const</span> <span class="hljs-type">uint64_t</span> prev_bytes_pushed = output.<span class="hljs-built_in">bytes_pushed</span>();<br>            output.<span class="hljs-built_in">push</span>(sub_data);<br>            <span class="hljs-type">const</span> <span class="hljs-type">uint64_t</span> bytes_pushed = output.<span class="hljs-built_in">bytes_pushed</span>();<br>            <span class="hljs-keyword">if</span> (bytes_pushed != prev_bytes_pushed + sub_data.<span class="hljs-built_in">size</span>()) &#123;<br>                <span class="hljs-comment">// Cannot push all data, we need to reserve the un-pushed part.</span><br>                <span class="hljs-type">const</span> <span class="hljs-type">uint64_t</span> pushed_length = bytes_pushed - prev_bytes_pushed;<br>                unassembled_index_ += pushed_length;<br>                unassembled_bytes_ -= pushed_length;<br>                unassembled_substrings_.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">make_pair</span>(unassembled_index_, sub_data.<span class="hljs-built_in">substr</span>(pushed_length)));<br>                <span class="hljs-comment">// Don&#x27;t forget to remove the previous incompletely transferred data</span><br>                unassembled_substrings_.<span class="hljs-built_in">erase</span>(sub_index);<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            unassembled_index_ += sub_data.<span class="hljs-built_in">size</span>();<br>            unassembled_bytes_ -= sub_data.<span class="hljs-built_in">size</span>();<br>            unassembled_substrings_.<span class="hljs-built_in">erase</span>(sub_index);<br>            iter = unassembled_substrings_.<span class="hljs-built_in">find</span>(unassembled_index_);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">break</span>; <span class="hljs-comment">// No need to do more. Data has been discontinuous.</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">is_closed</span>()) &#123;<br>        output.<span class="hljs-built_in">close</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">uint64_t</span> <span class="hljs-title">Reassembler::bytes_pending</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123; <span class="hljs-keyword">return</span> unassembled_bytes_; &#125;<br></code></pre></td></tr></table></figure><p>æœ€åè¿˜æ˜¯ç›´æ¥å‚è€ƒäº†å¤§ä½¬çš„ä»£ç ï¼Œå› ä¸ºèŠ±åœ¨lab1ä¸Šçš„æ—¶é—´å¤ªä¹…äº†</p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230819181925740.png"></p><h2 id="lab2"><a href="#lab2" class="headerlink" title="lab2"></a>lab2</h2><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230819181854325.png"></p><h2 id="lab3"><a href="#lab3" class="headerlink" title="lab3"></a>lab3</h2><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230827203700808.png"></p><h2 id="lab4"><a href="#lab4" class="headerlink" title="lab4"></a>lab4</h2><p>å®ç°ARPï¼Œè¿™èŠ‚å®éªŒå¼€å§‹éš¾åº¦éª¤é™</p><p>å‚è€ƒåšå®¢ï¼š<a href="https://www.cnblogs.com/chenshengkai/p/13936532.html">ARPæŠ¥æ–‡ç»“æ„</a>      <a href="https://akaedu.github.io/book/ch36s03.html">ARP</a></p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230830223804712.png"></p><h2 id="lab5"><a href="#lab5" class="headerlink" title="lab5"></a>lab5</h2><p>è¿™èŠ‚è¦æ±‚å®ç°åŸºäºæœ€é•¿å‰ç¼€åŒ¹é…è§„åˆ™çš„è·¯ç”±å™¨è½¬å‘åŠŸèƒ½ï¼ŒåŸºæœ¬æ²¡æœ‰éš¾åº¦ </p><p>æ²¡æœ‰å¤æ‚åº¦è¦æ±‚ï¼Œå°±ç›´æ¥ç”¨vectoräº†ï¼Œæ–¹ä¾¿ä¸€ç‚¹</p><p><img src="https://raw.githubusercontent.com/MadFrey/homework.img/master/image-20230901111001853.png"></p>]]></content>
    
    
    <categories>
      
      <category>lab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cs144</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é‡æ–°å»ºç«™åçš„ç¬¬ä¸€ç¯‡åšå®¢</title>
    <link href="/2023/07/29/%E9%87%8D%E6%96%B0%E5%BB%BA%E7%AB%99%E5%90%8E%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
    <url>/2023/07/29/%E9%87%8D%E6%96%B0%E5%BB%BA%E7%AB%99%E5%90%8E%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/</url>
    
    <content type="html"><![CDATA[<p>â€‹è¿™å·²ç»æ˜¯ç¬¬äºŒæ¬¡æ­å»ºåšå®¢äº†ï¼Œè·ç¦»ä¸Šä¸€æ¬¡æ­å»ºè‡ªå·±çš„åšå®¢å·²ç»æœ‰ä¸€å¹´å¤šäº†ã€‚ä¹‹å‰åœ¨å¤§ä¸€çš„æ—¶å€™ç”¨çš„typechoåœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šæ­çš„ï¼Œä¸»è¦ä¹Ÿæ˜¯è®°å½•çš„ä¸€äº›ç®—æ³•ç›¸å…³çš„ä¸œè¥¿ã€‚ç”±äºå„ç§å› ç´ å½±å“ï¼Œæœ€åè¿˜æ˜¯æ”¾å¼ƒäº†ä¹‹å‰çš„åšå®¢ï¼Œé€‰æ‹©é‡æ–°æ­å»ºã€‚</p><p>â€‹è¿™æ¬¡æ­åšå®¢ï¼Œä¸»è¦è¿˜æ˜¯æƒ³è¦è®°å½•ä¸€ä¸‹ä¸ªäººè§‰å¾—æ¯”è¾ƒæœ‰æ„æ€çš„äº‹ï¼Œå‘è¡¨å‘è¡¨è§‚ç‚¹ï¼Œå…¶æ¬¡æ˜¯æŠ€æœ¯æ–¹é¢ä¼šå†™ä¸€äº›æœ‰æŠ€æœ¯æ·±åº¦å’Œå¹¿åº¦çš„åšå®¢ï¼ŒåšCSDN,æ˜é‡‘æ¬è¿å·¥å°±å¤ªæ²¡æ„æ€äº†ã€‚ï¼ˆè¿™ä¹Ÿæ˜¯æ”¾å¼ƒä¹‹å‰çš„åšå®¢çš„åŸå› ä¹‹ä¸€å§ï¼‰ç„¶åå†™å†™å¤§å­¦é˜¶æ®µçš„å¹´åº¦æ€»ç»“å§ã€‚æ€»ä¹‹ï¼Œå†™åšå®¢æ˜¯æˆ‘å¯¹äºè‡ªå·±æ‰€å­¦å†…å®¹çš„ä¸€ç§å†…å®¹è¾“å‡ºï¼Œä¹Ÿæ˜¯è¿™æ¬¡æƒ³è¦é‡æ–°æ­å»ºåšå®¢çš„ä¸»è¦åŸå› ã€‚</p><p>â€‹åªèƒ½è¯´å†™åšå®¢ç¡®å®æŒºè´¹æ—¶é—´çš„ï¼Œæƒ³è¦åšæŒä¸€ç›´ä¸‹å»ç¡®å®æœ‰ä¸€å®šéš¾åº¦ï¼Œä½†æ—¶é—´æŒ¤ä¸€æŒ¤è¿˜æ˜¯ä¼šæœ‰çš„ã€‚å—¯ï¼Œå¤§æ¦‚å°±è¿™äº›å§ã€‚</p><p>â€‹</p>]]></content>
    
    
    <categories>
      
      <category>æ‚è°ˆ</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
